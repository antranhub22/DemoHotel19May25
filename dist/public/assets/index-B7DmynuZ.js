const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CallHistory-ChEkosKA.js","assets/react-BlJs-Rj_.js","assets/@daily-co-CRt2XSsO.js","assets/@tanstack-H40tjzcj.js","assets/wouter-DSgBA37d.js","assets/regexparam-CPXopyEH.js","assets/use-sync-external-store-T8uco2Ip.js","assets/CallDetails-CHM_Q-IP.js"])))=>i.map(i=>d[i]);
import{r,j as e,R as ce}from"./react-BlJs-Rj_.js";import{R as ke,c as ft}from"./react-dom-qFx4IFJ8.js";import{L as qe,S as bt,R as re}from"./wouter-DSgBA37d.js";import{V as ze,R as He,A as We,C as Ve,T as Ge,D as Ye,P as _t,S as yt}from"./@radix-ui-B3NMiK-C.js";import{c as Ue}from"./class-variance-authority-Dp3B9jqt.js";import{c as vt}from"./clsx-B-dksMZM.js";import{t as wt}from"./tailwind-merge-D696Ktp4.js";import{X as Se,I as jt,H as Nt,C as $t}from"./lucide-react-CSPfJw2I.js";import{_ as St}from"./@vapi-ai-DrvmIiYL.js";import{S as kt,N as Ct,P as Tt,A as It,a as At}from"./swiper-CfFrfE8b.js";import{F as Dt,a as Xe,b as Rt}from"./react-icons-D-KLi9l9.js";import{u as Ke}from"./react-router-DvHbwIsR.js";import{B as Mt}from"./react-router-dom-BMXKYxTf.js";import{R as ye,P as Et,a as Ot,C as Pt,T as ve,B as Ft,b as Ce,X as Te,Y as Ie,L as Ae,c as Lt,d as Bt,e as qt}from"./recharts--MJSPD-2.js";import{Q as zt,a as Ht}from"./@tanstack-H40tjzcj.js";import"./@daily-co-CRt2XSsO.js";import"./scheduler-DYLXRpC5.js";import"./regexparam-CPXopyEH.js";import"./use-sync-external-store-T8uco2Ip.js";import"./events-CXH2uRM3.js";import"./@remix-run-DBo92Irb.js";import"./lodash-86XxYiBf.js";import"./react-smooth-Cmz7w04I.js";import"./prop-types-CwuqRrCR.js";import"./fast-equals-BIyco3rD.js";import"./tiny-invariant-BaFNuDhB.js";import"./d3-shape-nwul2LtV.js";import"./d3-path-CimkQT29.js";import"./victory-vendor-eFgrrWDw.js";import"./d3-scale-DCNNTN8k.js";import"./internmap-BkD7Hj8s.js";import"./d3-array-g_qRI3rN.js";import"./d3-time-format-j2_s_XYn.js";import"./d3-time-g9mLz1m7.js";import"./d3-interpolate-CvRPKVI0.js";import"./d3-color-9lF95FHy.js";import"./d3-format-CzD4bSOQ.js";import"./recharts-scale-CEDTliZZ.js";import"./decimal.js-light-ZKFLnszB.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const m of a)if(m.type==="childList")for(const l of m.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function s(a){const m={};return a.integrity&&(m.integrity=a.integrity),a.referrerPolicy&&(m.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?m.credentials="include":a.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function o(a){if(a.ep)return;a.ep=!0;const m=s(a);fetch(a.href,m)}})();const Wt="modulepreload",Vt=function(n){return"/"+n},De={},Ze=function(t,s,o){let a=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),i=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));a=Promise.allSettled(s.map(c=>{if(c=Vt(c),c in De)return;De[c]=!0;const _=c.endsWith(".css"),x=_?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${x}`))return;const S=document.createElement("link");if(S.rel=_?"stylesheet":Wt,_||(S.as="script"),S.crossOrigin="",S.href=c,i&&S.setAttribute("nonce",i),document.head.appendChild(S),_)return new Promise((D,w)=>{S.addEventListener("load",D),S.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${c}`)))})}))}function m(l){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=l,window.dispatchEvent(i),!i.defaultPrevented)throw l}return a.then(l=>{for(const i of l||[])i.status==="rejected"&&m(i.reason);return t().catch(m)})};class Gt extends r.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,s){console.error("Uncaught error in component tree:",t,s)}render(){return this.state.hasError?e.jsx("div",{className:"flex items-center justify-center h-screen p-4 bg-gray-50",children:e.jsxs("div",{className:"max-w-md text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-2",children:"Something went wrong."}),e.jsx("p",{className:"text-gray-700 mb-4",children:"An unexpected error occurred. Please try refreshing the page or contact support if the problem persists."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Reload Page"})]})}):this.props.children}}const Yt=1,Ut=1e6;let we=0;function Xt(){return we=(we+1)%Number.MAX_SAFE_INTEGER,we.toString()}const je=new Map,Re=n=>{if(je.has(n))return;const t=setTimeout(()=>{je.delete(n),he({type:"REMOVE_TOAST",toastId:n})},Ut);je.set(n,t)},Kt=(n,t)=>{switch(t.type){case"ADD_TOAST":return{...n,toasts:[t.toast,...n.toasts].slice(0,Yt)};case"UPDATE_TOAST":return{...n,toasts:n.toasts.map(s=>s.id===t.toast.id?{...s,...t.toast}:s)};case"DISMISS_TOAST":{const{toastId:s}=t;return s?Re(s):n.toasts.forEach(o=>{Re(o.id)}),{...n,toasts:n.toasts.map(o=>o.id===s||s===void 0?{...o,open:!1}:o)}}case"REMOVE_TOAST":return t.toastId===void 0?{...n,toasts:[]}:{...n,toasts:n.toasts.filter(s=>s.id!==t.toastId)}}},fe=[];let be={toasts:[]};function he(n){be=Kt(be,n),fe.forEach(t=>{t(be)})}function Zt({...n}){const t=Xt(),s=a=>he({type:"UPDATE_TOAST",toast:{...a,id:t}}),o=()=>he({type:"DISMISS_TOAST",toastId:t});return he({type:"ADD_TOAST",toast:{...n,id:t,open:!0,onOpenChange:a=>{a||o()}}}),{id:t,dismiss:o,update:s}}function Jt(){const[n,t]=r.useState(be);return r.useEffect(()=>(fe.push(t),()=>{const s=fe.indexOf(t);s>-1&&fe.splice(s,1)}),[n]),{...n,toast:Zt,dismiss:s=>he({type:"DISMISS_TOAST",toastId:s})}}function Q(...n){return wt(vt(n))}const Qt=_t,Je=r.forwardRef(({className:n,...t},s)=>e.jsx(ze,{ref:s,className:Q("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",n),...t}));Je.displayName=ze.displayName;const es=Ue("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-dark",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),Qe=r.forwardRef(({className:n,variant:t,...s},o)=>e.jsx(He,{ref:o,className:Q(es({variant:t}),n),...s}));Qe.displayName=He.displayName;const ts=r.forwardRef(({className:n,...t},s)=>e.jsx(We,{ref:s,className:Q("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",n),...t}));ts.displayName=We.displayName;const et=r.forwardRef(({className:n,...t},s)=>e.jsx(Ve,{ref:s,className:Q("absolute right-2 top-2 rounded-md p-1 text-dark/50 opacity-0 transition-opacity hover:text-dark focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",n),"toast-close":"",...t,children:e.jsx(Se,{className:"h-4 w-4"})}));et.displayName=Ve.displayName;const tt=r.forwardRef(({className:n,...t},s)=>e.jsx(Ge,{ref:s,className:Q("text-sm font-semibold",n),...t}));tt.displayName=Ge.displayName;const st=r.forwardRef(({className:n,...t},s)=>e.jsx(Ye,{ref:s,className:Q("text-sm opacity-90",n),...t}));st.displayName=Ye.displayName;function ss(){const{toasts:n}=Jt();return e.jsxs(Qt,{children:[n.map(function({id:t,title:s,description:o,action:a,...m}){return e.jsxs(Qe,{...m,children:[e.jsxs("div",{className:"grid gap-1",children:[s&&e.jsx(tt,{children:s}),o&&e.jsx(st,{children:o})]}),a,e.jsx(et,{})]},t)}),e.jsx(Je,{})]})}const ns=!1;let ee=null;const nt=async n=>{try{return ee||(ee=new St(n),ee.on("call-start",()=>{console.log("Call started")}),ee.on("call-end",()=>{console.log("Call ended")}),ee.on("speech-start",()=>{console.log("Speech started")}),ee.on("speech-end",()=>{console.log("Speech ended")}),ee.on("volume-level",t=>{console.log(`Volume level: ${t}`)}),ee.on("message",t=>{console.log("Message received:",t)}),ee.on("error",t=>{console.error("Error:",t)}),ee)}catch(t){throw console.error("Failed to initialize Vapi:",t),t}},ue=()=>ee,os={orderType:"Room Service",deliveryTime:"asap",roomNumber:"",guestName:"",guestEmail:"",guestPhone:"",specialInstructions:"",items:[{id:"1",name:"Club Sandwich",description:"Served with french fries and side salad",quantity:1,price:15},{id:"2",name:"Fresh Orange Juice",description:"Large size",quantity:1,price:8}],totalAmount:23},ot=r.createContext(void 0);function rt({children:n}){const[t,s]=r.useState("interface1"),[o,a]=r.useState([]),[m,l]=r.useState(null),[i,c]=r.useState(null),[_,x]=r.useState(null),[S,D]=r.useState(0),[w,g]=r.useState(null),[T,d]=r.useState(!1),[j,I]=r.useState(null),[Y,q]=r.useState([]),[L,C]=r.useState(null),[p,$]=r.useState(!1),[E,F]=r.useState(null),[y,f]=r.useState(()=>{if(typeof window>"u")return[];try{const v=localStorage.getItem("activeOrders");return v?JSON.parse(v).map(B=>({...B,requestedAt:new Date(B.requestedAt)})):[]}catch(v){return console.error("Failed to parse activeOrders from localStorage",v),[]}}),[b,A]=r.useState(0),[W,V]=r.useState([]),[O,M]=r.useState("en"),Z=v=>{console.log("🔄 AssistantContext: setCurrentInterface called with:",v),console.log("🔄 Previous interface:",t),s(v),console.log("✅ AssistantContext: setCurrentInterface completed")},G=v=>{console.log("🗑️ AssistantContext: setOrder called with:",v),console.log("🗑️ Previous order:",_),x(v),console.log("✅ AssistantContext: setOrder completed")};r.useEffect(()=>{if(!(typeof window>"u"))try{localStorage.setItem("activeOrders",JSON.stringify(y))}catch{console.error("Failed to persist activeOrders to localStorage")}},[y]),r.useEffect(()=>{console.log("🎯 AssistantContext: currentInterface changed to:",t),console.log("🎯 Timestamp:",new Date().toISOString())},[t]),r.useEffect(()=>{console.log("📦 AssistantContext: order changed to:",_),console.log("📦 Order reference:",_==null?void 0:_.reference),console.log("📦 Timestamp:",new Date().toISOString())},[_]);const K=v=>{f(P=>[...P,{...v,status:v.status||"Đã ghi nhận"}])},ie=ce.useCallback(v=>{const P={...v,id:Date.now(),callId:(i==null?void 0:i.id)||`call-${Date.now()}`,timestamp:new Date};a(B=>[...B,P])},[i==null?void 0:i.id]);r.useEffect(()=>((async()=>{try{throw new Error("Vapi public key is not configured")}catch(P){console.error("Error setting up Vapi:",P)}})(),()=>{const P=ue();P&&P.stop()}),[]),r.useEffect(()=>{if(t==="interface2"){console.log("Starting call duration timer in interface2");const v=setInterval(()=>{D(P=>{const B=P+1;return console.log("Call duration updated:",B),B})},1e3);g(v)}else w&&(console.log("Clearing call duration timer when leaving interface2"),clearInterval(w),g(null));return()=>{w&&(console.log("Cleaning up call duration timer"),clearInterval(w))}},[t,w]);const oe=()=>{const v=ue();v&&(v.setMuted(!T),d(!T))},U=ce.useCallback(async()=>{try{$(!1);const v=`call-${Date.now()}`;c({id:v,roomNumber:"",duration:"0",category:""}),a([]),V([]);const P=ue();if(!P){console.error("Vapi instance not initialized");return}const B=void 0;if(!B){console.error("Assistant ID not configured");return}if(!await P.start(B)){console.error("Failed to start call - call object is null");return}console.log("Call started successfully"),D(0);const z=setInterval(()=>{D(R=>R+1)},1e3);g(z),s("interface2")}catch(v){console.error("Error starting call:",v)}},[]),de=r.useCallback(()=>{try{const v=ue();v&&v.stop();const P=()=>{w&&(clearInterval(w),g(null)),l(os);const B=S?`${Math.floor(S/60)}:${(S%60).toString().padStart(2,"0")}`:"0:00",se=o.map(R=>({role:R.role,content:R.content}));if(se.length<2){const R={id:Date.now(),callId:(i==null?void 0:i.id)||`call-${Date.now()}`,content:"Call was too short to generate a summary. Please try a more detailed conversation.",timestamp:new Date};I(R);return}const z={id:Date.now(),callId:(i==null?void 0:i.id)||`call-${Date.now()}`,content:"Generating AI summary of your conversation...",timestamp:new Date};I(z),fetch("/api/store-summary",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({summary:"",transcripts:se,timestamp:new Date().toISOString(),callId:(i==null?void 0:i.id)||`call-${Date.now()}`,callDuration:B,forceBasicSummary:ns,language:O})}).then(R=>{if(!R.ok)throw new Error(`Network response was not ok: ${R.status}`);return R.json()}).then(R=>{if(R.success&&R.summary&&R.summary.content){const ne=R.summary.content;ke.unstable_batchedUpdates(()=>{const me={id:Date.now(),callId:(i==null?void 0:i.id)||`call-${Date.now()}`,content:ne,timestamp:new Date(R.summary.timestamp||Date.now())};I(me),R.serviceRequests&&Array.isArray(R.serviceRequests)&&R.serviceRequests.length>0&&q(R.serviceRequests)})}}).catch(R=>{console.error("Error processing summary:",R);const ne={id:Date.now(),callId:(i==null?void 0:i.id)||`call-${Date.now()}`,content:"An error occurred while generating the call summary.",timestamp:new Date};I(ne)})};ke.unstable_batchedUpdates(P)}catch(v){console.error("Error in endCall:",v),s("interface1")}},[w,S,o,i,I,s,q,O]),ae=async v=>{try{console.log("Requesting Vietnamese translation for summary...");const P=await fetch("/api/translate-to-vietnamese",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:v})});if(!P.ok)throw new Error(`Network response was not ok: ${P.status}`);const B=await P.json();if(B.success&&B.translatedText)return C(B.translatedText),B.translatedText;throw new Error("Translation failed")}catch(P){return console.error("Error translating to Vietnamese:",P),"Không thể dịch nội dung này sang tiếng Việt. Vui lòng thử lại sau."}},u=v=>{V(P=>[...P,v])};r.useEffect(()=>{let v=null;const P=async()=>{try{const se=await fetch("https://minhnhotelben.onrender.com/api/orders");if(!se.ok)return;const z=await se.json();console.log("[AssistantContext] Fetched orders from API:",z),Array.isArray(z)&&f(z.map(R=>({reference:R.specialInstructions||R.reference||R.callId||"",requestedAt:R.createdAt?new Date(R.createdAt):new Date,estimatedTime:R.deliveryTime||"",status:R.status==="completed"?"Hoàn thiện":R.status==="pending"?"Đã ghi nhận":R.status,...R})))}catch{}};return(t==="interface1"||t==="interface2")&&(P(),v=setInterval(P,5e3)),()=>{v&&clearInterval(v)}},[t]);const k={currentInterface:t,setCurrentInterface:Z,transcripts:o,setTranscripts:a,addTranscript:ie,orderSummary:m,setOrderSummary:l,callDetails:i,setCallDetails:c,order:_,setOrder:G,callDuration:S,setCallDuration:D,isMuted:T,toggleMute:oe,startCall:U,endCall:de,callSummary:j,setCallSummary:I,serviceRequests:Y,setServiceRequests:q,vietnameseSummary:L,setVietnameseSummary:C,translateToVietnamese:ae,emailSentForCurrentSession:p,setEmailSentForCurrentSession:$,requestReceivedAt:E,setRequestReceivedAt:F,activeOrders:y,addActiveOrder:K,setActiveOrders:f,micLevel:b,modelOutput:W,setModelOutput:V,addModelOutput:u,language:O,setLanguage:M};return e.jsx(ot.Provider,{value:k,children:n})}function te(){const n=r.useContext(ot);if(n===void 0)throw new Error("useAssistant must be used within an AssistantProvider");return n}const it="/assets/hotel-exterior-BsmmGNZ1.jpeg",rs="Hotel Mui Ne",is="AI-powered Voice Assistant - Supporting All Your Needs",as="Tap To Speak",cs="Room & Stay",ls="Room Services",ds="Bookings & Facilities",ms="Tourism & Exploration",us="Support to book external services",hs="Order Ref",ps="Requested At",xs="Estimated Completion",gs="Time Remaining",fs="Mute",bs="Unmute",_s="Confirm",ys="Please speak to the assistant first.",vs="Tap to speak",ws="Order Summary",js="Confirm",Ns="Add Note",$s="Room Number",Ss="Enter room number",ks="Enter additional notes",Cs="Summary",Ts="Generated at",Is="Order Confirmed!",As="Your request has been confirmed and forwarded to our staff. They will process it right away.",Ds="Order Reference",Rs="Estimated delivery time:",Ms="Return to Home",Es="Language",Os="English",Ps="French",Fs="Send",Ls="Cancel",Bs="End Call",qs="Room",zs="Order ID",Hs="Guest Name",Ws="Content",Vs="Time",Gs="Status",Ys="Action",Us="Message Guest",Xs="Staff Request Management",Ks="Login",Zs="Username",Js="Password",Qs="Tap the call button to start your request.",en="Review and confirm your request for accuracy.",tn="Your request will be sent to the reception for processing.",sn="Acknowledged",nn="In Progress",on="Delivering to You",rn="Completed",an="Special Note",cn="Check-in/Check-out",ln="Extended Stay Request",dn="Room Information",mn="Hotel Policies",un="Wi-Fi Services",hn="Room Service Food",pn="Drinks & Bar Service",xn="Room Cleaning",gn="Laundry Service",fn="Wake-up Call",bn="Additional Amenities",_n="Maintenance Request",yn="Restaurant Reservation",vn="Spa Services",wn="Fitness Center",jn="Swimming Pool",Nn="Car Rental",$n="Medical Assistance",Sn="Customer Support",kn="Local Attractions",Cn="Local Restaurants",Tn="Public Transportation",In="Local Events",An="Shopping Areas",Dn="Area Maps",Rn="Translation Services",Mn="Leave a Review",En="Report an Issue",On="Luggage Services",Pn="Generating your summary...",Fn={hotel_name:rs,hotel_subtitle:is,press_to_call:as,room_and_stay:cs,room_services:ls,bookings_and_facilities:ds,tourism_and_exploration:ms,support_external_services:us,order_ref:hs,requested_at:ps,estimated_completion:xs,time_remaining:gs,mute:fs,unmute:bs,confirm:_s,need_conversation:ys,tap_to_speak:vs,order_summary:ws,send_to_reception:js,add_note:Ns,room_number:$s,enter_room_number:Ss,enter_notes:ks,summary:Cs,generated_at:Ts,order_confirmed:Is,order_confirmed_message:As,order_reference:Ds,estimated_delivery_time:Rs,return_to_home:Ms,language:Es,english:Os,french:Ps,send:Fs,cancel:Ls,confirm_request:Bs,room:qs,order_id:zs,guest_name:Hs,content:Ws,time:Vs,status:Gs,action:Ys,message_guest:Us,request_management:Xs,login:Ks,username:Zs,password:Js,press_to_call_desc:Qs,confirm_request_desc:en,send_to_reception_desc:tn,status_acknowledged:sn,status_in_progress:nn,status_delivering:on,status_completed:rn,status_note:an,icon_login:cn,icon_hourglass_empty:ln,icon_info:dn,icon_policy:mn,icon_wifi:un,icon_restaurant:hn,icon_local_bar:pn,icon_cleaning_services:xn,icon_local_laundry_service:gn,icon_alarm:fn,icon_add_circle:bn,icon_build:_n,icon_event_seat:yn,icon_spa:vn,icon_fitness_center:wn,icon_pool:jn,icon_directions_car:Nn,icon_medical_services:$n,icon_support_agent:Sn,icon_location_on:kn,icon_local_dining:Cn,icon_directions_bus:Tn,icon_event:In,icon_shopping_bag:An,icon_map:Dn,icon_translate:Rn,icon_rate_review:Mn,icon_report_problem:En,icon_luggage:On,generating_your_summary:Pn},Ln="Bienvenue à Mi Nhon Hotel",Bn="Commencer",qn="Langue",zn="Anglais",Hn="Français",Wn="Envoyer",Vn="Annuler",Gn="Confirmer la demande",Yn="Chambre",Un="ID de commande",Xn="Nom du client",Kn="Contenu",Zn="Heure",Jn="Statut",Qn="Action",eo="Message au client",to="Gestion des demandes du personnel",so="Connexion",no="Nom d'utilisateur",oo="Mot de passe",ro="Hotel Mui Ne",io="Assistant vocal IA - À votre service pour tous vos besoins",ao="Appuyez pour appeler",co="Chambre & Séjour",lo="Services de chambre",mo="Réservations & Installations",uo="Tourisme & Exploration",ho="Assistance pour services externes",po="Réf. commande",xo="Demandé à",go="Fin estimée",fo="Temps restant",bo="Muet",_o="Rétablir le son",yo="Confirmer",vo="Veuillez d'abord parler avec l'assistant.",wo="Appuyez pour parler",jo="Récapitulatif de la commande",No="Envoyer à la réception",$o="Ajouter une note",So="Numéro de chambre",ko="Saisir le numéro de chambre",Co="Saisir des notes supplémentaires",To="Résumé",Io="Généré à",Ao="Commande confirmée !",Do="Votre demande a été confirmée et transmise à notre personnel. Elle sera traitée immédiatement.",Ro="Référence de la commande",Mo="Heure de livraison estimée :",Eo="Retour à l'accueil",Oo="Appuyez sur le bouton d'appel pour démarrer votre demande.",Po="Vérifiez et confirmez votre demande pour plus de précision.",Fo="Votre demande sera envoyée à la réception pour traitement.",Lo="Reçue",Bo="En cours",qo="En livraison",zo="Terminée",Ho="Note spéciale",Wo="Arrivée/Départ",Vo="Prolongation de séjour",Go="Informations sur la chambre",Yo="Politiques de l'hôtel",Uo="Services Wi-Fi",Xo="Service de restauration",Ko="Service de bar",Zo="Nettoyage de chambre",Jo="Service de blanchisserie",Qo="Service de réveil",er="Aménités supplémentaires",tr="Demande de maintenance",sr="Réservation au restaurant",nr="Services de spa",or="Centre de fitness",rr="Piscine",ir="Location de voiture",ar="Assistance médicale",cr="Service client",lr="Attractions locales",dr="Restaurants locaux",mr="Transports publics",ur="Événements locaux",hr="Zones commerciales",pr="Cartes de la région",xr="Services de traduction",gr="Laisser un avis",fr="Signaler un problème",br="Services de bagagerie",_r="Génération de votre résumé...",yr={welcome:Ln,start:Bn,language:qn,english:zn,french:Hn,send:Wn,cancel:Vn,confirm_request:Gn,room:Yn,order_id:Un,guest_name:Xn,content:Kn,time:Zn,status:Jn,action:Qn,message_guest:eo,request_management:to,login:so,username:no,password:oo,hotel_name:ro,hotel_subtitle:io,press_to_call:ao,room_and_stay:co,room_services:lo,bookings_and_facilities:mo,tourism_and_exploration:uo,support_external_services:ho,order_ref:po,requested_at:xo,estimated_completion:go,time_remaining:fo,mute:bo,unmute:_o,confirm:yo,need_conversation:vo,tap_to_speak:wo,order_summary:jo,send_to_reception:No,add_note:$o,room_number:So,enter_room_number:ko,enter_notes:Co,summary:To,generated_at:Io,order_confirmed:Ao,order_confirmed_message:Do,order_reference:Ro,estimated_delivery_time:Mo,return_to_home:Eo,press_to_call_desc:Oo,confirm_request_desc:Po,send_to_reception_desc:Fo,status_acknowledged:Lo,status_in_progress:Bo,status_delivering:qo,status_completed:zo,status_note:Ho,icon_login:Wo,icon_hourglass_empty:Vo,icon_info:Go,icon_policy:Yo,icon_wifi:Uo,icon_restaurant:Xo,icon_local_bar:Ko,icon_cleaning_services:Zo,icon_local_laundry_service:Jo,icon_alarm:Qo,icon_add_circle:er,icon_build:tr,icon_event_seat:sr,icon_spa:nr,icon_fitness_center:or,icon_pool:rr,icon_directions_car:ir,icon_medical_services:ar,icon_support_agent:cr,icon_location_on:lr,icon_local_dining:dr,icon_directions_bus:mr,icon_event:ur,icon_shopping_bag:hr,icon_map:pr,icon_translate:xr,icon_rate_review:gr,icon_report_problem:fr,icon_luggage:br,generating_your_summary:_r},vr="欢迎来到美农酒店 (Mi Nhon Hotel)",wr="开始",jr="语言",Nr="英语",$r="法语",Sr="发送",kr="取消",Cr="确认请求",Tr="房间",Ir="订单编号",Ar="客人姓名",Dr="内容",Rr="时间",Mr="状态",Er="操作",Or="给客人的消息",Pr="员工请求管理",Fr="登录",Lr="用户名",Br="密码",qr="酒店 Mui Ne",zr="AI语音助手 - 满足您的所有需求",Hr="按下呼叫",Wr="房间与住宿",Vr="客房服务",Gr="预订与设施",Yr="旅游与探索",Ur="支持外部服务",Xr="订单参考",Kr="请求时间",Zr="预计完成时间",Jr="剩余时间",Qr="静音",ei="取消静音",ti="确认",si="请先与助手对话。",ni="点击说话",oi="订单摘要",ri="发送到前台",ii="添加备注",ai="房间号",ci="输入房间号",li="输入附加备注",di="摘要",mi="生成时间",ui="订单已确认！",hi="您的请求已确认并发送给我们的员工。我们会立即处理。",pi="订单参考",xi="预计送达时间：",gi="返回首页",fi="点击呼叫按钮开始您的请求。",bi="请检查并确认您的请求以确保准确。",_i="您的请求将被发送到前台进行处理。",yi="已确认",vi="处理中",wi="配送中",ji="已完成",Ni="特别说明",$i="入住/退房",Si="延长住宿请求",ki="房间信息",Ci="酒店政策",Ti="无线网络服务",Ii="客房餐饮服务",Ai="饮品与酒吧服务",Di="房间清洁",Ri="洗衣服务",Mi="唤醒服务",Ei="额外设施",Oi="维修请求",Pi="餐厅预订",Fi="水疗服务",Li="健身中心",Bi="游泳池",qi="租车服务",zi="医疗援助",Hi="客户支持",Wi="当地景点",Vi="当地餐厅",Gi="公共交通",Yi="当地活动",Ui="购物区域",Xi="区域地图",Ki="翻译服务",Zi="留下评论",Ji="报告问题",Qi="行李服务",ea="正在生成您的摘要...",ta={welcome:vr,start:wr,language:jr,english:Nr,french:$r,send:Sr,cancel:kr,confirm_request:Cr,room:Tr,order_id:Ir,guest_name:Ar,content:Dr,time:Rr,status:Mr,action:Er,message_guest:Or,request_management:Pr,login:Fr,username:Lr,password:Br,hotel_name:qr,hotel_subtitle:zr,press_to_call:Hr,room_and_stay:Wr,room_services:Vr,bookings_and_facilities:Gr,tourism_and_exploration:Yr,support_external_services:Ur,order_ref:Xr,requested_at:Kr,estimated_completion:Zr,time_remaining:Jr,mute:Qr,unmute:ei,confirm:ti,need_conversation:si,tap_to_speak:ni,order_summary:oi,send_to_reception:ri,add_note:ii,room_number:ai,enter_room_number:ci,enter_notes:li,summary:di,generated_at:mi,order_confirmed:ui,order_confirmed_message:hi,order_reference:pi,estimated_delivery_time:xi,return_to_home:gi,press_to_call_desc:fi,confirm_request_desc:bi,send_to_reception_desc:_i,status_acknowledged:yi,status_in_progress:vi,status_delivering:wi,status_completed:ji,status_note:Ni,icon_login:$i,icon_hourglass_empty:Si,icon_info:ki,icon_policy:Ci,icon_wifi:Ti,icon_restaurant:Ii,icon_local_bar:Ai,icon_cleaning_services:Di,icon_local_laundry_service:Ri,icon_alarm:Mi,icon_add_circle:Ei,icon_build:Oi,icon_event_seat:Pi,icon_spa:Fi,icon_fitness_center:Li,icon_pool:Bi,icon_directions_car:qi,icon_medical_services:zi,icon_support_agent:Hi,icon_location_on:Wi,icon_local_dining:Vi,icon_directions_bus:Gi,icon_event:Yi,icon_shopping_bag:Ui,icon_map:Xi,icon_translate:Ki,icon_rate_review:Zi,icon_report_problem:Ji,icon_luggage:Qi,generating_your_summary:ea},sa="Добро пожаловать в отель Mi Nhon",na="Начать",oa="Язык",ra="Английский",ia="Французский",aa="Русский",ca="Отправить",la="Отмена",da="Подтвердить запрос",ma="Номер",ua="ID заказа",ha="Имя гостя",pa="Содержание",xa="Время",ga="Статус",fa="Действие",ba="Сообщение гостю",_a="Управление запросами персонала",ya="Вход",va="Имя пользователя",wa="Пароль",ja="Отель Mui Ne",Na="ИИ-ассистент - Поддержка всех ваших потребностей",$a="Нажмите для звонка",Sa="Номер и проживание",ka="Услуги номера",Ca="Бронирование и удобства",Ta="Туризм и исследование",Ia="Поддержка внешних услуг",Aa="Ссылка на заказ",Da="Запрошено в",Ra="Предполагаемое завершение",Ma="Оставшееся время",Ea="Без звука",Oa="Включить звук",Pa="Подтвердить",Fa="Пожалуйста, сначала поговорите с ассистентом.",La="Нажмите, чтобы говорить",Ba="Сводка заказа",qa="Отправить на ресепшен",za="Добавить заметку",Ha="Номер комнаты",Wa="Введите номер комнаты",Va="Введите дополнительные заметки",Ga="Сводка",Ya="Сгенерировано в",Ua="Заказ подтвержден!",Xa="Ваш запрос подтвержден и передан нашему персоналу. Они обработают его немедленно.",Ka="Ссылка на заказ",Za="Предполагаемое время доставки:",Ja="Вернуться на главную",Qa="Нажмите кнопку вызова, чтобы начать ваш запрос.",ec="Проверьте и подтвердите ваш запрос для точности.",tc="Ваш запрос будет отправлен на ресепшен для обработки.",sc="Подтверждено",nc="В процессе",oc="Доставляется",rc="Завершено",ic="Особая заметка",ac="Регистрация/Выселение",cc="Запрос на продление проживания",lc="Информация о номере",dc="Правила отеля",mc="Wi-Fi услуги",uc="Ресторанное обслуживание номеров",hc="Напитки и бар",pc="Уборка номера",xc="Услуги прачечной",gc="Услуга будильника",fc="Дополнительные удобства",bc="Запрос на техническое обслуживание",_c="Бронирование ресторана",yc="СПА услуги",vc="Фитнес-центр",wc="Бассейн",jc="Аренда автомобиля",Nc="Медицинская помощь",$c="Поддержка клиентов",Sc="Местные достопримечательности",kc="Местные рестораны",Cc="Общественный транспорт",Tc="Местные мероприятия",Ic="Торговые зоны",Ac="Карты местности",Dc="Услуги перевода",Rc="Оставить отзыв",Mc="Сообщить о проблеме",Ec="Услуги багажа",Oc="Генерируется ваш итог...",Pc={welcome:sa,start:na,language:oa,english:ra,french:ia,russian:aa,send:ca,cancel:la,confirm_request:da,room:ma,order_id:ua,guest_name:ha,content:pa,time:xa,status:ga,action:fa,message_guest:ba,request_management:_a,login:ya,username:va,password:wa,hotel_name:ja,hotel_subtitle:Na,press_to_call:$a,room_and_stay:Sa,room_services:ka,bookings_and_facilities:Ca,tourism_and_exploration:Ta,support_external_services:Ia,order_ref:Aa,requested_at:Da,estimated_completion:Ra,time_remaining:Ma,mute:Ea,unmute:Oa,confirm:Pa,need_conversation:Fa,tap_to_speak:La,order_summary:Ba,send_to_reception:qa,add_note:za,room_number:Ha,enter_room_number:Wa,enter_notes:Va,summary:Ga,generated_at:Ya,order_confirmed:Ua,order_confirmed_message:Xa,order_reference:Ka,estimated_delivery_time:Za,return_to_home:Ja,press_to_call_desc:Qa,confirm_request_desc:ec,send_to_reception_desc:tc,status_acknowledged:sc,status_in_progress:nc,status_delivering:oc,status_completed:rc,status_note:ic,icon_login:ac,icon_hourglass_empty:cc,icon_info:lc,icon_policy:dc,icon_wifi:mc,icon_restaurant:uc,icon_local_bar:hc,icon_cleaning_services:pc,icon_local_laundry_service:xc,icon_alarm:gc,icon_add_circle:fc,icon_build:bc,icon_event_seat:_c,icon_spa:yc,icon_fitness_center:vc,icon_pool:wc,icon_directions_car:jc,icon_medical_services:Nc,icon_support_agent:$c,icon_location_on:Sc,icon_local_dining:kc,icon_directions_bus:Cc,icon_event:Tc,icon_shopping_bag:Ic,icon_map:Ac,icon_translate:Dc,icon_rate_review:Rc,icon_report_problem:Mc,icon_luggage:Ec,generating_your_summary:Oc},Fc="미년 호텔에 오신 것을 환영합니다",Lc="시작",Bc="언어",qc="영어",zc="프랑스어",Hc="러시아어",Wc="한국어",Vc="보내기",Gc="취소",Yc="요청 확인",Uc="객실",Xc="주문 ID",Kc="투숙객 이름",Zc="내용",Jc="시간",Qc="상태",el="동작",tl="게스트에게 메시지 보내기",sl="직원 요청 관리",nl="로그인",ol="사용자 이름",rl="비밀번호",il="무이네 호텔",al="AI 어시스턴트 - 모든 필요를 지원합니다",cl="호출하려면 누르세요",ll="객실 및 숙박",dl="객실 서비스",ml="예약 및 시설",ul="관광 및 탐험",hl="외부 서비스 지원",pl="주문 참조",xl="요청 시간",gl="예상 완료 시간",fl="남은 시간",bl="음소거",_l="음소거 해제",yl="확인",vl="먼저 어시스턴트와 대화해 주세요.",wl="말하려면 누르세요",jl="주문 요약",Nl="프런트로 보내기",$l="메모 추가",Sl="객실 번호",kl="객실 번호를 입력하세요",Cl="추가 메모를 입력하세요",Tl="요약",Il="생성 시간",Al="주문이 확인되었습니다!",Dl="귀하의 요청이 확인되어 직원에게 전달되었습니다. 즉시 처리하겠습니다.",Rl="주문 참조",Ml="예상 배달 시간:",El="홈으로 돌아가기",Ol="요청을 시작하려면 호출 버튼을 누르세요.",Pl="정확성을 위해 요청을 확인하세요.",Fl="귀하의 요청이 프런트로 전송되어 처리됩니다.",Ll="접수됨",Bl="처리 중",ql="배달 중",zl="완료됨",Hl="특별 안내",Wl="체크인/체크아웃",Vl="숙박 연장 요청",Gl="객실 정보",Yl="호텔 정책",Ul="와이파이 서비스",Xl="룸서비스 음식",Kl="음료 및 바 서비스",Zl="객실 청소",Jl="세탁 서비스",Ql="모닝콜 서비스",ed="추가 편의 시설",td="유지보수 요청",sd="레스토랑 예약",nd="스파 서비스",od="피트니스 센터",rd="수영장",id="렌터카",ad="의료 지원",cd="고객 지원",ld="지역 명소",dd="지역 레스토랑",md="대중교통",ud="지역 이벤트",hd="쇼핑 지역",pd="지역 지도",xd="번역 서비스",gd="리뷰 남기기",fd="문제 신고",bd="수화물 서비스",_d="요약을 생성하는 중...",yd={welcome:Fc,start:Lc,language:Bc,english:qc,french:zc,russian:Hc,korean:Wc,send:Vc,cancel:Gc,confirm_request:Yc,room:Uc,order_id:Xc,guest_name:Kc,content:Zc,time:Jc,status:Qc,action:el,message_guest:tl,request_management:sl,login:nl,username:ol,password:rl,hotel_name:il,hotel_subtitle:al,press_to_call:cl,room_and_stay:ll,room_services:dl,bookings_and_facilities:ml,tourism_and_exploration:ul,support_external_services:hl,order_ref:pl,requested_at:xl,estimated_completion:gl,time_remaining:fl,mute:bl,unmute:_l,confirm:yl,need_conversation:vl,tap_to_speak:wl,order_summary:jl,send_to_reception:Nl,add_note:$l,room_number:Sl,enter_room_number:kl,enter_notes:Cl,summary:Tl,generated_at:Il,order_confirmed:Al,order_confirmed_message:Dl,order_reference:Rl,estimated_delivery_time:Ml,return_to_home:El,press_to_call_desc:Ol,confirm_request_desc:Pl,send_to_reception_desc:Fl,status_acknowledged:Ll,status_in_progress:Bl,status_delivering:ql,status_completed:zl,status_note:Hl,icon_login:Wl,icon_hourglass_empty:Vl,icon_info:Gl,icon_policy:Yl,icon_wifi:Ul,icon_restaurant:Xl,icon_local_bar:Kl,icon_cleaning_services:Zl,icon_local_laundry_service:Jl,icon_alarm:Ql,icon_add_circle:ed,icon_build:td,icon_event_seat:sd,icon_spa:nd,icon_fitness_center:od,icon_pool:rd,icon_directions_car:id,icon_medical_services:ad,icon_support_agent:cd,icon_location_on:ld,icon_local_dining:dd,icon_directions_bus:md,icon_event:ud,icon_shopping_bag:hd,icon_map:pd,icon_translate:xd,icon_rate_review:gd,icon_report_problem:fd,icon_luggage:bd,generating_your_summary:_d},vd="Khách sạn Mui Ne",wd="Trợ lý giọng nói AI - Hỗ trợ mọi nhu cầu của bạn",jd="Nhấn để nói",Nd="Phòng & Lưu trú",$d="Dịch vụ phòng",Sd="Đặt chỗ & Tiện ích",kd="Du lịch & Khám phá",Cd="Hỗ trợ đặt dịch vụ bên ngoài",Td="Mã đơn",Id="Thời gian yêu cầu",Ad="Dự kiến hoàn thành",Dd="Thời gian còn lại",Rd="Tắt mic",Md="Bật mic",Ed="Xác nhận",Od="Vui lòng nói chuyện với trợ lý trước.",Pd="Chạm để nói",Fd="Tóm tắt đơn hàng",Ld="Xác nhận",Bd="Thêm ghi chú",qd="Số phòng",zd="Nhập số phòng",Hd="Nhập ghi chú bổ sung",Wd="Tóm tắt",Vd="Tạo lúc",Gd="Đã xác nhận đơn!",Yd="Yêu cầu của bạn đã được xác nhận và chuyển đến nhân viên. Chúng tôi sẽ xử lý ngay lập tức.",Ud="Mã tham chiếu",Xd="Thời gian giao dự kiến:",Kd="Về trang chủ",Zd="Ngôn ngữ",Jd="Tiếng Anh",Qd="Tiếng Pháp",em="Gửi",tm="Hủy",sm="Kết thúc cuộc gọi",nm="Phòng",om="Mã đơn",rm="Tên khách",im="Nội dung",am="Thời gian",cm="Trạng thái",lm="Hành động",dm="Nhắn khách",mm="Quản lý yêu cầu nhân viên",um="Đăng nhập",hm="Tên đăng nhập",pm="Mật khẩu",xm="Nhấn nút gọi để bắt đầu yêu cầu của bạn.",gm="Xem lại và xác nhận yêu cầu của bạn.",fm="Yêu cầu của bạn sẽ được gửi đến lễ tân để xử lý.",bm="Đã ghi nhận",_m="Đang xử lý",ym="Đang giao cho bạn",vm="Đã hoàn thành",wm="Lưu ý đặc biệt",jm="Nhận/Trả phòng",Nm="Yêu cầu gia hạn lưu trú",$m="Thông tin phòng",Sm="Chính sách khách sạn",km="Dịch vụ Wi-Fi",Cm="Đồ ăn tại phòng",Tm="Dịch vụ đồ uống & quầy bar",Im="Dọn phòng",Am="Giặt là",Dm="Báo thức",Rm="Tiện ích bổ sung",Mm="Yêu cầu bảo trì",Em="Đặt chỗ nhà hàng",Om="Dịch vụ Spa",Pm="Trung tâm thể hình",Fm="Hồ bơi",Lm="Thuê xe",Bm="Hỗ trợ y tế",qm="Chăm sóc khách hàng",zm="Điểm tham quan",Hm="Nhà hàng địa phương",Wm="Phương tiện công cộng",Vm="Sự kiện địa phương",Gm="Khu mua sắm",Ym="Bản đồ khu vực",Um="Dịch vụ phiên dịch",Xm="Đánh giá",Km="Báo sự cố",Zm="Dịch vụ hành lý",Jm="Đang tạo tóm tắt của bạn...",Qm={hotel_name:vd,hotel_subtitle:wd,press_to_call:jd,room_and_stay:Nd,room_services:$d,bookings_and_facilities:Sd,tourism_and_exploration:kd,support_external_services:Cd,order_ref:Td,requested_at:Id,estimated_completion:Ad,time_remaining:Dd,mute:Rd,unmute:Md,confirm:Ed,need_conversation:Od,tap_to_speak:Pd,order_summary:Fd,send_to_reception:Ld,add_note:Bd,room_number:qd,enter_room_number:zd,enter_notes:Hd,summary:Wd,generated_at:Vd,order_confirmed:Gd,order_confirmed_message:Yd,order_reference:Ud,estimated_delivery_time:Xd,return_to_home:Kd,language:Zd,english:Jd,french:Qd,send:em,cancel:tm,confirm_request:sm,room:nm,order_id:om,guest_name:rm,content:im,time:am,status:cm,action:lm,message_guest:dm,request_management:mm,login:um,username:hm,password:pm,press_to_call_desc:xm,confirm_request_desc:gm,send_to_reception_desc:fm,status_acknowledged:bm,status_in_progress:_m,status_delivering:ym,status_completed:vm,status_note:wm,icon_login:jm,icon_hourglass_empty:Nm,icon_info:$m,icon_policy:Sm,icon_wifi:km,icon_restaurant:Cm,icon_local_bar:Tm,icon_cleaning_services:Im,icon_local_laundry_service:Am,icon_alarm:Dm,icon_add_circle:Rm,icon_build:Mm,icon_event_seat:Em,icon_spa:Om,icon_fitness_center:Pm,icon_pool:Fm,icon_directions_car:Lm,icon_medical_services:Bm,icon_support_agent:qm,icon_location_on:zm,icon_local_dining:Hm,icon_directions_bus:Wm,icon_event:Vm,icon_shopping_bag:Gm,icon_map:Ym,icon_translate:Um,icon_rate_review:Xm,icon_report_problem:Km,icon_luggage:Zm,generating_your_summary:Jm},eu={en:Fn,fr:yr,zh:ta,ru:Pc,ko:yd,vi:Qm};function N(n,t="en"){return eu[t][n]||n}class tu{constructor(t){this.gradientRotation=0,this.isHovered=!1,this.isActive=!1,this.waveformPhase=0,this.particles=[],this.mouseX=0,this.mouseY=0,this.isDarkMode=!1,this.elapsedTime=0,this.displayedTime=0,this.timeTarget=60,this.idleFrame=0,this.lastActiveTime=Date.now(),this.idleFlash=0,this.canvas=document.createElement("canvas");const s=document.getElementById(t);if(!s)throw new Error("Container element not found");s.appendChild(this.canvas);const o=this.canvas.getContext("2d");if(!o)throw new Error("Could not get canvas context");this.ctx=o,this.width=200,this.height=200,this.centerX=this.width/2,this.centerY=this.height/2,this.radius=40,this.ripples=[],this.isListening=!1,this.pulsePhase=0,this.volumeLevel=0,this.animationFrameId=0,this.resize(),this.animate(),window.addEventListener("resize",this.resize.bind(this)),s&&(s.addEventListener("mouseenter",()=>{this.isHovered=!0,this.lastActiveTime=Date.now()}),s.addEventListener("mouseleave",()=>{this.isHovered=!1,this.isActive=!1}),s.addEventListener("mousedown",()=>{this.isActive=!0,this.lastActiveTime=Date.now()}),s.addEventListener("mouseup",()=>{this.isActive=!1}),s.addEventListener("mousemove",a=>{const m=s.getBoundingClientRect();this.mouseX=a.clientX-m.left,this.mouseY=a.clientY-m.top,this.lastActiveTime=Date.now()})),this.isDarkMode=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",a=>{this.isDarkMode=a.matches})}resize(){const t=this.canvas.parentElement;if(!t)return;const s=window.devicePixelRatio||1,o=Math.min(t.clientWidth,t.clientHeight);this.width=this.height=o,this.canvas.width=this.canvas.height=o*s,this.canvas.style.width=this.canvas.style.height=`${o}px`,this.canvas.style.borderRadius="50%",this.canvas.style.overflow="hidden",this.ctx.setTransform(1,0,0,1,0,0),this.ctx.scale(s,s),this.centerX=this.width/2,this.centerY=this.height/2}drawTexturePattern(){const t="rgba(232,181,84,0.18)";for(let o=-this.radius;o<this.radius;o+=14)for(let a=-this.radius;a<this.radius;a+=14)o*o+a*a<this.radius*this.radius*.85&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(this.centerX+o,this.centerY+a,1.2,0,Math.PI*2),this.ctx.fillStyle=t,this.ctx.fill(),this.ctx.restore())}drawLightBeam(){if(!(this.isHovered||this.isActive))return;this.ctx.save();const t=this.ctx.createLinearGradient(this.centerX,this.centerY-this.radius*1.3,this.centerX,this.centerY+this.radius*.5);t.addColorStop(0,"rgba(255,255,255,0.22)"),t.addColorStop(.5,"rgba(255,255,255,0.08)"),t.addColorStop(1,"rgba(255,255,255,0)"),this.ctx.beginPath(),this.ctx.ellipse(this.centerX,this.centerY-this.radius*.7,this.radius*.7,this.radius*.22,0,0,2*Math.PI),this.ctx.fillStyle=t,this.ctx.filter="blur(2.5px)",this.ctx.fill(),this.ctx.filter="none",this.ctx.restore()}drawBaseCircle(){let t=0,s=0;this.isHovered&&(t=(this.mouseX-this.centerX)*.07,s=(this.mouseY-this.centerY)*.07),this.gradientRotation+=.0025;const o=this.gradientRotation%(2*Math.PI),a=this.centerX+Math.cos(o)*this.radius*1.2,m=this.centerY+Math.sin(o)*this.radius*1.2,l=this.ctx.createLinearGradient(this.centerX-this.radius*1.2+t,this.centerY-this.radius*1.2+s,a+t,m+s);l.addColorStop(0,this.isDarkMode?"#559A9A":"#5DB6B9"),l.addColorStop(1,this.isDarkMode?"#559A9A":"#5DB6B9"),this.ctx.save(),this.ctx.globalAlpha=.85,this.ctx.beginPath(),this.ctx.arc(this.centerX+t,this.centerY+s,this.radius*1.25,0,Math.PI*2),this.ctx.strokeStyle=l,this.ctx.lineWidth=12,this.ctx.shadowColor=(this.isHovered,"#559A9A"),this.ctx.shadowBlur=this.isHovered?32:16,this.ctx.stroke(),this.ctx.restore(),this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(this.centerX+t,this.centerY+s,this.radius*1.13,0,Math.PI*2),this.ctx.fillStyle=this.isDarkMode?"rgba(40,50,80,0.18)":"rgba(255,255,255,0.10)",this.ctx.filter="blur(2.5px)",this.ctx.fill(),this.ctx.filter="none",this.ctx.restore(),this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(this.centerX+t,this.centerY+s,this.radius*.98,0,Math.PI*2),this.ctx.fillStyle=this.isDarkMode?"#bfa133":"#E8B554",this.ctx.shadowColor=this.isDarkMode?"rgba(85,154,154,0.18)":"rgba(85,154,154,0.25)",this.ctx.shadowBlur=10,this.ctx.fill(),this.ctx.restore(),this.drawTexturePattern(),this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(this.centerX+t,this.centerY+s,this.radius*.98,0,Math.PI*2),this.ctx.shadowColor=this.isDarkMode?"rgba(85,154,154,0.10)":"rgba(85,154,154,0.18)",this.ctx.shadowBlur=24,this.ctx.globalAlpha=.7,this.ctx.strokeStyle="rgba(0,0,0,0)",this.ctx.lineWidth=8,this.ctx.stroke(),this.ctx.restore(),this.drawLightBeam(),this.drawMicIcon(t,s)}drawMicIcon(t=0,s=0){let o=.85+.15*Math.sin(this.pulsePhase*1.5);this.isHovered&&(o*=1.08),this.isActive&&(o*=.95),this.ctx.save(),this.ctx.translate(this.centerX+t,this.centerY+s),this.ctx.scale(o,o),this.ctx.shadowColor=this.isHovered?"rgba(255,255,255,0.95)":"rgba(255,255,255,0.7)",this.ctx.shadowBlur=16+8*o+(this.isHovered?8:0),this.ctx.beginPath(),this.ctx.moveTo(0,18),this.ctx.arc(0,0,18,Math.PI*.15,Math.PI*1.85,!1),this.ctx.lineTo(0,18),this.ctx.closePath(),this.ctx.fillStyle="rgba(255,255,255,0.92)",this.ctx.fill(),this.ctx.beginPath(),this.ctx.moveTo(-4,18),this.ctx.lineTo(-4,28),this.ctx.lineTo(4,28),this.ctx.lineTo(4,18),this.ctx.closePath(),this.ctx.fillStyle="rgba(255,255,255,0.92)",this.ctx.fill(),this.ctx.beginPath(),this.ctx.arc(0,28,6,0,Math.PI,!0),this.ctx.fillStyle="rgba(255,255,255,0.7)",this.ctx.fill(),this.ctx.restore()}drawRipples(){for(let t=this.ripples.length-1;t>=0;t--){const s=this.ripples[t];if(s.radius+=s.speed,s.alpha-=.01,s.alpha<=0){this.ripples.splice(t,1);continue}this.ctx.beginPath(),this.ctx.arc(this.centerX,this.centerY,s.radius,0,Math.PI*2),this.ctx.strokeStyle=`rgba(85,154,154, ${s.alpha})`,this.ctx.lineWidth=2,this.ctx.stroke()}}drawPulsingRing(){if(this.isListening){const t=this.radius+10+Math.sin(this.pulsePhase)*5,s=this.volumeLevel*20;this.ctx.beginPath(),this.ctx.arc(this.centerX,this.centerY,t+s,0,Math.PI*2),this.ctx.strokeStyle="rgba(33, 150, 243, 0.5)",this.ctx.lineWidth=3,this.ctx.stroke(),this.pulsePhase+=.1}}drawWaveform(){if(!this.isListening)return;const t=4;this.waveformPhase+=.08+this.volumeLevel*.12;for(let s=1;s<=t;s++){const o=this.radius*.98+s*10+Math.sin(this.waveformPhase+s)*3*(1+this.volumeLevel);this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(this.centerX,this.centerY,o,0,Math.PI*2),this.ctx.strokeStyle=`rgba(232,181,84,${.18+.08*(t-s)})`,this.ctx.lineWidth=2+this.volumeLevel*2,this.ctx.shadowColor="rgba(85,154,154,0.22)",this.ctx.shadowBlur=8,this.ctx.stroke(),this.ctx.restore()}}drawParticles(){if(this.isListening&&Math.random()<.18){const t=Math.random()*2*Math.PI,s=this.radius*1.18+Math.random()*16;this.particles.push({x:this.centerX+Math.cos(t)*s,y:this.centerY+Math.sin(t)*s,alpha:.7+Math.random()*.3,size:2+Math.random()*2,speed:.5+Math.random()*.7})}for(let t=this.particles.length-1;t>=0;t--){const s=this.particles[t];if(s.alpha-=.012,s.size*=.98,s.y-=s.speed*.5,s.x+=Math.sin(s.y*.1)*.2,s.alpha<=.05||s.size<.5){this.particles.splice(t,1);continue}this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(s.x,s.y,s.size,0,Math.PI*2),this.ctx.fillStyle=`rgba(232,181,84,${s.alpha})`,this.ctx.shadowColor="rgba(85,154,154,0.22)",this.ctx.shadowBlur=6,this.ctx.fill(),this.ctx.restore()}}drawTimeRing(){const t=Math.min(1,this.elapsedTime/this.timeTarget),s=t<.5?"#E8B554":t<1?"#d4af37":"#e53935";this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(this.centerX,this.centerY,this.radius*1.32,-Math.PI/2,-Math.PI/2+t*2*Math.PI),this.ctx.strokeStyle=s,this.ctx.lineWidth=4,this.ctx.shadowColor=s,this.ctx.shadowBlur=t>.95?16:6,this.ctx.globalAlpha=.85,this.ctx.stroke(),this.ctx.restore()}drawTimeText(){this.displayedTime+=(this.elapsedTime-this.displayedTime)*.18;const t=Math.round(this.displayedTime),s=Math.floor(t/60).toString().padStart(2,"0"),o=(t%60).toString().padStart(2,"0"),a=`${s}:${o}`;this.ctx.save(),this.ctx.font="600 1.25rem Montserrat, Raleway, Arial, sans-serif",this.ctx.textAlign="center",this.ctx.textBaseline="top",this.ctx.shadowColor="rgba(85,154,154,0.22)",this.ctx.shadowBlur=8,this.ctx.fillStyle="#fff",this.isDarkMode&&(this.ctx.fillStyle="#e8e8e8"),this.ctx.globalAlpha=.95,this.ctx.fillText(a,this.centerX,this.centerY+this.radius*1.45),this.ctx.restore()}drawIdleFlash(){if(Date.now()-this.lastActiveTime>6e3){this.idleFlash+=.08;const s=.7+.3*Math.abs(Math.sin(this.idleFlash*1.2));this.ctx.save(),this.ctx.globalAlpha=.18*s,this.ctx.beginPath(),this.ctx.arc(this.centerX,this.centerY,this.radius*1.18,0,Math.PI*2),this.ctx.fillStyle="#E8B554",this.ctx.filter="blur(2.5px)",this.ctx.fill(),this.ctx.filter="none",this.ctx.restore()}else this.idleFlash=0}drawVolumeVisualization(){if(!this.isListening)return;const t=16,s=this.radius*1.08;for(let o=0;o<t;o++){const a=2*Math.PI*o/t,m=8+Math.sin(this.waveformPhase+o)*4+this.volumeLevel*18,l=this.centerX+Math.cos(a)*s,i=this.centerY+Math.sin(a)*s,c=this.centerX+Math.cos(a)*(s+m),_=this.centerY+Math.sin(a)*(s+m);this.ctx.save(),this.ctx.strokeStyle=`rgba(232,181,84,${.18+.18*this.volumeLevel})`,this.ctx.lineWidth=2.2,this.ctx.beginPath(),this.ctx.moveTo(l,i),this.ctx.lineTo(c,_),this.ctx.shadowColor="rgba(85,154,154,0.22)",this.ctx.shadowBlur=6,this.ctx.stroke(),this.ctx.restore()}}animate(){const t=Math.min(this.width,this.height)<340;this.radius=t?Math.max(32,Math.min(this.width,this.height)/2.8):Math.max(36,Math.min(this.width,this.height)/5.2),this.ctx.clearRect(0,0,this.width,this.height),this.drawBaseCircle(),this.drawWaveform(),this.drawParticles(),this.drawRipples(),this.drawPulsingRing(),this.drawTimeRing(),this.drawTimeText(),this.drawIdleFlash(),this.drawVolumeVisualization(),this.isListening&&Math.random()<(t?.05:.1)&&this.ripples.push({radius:this.radius,alpha:.4,speed:1+this.volumeLevel*2}),this.animationFrameId=requestAnimationFrame(this.animate.bind(this))}setListening(t){this.isListening=t,t&&(this.ripples=[])}setVolumeLevel(t){this.volumeLevel=Math.max(0,Math.min(1,t))}setTime(t,s=60){this.elapsedTime=t,this.timeTarget=s}getTime(){return this.elapsedTime}cleanup(){window.removeEventListener("resize",this.resize),this.animationFrameId&&cancelAnimationFrame(this.animationFrameId),this.canvas.remove()}}const at=({isListening:n,volumeLevel:t,containerId:s})=>{const o=r.useRef(null);return r.useEffect(()=>(o.current=new tu(s),()=>{o.current&&(o.current.cleanup(),o.current=null)}),[s]),r.useEffect(()=>{o.current&&o.current.setListening(n)},[n]),r.useEffect(()=>{o.current&&o.current.setVolumeLevel(t)},[t]),e.jsx("div",{id:s,className:"w-[220px] h-[220px] relative rounded-full overflow-visible",style:{cursor:"pointer",borderRadius:"50%"}})},Me=({isOpen:n,onClose:t,isRight:s})=>{const{transcripts:o,modelOutput:a,language:m}=te(),l=r.useRef(null),i=r.useRef({}),[c,_]=r.useState({}),[x,S]=r.useState([]),D=()=>{Object.values(i.current).forEach(w=>{cancelAnimationFrame(w)}),i.current={}};return r.useEffect(()=>{const w=[...o].sort((d,j)=>d.timestamp.getTime()-j.timestamp.getTime()),g=[];let T=null;w.forEach(d=>{d.role==="user"?(T={id:d.id.toString(),role:"user",timestamp:d.timestamp,messages:[{id:d.id.toString(),content:d.content,timestamp:d.timestamp}]},g.push(T)):((!T||T.role==="user")&&(T={id:d.id.toString(),role:"assistant",timestamp:d.timestamp,messages:[]},g.push(T)),T.messages.push({id:d.id.toString(),content:d.content,timestamp:d.timestamp}))}),S(g)},[o]),r.useEffect(()=>(x.filter(g=>g.role==="assistant").flatMap(g=>g.messages).forEach(g=>{if(c[g.id]===g.content.length)return;let T=c[g.id]||0;const d=g.content,j=()=>{T<d.length?(_(I=>({...I,[g.id]:T+1})),T++,i.current[g.id]=requestAnimationFrame(j)):delete i.current[g.id]};i.current[g.id]=requestAnimationFrame(j)}),()=>D()),[x]),r.useEffect(()=>{l.current&&(l.current.scrollTop=l.current.scrollHeight)},[x]),n?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`relative z-30 overflow-hidden rounded-2xl shadow-2xl realtime-popup ${s?"popup-right":""}`,style:{width:"90vw",maxWidth:360,height:"70vh",maxHeight:440,background:"rgba(255,255,255,0.12)",backdropFilter:"blur(18px)",WebkitBackdropFilter:"blur(18px)",border:"1.5px solid rgba(255,255,255,0.25)",boxShadow:s?"0 8px 32px rgba(0,0,0,0.18), 8px 0 24px rgba(0,0,0,0.10)":"0 8px 32px rgba(0,0,0,0.18)",borderTopLeftRadius:24,borderBottomLeftRadius:24,borderTopRightRadius:24,borderBottomRightRadius:24},children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200/40 bg-white/10",style:{backdropFilter:"blur(4px)"},children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Conversation"}),e.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(Se,{className:"w-5 h-5 text-gray-500"})})]}),e.jsxs("div",{ref:l,className:"p-4 h-[calc(100%-4rem)] overflow-y-auto",children:[x.length===0&&e.jsx("div",{className:"text-gray-400 text-base text-center select-none",style:{opacity:.7},children:N("tap_to_speak",m)}),x.map((w,g)=>e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{background:w.role==="user"?"#3B82F6":"#10B981"},children:e.jsx("span",{className:"text-white text-sm",children:w.role==="user"?"U":"A"})}),e.jsxs("div",{className:"flex-1",children:[w.role==="user"?e.jsx("div",{className:"bg-gray-100 rounded-lg p-3",children:e.jsx("p",{className:"text-gray-800",children:w.messages[0].content})}):e.jsx("div",{className:"bg-green-50 rounded-lg p-3",children:e.jsxs("p",{className:"text-base md:text-lg font-medium",style:{position:"relative",background:"linear-gradient(90deg, #FF512F, #F09819, #FFD700, #56ab2f, #43cea2, #1e90ff, #6a11cb, #FF512F)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",fontWeight:600,letterSpacing:.2,transition:"background 0.5s"},children:[e.jsx("span",{className:"inline-flex flex-wrap",children:w.messages.map((T,d)=>{const j=T.content.slice(0,c[T.id]||0);return e.jsxs("span",{style:{whiteSpace:"pre"},children:[j,d===w.messages.length-1&&g===0&&c[T.id]<T.content.length&&e.jsx("span",{className:"animate-blink text-yellow-500",style:{marginLeft:1},children:"|"})]},T.id)})}),g===0&&w.role==="assistant"&&c[w.messages[w.messages.length-1].id]===w.messages[w.messages.length-1].content.length&&e.jsx("span",{className:"ml-2 animate-ellipsis text-yellow-500",children:"..."})]})}),e.jsx("span",{className:"text-xs text-gray-500 mt-1 block",children:w.timestamp.toLocaleTimeString()})]})]})},w.id))]})]}),e.jsx("style",{children:`
        @media (min-width: 640px) {
          .realtime-popup {
            width: 340px !important;
            height: 420px !important;
            max-width: 340px !important;
            max-height: 420px !important;
          }
          .popup-right {
            /* Có thể thêm hiệu ứng đối xứng nếu muốn */
          }
        }
      `})]}):null},Ee=({isOpen:n,onClose:t})=>n?e.jsxs("div",{className:"relative z-30 overflow-hidden rounded-2xl shadow-2xl reference-popup",style:{width:"90vw",maxWidth:360,height:"70vh",maxHeight:440,background:"rgba(255,255,255,0.12)",backdropFilter:"blur(18px)",WebkitBackdropFilter:"blur(18px)",border:"1.5px solid rgba(255,255,255,0.25)",boxShadow:"0 8px 32px rgba(0,0,0,0.18)"},children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200/40 bg-white/10",style:{backdropFilter:"blur(4px)"},children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Reference"}),e.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx("span",{className:"material-icons text-gray-500",children:"close"})})]}),e.jsx("div",{className:"p-4 h-[calc(100%-4rem)] overflow-y-auto flex items-center justify-center text-gray-400"}),e.jsx("style",{children:`
        @media (min-width: 640px) {
          .reference-popup {
            width: 340px !important;
            height: 420px !important;
            max-width: 340px !important;
            max-height: 420px !important;
          }
        }
      `})]}):null,X={roomNumber:/(?:room(?:\s+number)?|room|phòng)(?:\s*[:#\-]?\s*)([0-9]{1,4}[A-Za-z]?)|(?:staying in|in room|in phòng|phòng số)(?:\s+)([0-9]{1,4}[A-Za-z]?)/i,food:/food|beverage|breakfast|lunch|dinner|meal|drink|snack|restaurant/i,housekeeping:/housekeeping|cleaning|towel|cleaning\s*service|laundry/i,roomService:/room\s*service/i,spa:/spa|massage|wellness|treatment/i,transportation:/transportation|taxi|car|shuttle|airport\s*transfer/i,tours:/tour|sightseeing|excursion|attraction|visit|activity/i,technical:/wifi|internet|tv|television|remote|device|technical|connection/i,concierge:/reservation|booking|restaurant|ticket|arrangement|concierge/i,wellness:/gym|fitness|exercise|yoga|swimming|pool|sauna/i,security:/safe|security|lost|found|key|card|lock|emergency/i,specialOccasion:/birthday|anniversary|celebration|honeymoon|proposal|wedding|special occasion/i,other:/currency\s*exchange|money\s*change|exchange\s*money|foreign\s*currency|bus\s*ticket|train\s*ticket|sell|purchase|buy/i,deliveryTime:{asap:/as\s*soon\s*as\s*possible|right\s*away|immediately|asap/i,thirtyMin:/30\s*min|half\s*an\s*hour|30\s*minutes/i,oneHour:/(?:1|one)\s*hour|60\s*minutes/i,specific:/specific\s*time|scheduled|later|tomorrow|tonight|afternoon|evening|morning/i},specialInstructions:/special(?:\s+instructions?|(?:\s+notes?)|(?:\s+requests?))(?:\s*:)?\s*([^\.]+)/i,items:/(?:ordered|requested|asked for|items|item)(?:\s*:)?\s*([^\.]+)/i,totalAmount:/(?:total(?:\s+amount)?|cost|price|charge)(?:\s*:)?\s*\$?\s*([0-9]+(?:\.[0-9]{1,2})?)/i},su={roomService:"room-service",food:"food-beverage",housekeeping:"housekeeping",transportation:"transportation",spa:"spa",tours:"tours-activities",technical:"technical-support",concierge:"concierge",wellness:"wellness-fitness",security:"security",specialOccasion:"special-occasions",wifi:"wifi-faq",checkIn:"check-in-out",checkOut:"check-in-out",information:"hotel-info",tourism:"attractions",feedback:"feedback",support:"support",other:"other"};function $e(n){const t=n.match(X.roomNumber);if(t)return t[1]||t[2]||null;const s=n.match(/(?:room details|room number|phòng số)(?:\s*[:#\-]?\s*)([0-9]{1,4}[A-Za-z]?)/i);if(s&&s[1])return s[1];const o=n.match(/(?:details[\s\S]*?room(?:\s+number)?[\s\S]*?)([0-9]{1,4}[A-Za-z]?)/i);return o&&o[1]?o[1]:null}function nu(n){const t=[];X.food.test(n)&&t.push("food"),X.housekeeping.test(n)&&t.push("housekeeping"),X.transportation.test(n)&&t.push("transportation"),X.roomService.test(n)&&t.push("roomService"),X.spa.test(n)&&t.push("spa"),X.tours.test(n)&&t.push("tours"),X.technical.test(n)&&t.push("technical"),X.concierge.test(n)&&t.push("concierge"),X.wellness.test(n)&&t.push("wellness"),X.security.test(n)&&t.push("security"),X.specialOccasion.test(n)&&t.push("specialOccasion"),X.other.test(n)&&t.push("other");const s=t.map(o=>su[o]||"other");return s.length>0?s:["other"]}function ou(n){return nu(n).join(",")}function ru(n){return X.deliveryTime.asap.test(n)?"asap":X.deliveryTime.thirtyMin.test(n)?"30min":X.deliveryTime.oneHour.test(n)?"1hour":X.deliveryTime.specific.test(n)?"specific":"asap"}function iu(n){const t=n.match(X.specialInstructions);return t?t[1].trim():""}function au(n){const t=n.match(X.items);let s=[];const o=n.match(/(?:^|\n)[-•*]\s*([^\n]+)/g);if(o&&o.length>0){const l=o.map((i,c)=>{const _=i.replace(/^[-•*]\s*/,"").trim();return ge(_,c)}).filter(i=>i.name.length>0);s=[...s,...l]}{const l=n.match(/(?:requested|asked for|ordered|booking|reservation for|inquired about)\s+([^\.;]+)/gi);if(l&&l.length>0){const i=l.map((c,_)=>{const x=c.replace(/(?:requested|asked for|ordered|booking|reservation for|inquired about)\s+/i,"").trim();return ge(x,_)}).filter(c=>c.name.length>0);s=[...s,...i]}}if(t){const c=t[1].split(/(?:,\s*|\s+and\s+|\s*&\s*|\s*\+\s*)/).map((_,x)=>ge(_,x)).filter(_=>_.name.length>0);s=[...s,...c]}if(s.length===0){const l=n.split(/\.(?:\s|$)/);for(let i=0;i<l.length;i++){const c=l[i].trim();(c.toLowerCase().includes("request")||c.toLowerCase().includes("book")||c.toLowerCase().includes("order")||c.toLowerCase().includes("exchange")||c.toLowerCase().includes("inquired"))&&s.push(ge(c,s.length))}}const a=[],m=new Map;for(const l of s){const i=l.name.toLowerCase().replace(/\s+/g," ").trim();let c=!1;const _=Array.from(m.keys());for(const x of _)if(cu(i,x)>.8){c=!0;break}c||(m.set(i,!0),a.push(l))}return a.map((l,i)=>({...l,id:(i+1).toString()}))}function cu(n,t){if(n===t)return 1;if(n.length===0||t.length===0)return 0;const s=n.length>t.length?n:t,o=n.length>t.length?t:n;if(s.includes(o))return o.length/s.length;let a=0;for(let m=0;m<o.length;m++)s.includes(o[m])&&a++;return a/s.length}function ge(n,t){const s=n.trim().replace(/^[-•*]\s+/,"").replace(/^- /,""),o=s.match(/^([0-9]+)\s+(.+)$/),a=o?parseInt(o[1]):1,m=o?o[2]:s;let l="";const i=s.match(/(?:on|for)\s+((?:January|February|March|April|May|June|July|August|September|October|November|December|Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s+\d{1,2}(?:st|nd|rd|th)?(?:,?\s+\d{4})?|\d{1,2}\/\d{1,2}(?:\/\d{2,4})?)/i),c=i?`Date: ${i[1]}`:"",_=s.match(/(\d+)\s+(?:people|person|pax|guest|adult|child|passenger)/i),x=_?`Guests: ${_[1]} people`:"",S=s.match(/(?:to|in|at|for)\s+([A-Z][a-z]+(?:\s+[A-Z][a-z]+)*|[A-Z][A-Z]+|[A-Z][a-z]+)/),D=S?`Location: ${S[1]}`:"",w=s.match(/(?:at|from)\s+(\d{1,2}(?::\d{2})?\s*(?:AM|PM|am|pm))/i),g=w?`Time: ${w[1]}`:"",T=s.match(/(\d+(?:,\d+)*(?:\.\d+)?)\s*(?:USD|US dollars|\$|VND|dong)/i),d=T?`Amount: ${T[1]} ${T[0].includes("USD")||T[0].includes("US")||T[0].includes("$")?"USD":"VND"}`:"",j=[c,x,D,g,d].filter(I=>I.length>0);return j.length>0?l=j.join(`
`):l=`Details for ${m.charAt(0).toLowerCase()+m.slice(1)}`,{id:(t+1).toString(),name:m.charAt(0).toUpperCase()+m.slice(1),description:l,quantity:a,price:lu(m)}}function lu(n){const t=n.toLowerCase();return/sandwich|burger|pasta|steak|fish|chicken|breakfast|lunch|dinner/.test(t)?15:/coffee|tea|juice|water|soda|wine|beer|cocktail|drink/.test(t)?8:/towel|soap|shampoo|toothbrush|toothpaste|amenities/.test(t)?5:/cleaning|housekeeping|laundry|ironing/.test(t)?20:/taxi|car|shuttle|transfer/.test(t)?30:10}function du(n,t){const s=n.match(X.totalAmount);return s?parseFloat(s[1]):t.reduce((o,a)=>o+a.price*a.quantity,0)}function Oe(n){if(!n)return{};const t=$e(n)||"",s=ou(n),o=ru(n),a=iu(n),m=au(n),l=du(n,m);return{roomNumber:t,orderType:s,deliveryTime:o,guestName:"",guestEmail:"",guestPhone:"",specialInstructions:a,items:m,totalAmount:l}}const mu=Ue("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-[10px] text-base font-semibold ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-5 [&_svg]:shrink-0 shadow-sm px-5 py-2",{variants:{variant:{default:"bg-gradient-to-tr from-[#4e5ab7] to-[#3f51b5] text-white hover:brightness-110 hover:shadow-lg",yellow:"bg-gradient-to-b from-[#ffe066] to-[#ffd700] text-blue-900 border-2 border-[#d4af37] shadow-xl hover:brightness-105 hover:shadow-2xl text-shadow-white",outline:"border-2 border-[#4e5ab7] bg-white text-[#4e5ab7] hover:bg-[#f5f7fa]",secondary:"bg-white text-[#4e5ab7] border border-[#4e5ab7] hover:bg-[#e8eaf6]",destructive:"bg-red-500 text-white hover:bg-red-600",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-12 px-6 py-2",sm:"h-10 rounded-md px-4 py-2 text-sm",lg:"h-14 rounded-xl px-8 py-3 text-lg",icon:"h-12 w-12"}},defaultVariants:{variant:"default",size:"default"}}),le=r.forwardRef(({className:n,variant:t,size:s,asChild:o=!1,...a},m)=>{const l=o?yt:"button";return e.jsx(l,{className:Q(mu({variant:t,size:s,className:n})),ref:m,...a})});le.displayName="Button";const ct=({isActive:n})=>{const{orderSummary:t,setOrderSummary:s,setCurrentInterface:o,setOrder:a,callSummary:m,setCallSummary:l,serviceRequests:i,callDuration:c,callDetails:_,emailSentForCurrentSession:x,setEmailSentForCurrentSession:S,addActiveOrder:D,translateToVietnamese:w,language:g}=te(),[T,d]=r.useState({}),[j,I]=r.useState(""),Y=(C,p)=>{t&&s({...t,[C]:p})};r.useEffect(()=>{if(i&&i.length>0){const C=i.reduce((p,$)=>{const E=$.serviceType;return p[E]||(p[E]=[]),p[E].push($),p},{});if(d(C),t&&(!t.items||t.items.length===0)){const p=i.map(($,E)=>{let F=1;const y=$.details||{},f=$.requestText.match(/(\d+)\s+(towels|bottles|pieces|cups|glasses|plates|servings|items)/i);f?F=parseInt(f[1]):typeof y.people=="number"&&(F=y.people);let b=10;return $.serviceType==="room-service"?b=15:$.serviceType==="housekeeping"?b=8:$.serviceType==="transportation"?b=25:$.serviceType==="tours-activities"?b=35:$.serviceType==="spa"&&(b=30),{id:`item-${E}`,name:$.serviceType,description:$.requestText,quantity:F,price:b}});s({...t,items:p,totalAmount:p.reduce(($,E)=>$+E.price*E.quantity,0)})}}},[i,t,s]),r.useEffect(()=>{if(n&&m&&t){const C=m.content,p=$e(C);if(p&&p!==t.roomNumber&&s({...t,roomNumber:p}),!i||i.length===0){const $=C.match(/List of Requests:([\s\S]*?)(?:\n\nSpecial Instructions|\n\nThe conversation)/);if($){const E=$[1],F=/Request (\d+): ([^\n]+)/g;let y;const f=[];let b=1;for(;(y=F.exec(E))!==null;){const A=y[2].trim(),W=y.index,V=E.indexOf(`Request ${parseInt(y[1])+1}:`,W),O=V>-1?E.substring(W,V):E.substring(W),M=/- ([^:]+): ([^\n]+)/g;let Z;const G={};for(;(Z=M.exec(O))!==null;){const ie=Z[1].trim(),oe=Z[2].trim();G[ie.toLowerCase()]=oe}let K="";G["service description"]&&(K+=`${G["service description"]}`),G.details&&(K+=K?`. ${G.details}`:G.details),G.items&&(K+=K?`
Items: ${G.items}`:`Items: ${G.items}`),G["service timing requested"]&&(K+=`
Timing: ${G["service timing requested"]}`),G.destinations&&(K+=`
Destinations: ${G.destinations}`),K||(K=`Requested ${A} service`),f.push({id:b.toString(),name:A,description:K,quantity:1,price:10}),b++}if(f.length>0&&(!t.items||t.items.length===0)){const A=f.map(Z=>Z.name.toLowerCase().replace(/\s+/g,"-")).join(","),W=$e(C)||t.roomNumber,V=C.match(/Service Timing Requested:?\s*([^\n]+)/i),O=V?V[1]:t.deliveryTime;let M=t.deliveryTime;O&&(/soon|immediate|urgent|right now/i.test(O)?M="asap":/30 minute|half hour/i.test(O)?M="30min":/hour|60 minute/i.test(O)?M="1hour":/schedule|later|specific/i.test(O)&&(M="specific")),s({...t,items:f,orderType:A,roomNumber:W,deliveryTime:M,totalAmount:f.reduce((Z,G)=>Z+G.price*G.quantity,0)})}}}}},[n,m,t,s]);const q=async()=>{if(!t)return;const C=()=>{if(t.roomNumber&&t.roomNumber!=="unknown")return t.roomNumber;if(m&&m.content){const b=m.content.match(/Room Number:?\s*(\w+)/i);if(b&&b[1])return b[1]}return"unknown"},p=t.items&&t.items.length>0?t.items:[{id:"1",name:"General Service",description:"No details provided",quantity:1,price:0}],$=t.orderType||"Room Service",E=t.deliveryTime||"asap",F=`ORD-${Math.floor(1e4+Math.random()*9e4)}`,y=new Date,f={callId:F,roomNumber:C(),orderType:$,deliveryTime:E,specialInstructions:F,items:p,totalAmount:t.totalAmount||0,status:"pending",createdAt:y.toISOString()};try{if(!(await fetch("https://minhnhotelben.onrender.com/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(f)})).ok)throw new Error("Failed to create order");a({reference:f.specialInstructions||f.callId,estimatedTime:f.deliveryTime,summary:t,...f}),o("interface4")}catch{alert("Failed to send order to reception!")}},L=()=>{!j.trim()||!m||l({...m,content:`${m.content}

Additional Notes:
${j}`})};return t?e.jsx("div",{className:`w-full transition-opacity duration-500 ${n?"opacity-100":"opacity-0 pointer-events-none"} z-30`,id:"interface3",style:{backgroundImage:`linear-gradient(rgba(85,154,154,0.7), rgba(121, 219, 220, 0.6)), url(${it})`,backgroundSize:"cover",backgroundPosition:"center",fontFamily:"SF Pro Text, Roboto, Open Sans, Arial, sans-serif"},children:e.jsx("div",{className:"container mx-auto flex flex-col p-2 sm:p-4 md:p-8",children:e.jsxs("div",{className:"mx-auto w-full max-w-4xl bg-white/90 rounded-2xl shadow-xl p-3 sm:p-6 md:p-10 mb-4 sm:mb-6 flex-grow border border-white/40 backdrop-blur-md",style:{minHeight:420},children:[e.jsx("div",{className:"mb-3 sm:mb-4 pb-2 sm:pb-3 border-b border-gray-200",children:e.jsx("p",{className:"font-poppins font-bold text-xl sm:text-2xl text-blue-900 tracking-wide",children:N("order_summary",g)})}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 sm:gap-10 md:gap-16",children:[e.jsxs("div",{className:"md:w-3/4 w-full space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"flex sm:hidden flex-row w-full gap-2 mb-2",children:[e.jsxs("button",{className:"flex-1 flex items-center justify-center px-2 py-1.5 bg-white/80 hover:bg-blue-100 text-blue-900 rounded-full text-xs font-semibold border border-white/30 shadow transition-colors",onClick:()=>o("interface1"),children:[e.jsx("span",{className:"material-icons text-base mr-1",children:"cancel"}),N("cancel",g)]}),e.jsxs(le,{onClick:q,variant:"yellow",className:"flex-1 flex items-center justify-center space-x-2 text-xs font-bold sm:hidden",style:{minHeight:44,minWidth:120,zIndex:10},children:[e.jsx("span",{className:"material-icons",children:"send"}),e.jsx("span",{className:"whitespace-nowrap",children:N("send_to_reception",g)})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 mb-2 sm:hidden",children:[e.jsxs("div",{className:"flex flex-row w-full gap-2",children:[e.jsx("button",{className:"h-10 px-3 bg-[#ffe082] hover:bg-[#ffe9b3] text-blue-900 rounded-full text-xs font-semibold shadow transition-colors flex-1",onClick:L,disabled:!j.trim(),children:N("add_note",g)}),e.jsxs("div",{className:"flex items-center space-x-2 w-full justify-center",children:[e.jsx("label",{className:"text-xs text-gray-600 font-medium",children:N("room_number",g)}),e.jsx("input",{type:"text",placeholder:N("enter_room_number",g),className:"w-16 p-2 border border-white/30 rounded-xl focus:ring-2 focus:ring-[#d4af37] focus:border-[#d4af37] bg-white/70 text-gray-900 font-semibold text-xs",value:t.roomNumber,onChange:C=>Y("roomNumber",C.target.value)})]}),e.jsx("button",{className:"h-10 px-3 bg-white/70 text-blue-900 rounded-full text-xs font-semibold border border-white/30 shadow flex items-center justify-center",onClick:()=>o("interface3vi"),children:e.jsx("span",{className:"material-icons text-base",children:"language"})})]}),e.jsx("textarea",{placeholder:N("enter_notes",g),className:"w-full p-2 border border-white/30 rounded-xl text-xs bg-white/60 focus:bg-white/90 focus:ring-2 focus:ring-[#d4af37] transition italic font-light text-gray-500",value:j,onChange:C=>I(C.target.value),rows:3,style:{fontFamily:"inherit"}})]}),m&&e.jsxs("div",{id:"summary-container",className:"mb-3 sm:mb-4",children:[e.jsxs("div",{className:"p-3 sm:p-5 bg-white/80 rounded-xl shadow border border-white/30 mb-3 sm:mb-4 relative",style:{backdropFilter:"blur(2px)"},children:[e.jsx("h3",{className:"font-semibold text-base sm:text-lg mb-1 sm:mb-2 text-blue-800",children:N("summary",g)}),e.jsx("div",{className:"text-sm sm:text-base leading-relaxed text-gray-800 whitespace-pre-line",style:{fontWeight:400},children:(m.content||"").split(`
`).filter(p=>!/^Next Step:/i.test(p)&&!/Please Press Send To Reception/i.test(p)).map((p,$)=>{if(/^Guest's Name/i.test(p)){const E=p.replace(/\s*\(used for Guest with a confirmed reservation\)/i,"");return e.jsx("div",{children:e.jsx("b",{children:E})},$)}return/^Room Number:/i.test(p)?e.jsx("div",{children:e.jsx("b",{children:p})},$):/^REQUEST \d+:/i.test(p)?e.jsx("div",{className:"mt-3 mb-1",children:e.jsx("b",{children:p})},$):/^• Service Timing:/i.test(p)?e.jsx("div",{style:{marginLeft:16},children:e.jsx("b",{children:p})},$):/^• Order Details:/i.test(p)?e.jsx("div",{style:{marginLeft:16},children:e.jsx("b",{children:p})},$):/^• Special Requirements:/i.test(p)?e.jsx("div",{style:{marginLeft:16},children:e.jsx("b",{children:p})},$):/^• [^-].+/.test(p)?e.jsx("div",{style:{marginLeft:32},children:p},$):/^\s*[-•]/.test(p)?e.jsx("div",{style:{marginLeft:32},children:p},$):/^\s*$/.test(p)?e.jsx("div",{style:{height:8}},$):e.jsx("div",{children:p},$)})}),e.jsx("div",{className:"mt-2 sm:mt-3 flex justify-end",children:e.jsxs("div",{className:"text-xs text-gray-500",children:[N("generated_at",g)," ",new Date(m.timestamp).toLocaleTimeString()]})})]}),e.jsx("div",{className:"text-center mt-2 mb-1",children:e.jsxs("span",{className:"italic text-sm",style:{color:"#2563eb",background:"#e0f2fe",borderRadius:"6px",padding:"4px 12px",display:"inline-block",fontWeight:500},children:["Please Press ",e.jsx("b",{style:{fontWeight:700,color:"#1d4ed8"},children:N("send_to_reception",g)})," To Complete Your Request"]})})]}),e.jsxs("div",{className:"hidden sm:flex flex-row items-center gap-2 h-10",children:[e.jsx("button",{className:"h-10 px-3 sm:px-4 bg-[#ffe082] hover:bg-[#ffe9b3] text-blue-900 rounded-full text-xs sm:text-sm font-semibold shadow transition-colors",onClick:L,disabled:!j.trim(),children:N("add_note",g)}),e.jsxs("div",{className:"flex items-center space-x-2 w-full justify-center",children:[e.jsx("label",{className:"text-xs sm:text-base text-gray-600 font-medium",children:N("room_number",g)}),e.jsx("input",{type:"text",placeholder:N("enter_room_number",g),className:"w-16 sm:w-32 p-2 border border-white/30 rounded-xl focus:ring-2 focus:ring-[#d4af37] focus:border-[#d4af37] bg-white/70 text-gray-900 font-semibold text-xs sm:text-base",value:t.roomNumber,onChange:C=>Y("roomNumber",C.target.value)})]}),e.jsx("button",{className:"h-10 px-3 sm:px-4 bg-white/70 text-blue-900 rounded-full text-xs sm:text-sm font-semibold border border-white/30 shadow flex items-center justify-center",onClick:()=>o("interface3vi"),children:e.jsx("span",{className:"material-icons text-base",children:"language"})})]}),e.jsx("textarea",{placeholder:N("enter_notes",g),className:"hidden sm:block w-full p-2 sm:p-3 border border-white/30 rounded-xl mb-3 sm:mb-4 text-xs sm:text-sm bg-white/60 focus:bg-white/90 focus:ring-2 focus:ring-[#d4af37] transition italic font-light text-gray-500",value:j,onChange:C=>I(C.target.value),rows:3,style:{fontFamily:"inherit"}})]}),e.jsx("div",{className:"md:w-1/4 w-full hidden sm:flex md:justify-end justify-center",children:e.jsxs("div",{className:"flex flex-col items-end space-y-2 sm:space-y-3 w-full md:w-auto",children:[e.jsxs(le,{onClick:q,variant:"yellow",className:"w-full md:w-auto flex items-center justify-center space-x-2 text-xs sm:text-sm font-bold",style:{minHeight:44,minWidth:160,zIndex:10},children:[e.jsx("span",{className:"material-icons",children:"send"}),e.jsx("span",{className:"whitespace-nowrap",children:N("send_to_reception",g)})]}),e.jsxs("button",{className:"w-full md:w-auto flex items-center justify-center px-2 sm:px-3 py-1.5 bg-white/80 hover:bg-blue-100 text-blue-900 rounded-full text-xs font-semibold border border-white/30 shadow transition-colors",onClick:()=>o("interface1"),children:[e.jsx("span",{className:"material-icons text-base mr-1",children:"cancel"}),N("cancel",g)]})]})})]})]})})}):null},uu=({isActive:n})=>{const{setCurrentInterface:t,setTranscripts:s,setModelOutput:o,setCallDetails:a,setCallDuration:m,setEmailSentForCurrentSession:l,activeOrders:i,language:c,setLanguage:_,callSummary:x,orderSummary:S,setOrderSummary:D,endCall:w}=te(),[g,T]=r.useState(!1),[d,j]=r.useState(0),[I,Y]=r.useState(0),[q,L]=r.useState(!1),[C,p]=r.useState(null),[$,E]=r.useState(!1),[F,y]=r.useState(!1),[f,b]=r.useState(!1),[A,W]=r.useState(!1),[V,O]=r.useState(!1),[M,Z]=r.useState(new Date);r.useEffect(()=>{const h=setInterval(()=>Z(new Date),1e3);return()=>clearInterval(h)},[]);const G=()=>{T(!g)},K=h=>{const H=Math.floor(h/60).toString().padStart(2,"0"),J=(h%60).toString().padStart(2,"0");return`${H}:${J}`};r.useCallback(()=>{t("interface1")},[t]),r.useCallback(()=>{t(c==="fr"?"interface3fr":"interface3")},[t,c]),r.useEffect(()=>{let h=null;return n&&(console.log("Interface1 is active, starting local timer"),Y(0),h=setInterval(()=>{Y(H=>H+1)},1e3)),()=>{h&&(console.log("Cleaning up local timer in Interface1"),clearInterval(h))}},[n]);const ie=async h=>{l(!1),a({id:`call-${Date.now()}`,roomNumber:"",duration:"0",category:""}),s([]),o([]),m(0);let H,J;(h==="fr"||h==="zh"||h==="ru"||h==="ko"||h==="vi")&&(H=void 0,J=void 0);const xe=await nt(H);xe&&J&&(await xe.start(J),E(!0),y(!0))},oe=h=>{p(C===h?null:h),C!==h&&setTimeout(()=>{p(H=>H===h?null:H)},3e3)},U=({iconName:h,tooltip:H,className:J})=>e.jsxs("div",{className:"relative flex flex-col items-center justify-center cursor-pointer",children:[e.jsx("span",{className:`material-icons text-xl sm:text-4xl text-[#F9BF3B] ${J||""}`,style:{filter:"drop-shadow(0px 2px 3px rgba(0, 0, 0, 0.2))"},onClick:()=>oe(h),children:h}),C===h&&e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 w-max max-w-[160px] sm:max-w-[200px] bg-white/90 text-gray-800 text-xs sm:text-sm font-medium py-1 px-2 rounded shadow-lg z-50 pointer-events-none text-center",children:[H,e.jsx("div",{className:"absolute w-2 h-2 bg-white/90 transform rotate-45 left-1/2 -translate-x-1/2 top-full -mt-1"})]})]}),de=h=>{if(!h)return{bg:"bg-gray-300",text:"text-gray-800",icon:"info"};switch(h){case"Đã ghi nhận":return{bg:"bg-gray-300",text:"text-gray-800",icon:"assignment_turned_in"};case"Đang thực hiện":return{bg:"bg-yellow-400",text:"text-yellow-900",icon:"autorenew"};case"Đã thực hiện và đang bàn giao cho khách":return{bg:"bg-blue-400",text:"text-blue-900",icon:"local_shipping"};case"Hoàn thiện":return{bg:"bg-green-500",text:"text-white",icon:"check_circle"};case"Lưu ý khác":return{bg:"bg-red-400",text:"text-white",icon:"error"};default:return{bg:"bg-gray-300",text:"text-gray-800",icon:"info"}}},ae=h=>{if(!h)return"status_acknowledged";const H=h.trim().toLowerCase();return H.includes("đã ghi nhận")||H.includes("acknowledged")?"status_acknowledged":H.includes("đang thực hiện")||H.includes("in progress")?"status_in_progress":H.includes("bàn giao")||H.includes("delivering")?"status_delivering":H.includes("hoàn thiện")||H.includes("completed")?"status_completed":H.includes("lưu ý")||H.includes("note")?"status_note":"status_acknowledged"};console.log("ActiveOrders:",i);const u=ue(),k=()=>{u&&u.stop(),E(!1),y(!1),b(!1),t("interface1")},v=async()=>{if(!(!$||!u)){O(!0);try{if(u.stop(),w(),!S&&(x!=null&&x.content)){const h=Oe(x.content);D(h)}!(x!=null&&x.content)||x.content==="Generating AI summary of your conversation..."?W(!0):b(!0)}catch(h){console.error("Error ending call:",h)}finally{O(!1)}}};r.useEffect(()=>{A&&(x!=null&&x.content)&&x.content!=="Generating AI summary of your conversation..."&&(W(!1),b(!0))},[x,A]),r.useEffect(()=>{if(x!=null&&x.content&&x.content!=="Generating AI summary of your conversation..."&&(!S||!S.items||S.items.length===0)){const h=Oe(x.content);D(h)}},[x,S,D]),r.useEffect(()=>{n&&(b(!1),W(!1),E(!1),y(!1))},[n]),r.useEffect(()=>{console.log("activeOrders changed:",i),i&&i.length>0&&(console.log("Setting showOrderCard to true"),L(!0))},[i]),r.useEffect(()=>{console.log("showOrderCard changed:",q)},[q]);const P=[{iconName:"wb_sunny",tooltip:"Half Day"},{iconName:"calendar_today",tooltip:"Full Day"},{iconName:"event_note",tooltip:"Multi Day"},{iconName:"star",tooltip:"Special Tours"}],B=[{iconName:"location_city",tooltip:"Ho Chi Minh"},{iconName:"park",tooltip:"Da Lat"},{iconName:"beach_access",tooltip:"Nha Trang"},{iconName:"waves",tooltip:"Da Nang"},{iconName:"directions_boat",tooltip:"Can Tho"},{iconName:"directions_bus",tooltip:"Vung Tau"},{iconName:"nature_people",tooltip:"My Tho"}],se=[{iconName:"two_wheeler",tooltip:"Motorbike"},{iconName:"drive_eta",tooltip:"Car with driver"},{iconName:"directions_car",tooltip:"Car without Driver"}],z=[{iconName:"attach_money",tooltip:"USD"},{iconName:"euro",tooltip:"EUR"},{iconName:"currency_ruble",tooltip:"RUB"},{iconName:"currency_yen",tooltip:"KWR"},{iconName:"swap_horiz",tooltip:"Other"}],R=[{iconName:"local_laundry_service",tooltip:"Standard"},{iconName:"bolt",tooltip:"Express"},{iconName:"dry_cleaning",tooltip:"Dry Cleaning"},{iconName:"iron",tooltip:"Iron Service"},{iconName:"help",tooltip:"Special Request"}],ne=[{iconName:"home",tooltip:"Under 300.000 VND"},{iconName:"attach_money",tooltip:"300.000 to 600.000 VND"},{iconName:"house_siding",tooltip:"Over 600.000 VND"},{iconName:"calendar_month",tooltip:"Long-Rent"},{iconName:"meeting_room",tooltip:"Full-House"}],me=[{iconName:"map",tooltip:"Area Map"},{iconName:"place",tooltip:"Attractions"},{iconName:"directions_walk",tooltip:"Walking Tour"},{iconName:"info",tooltip:"Tourist Info"}],pe=[{iconName:"restaurant",tooltip:"Order Food"},{iconName:"local_cafe",tooltip:"Beverages"},{iconName:"breakfast_dining",tooltip:"Breakfast"},{iconName:"room_service",tooltip:"Other Requests"}],ht=[{iconName:"cleaning_services",tooltip:"Cleaning"},{iconName:"local_laundry_service",tooltip:"Laundry"},{iconName:"bathtub",tooltip:"Bathroom"},{iconName:"king_bed",tooltip:"Bedding"}],pt=[{iconName:"rate_review",tooltip:"Review"},{iconName:"feedback",tooltip:"Feedback"},{iconName:"star_rate",tooltip:"Rate Us"},{iconName:"question_answer",tooltip:"Q&A"}],xt=[{iconName:"shopping_bag",tooltip:"Souvenir Shop"},{iconName:"local_florist",tooltip:"Handicraft"},{iconName:"redeem",tooltip:"Gift"},{iconName:"storefront",tooltip:"Local Product"}];return e.jsxs("div",{className:`absolute w-full min-h-screen h-full transition-opacity duration-500 ${n?"opacity-100":"opacity-0 pointer-events-none"} z-30 overflow-y-auto`,id:"interface1",style:{backgroundImage:`linear-gradient(rgba(85,154,154,0.7), rgba(121, 219, 220, 0.6)), url(${it})`,backgroundSize:"cover",backgroundPosition:"center",fontFamily:"SF Pro Text, Roboto, Open Sans, Arial, sans-serif"},children:[e.jsxs("div",{className:`container mx-auto flex flex-col items-center justify-start text-white p-3 pt-6 sm:p-5 sm:pt-10 lg:pt-16 overflow-visible pb-32 sm:pb-24 ${V?"opacity-5":"opacity-100"} transition-opacity duration-300`,style:{transform:"translateZ(20px)",minHeight:"fit-content"},children:[e.jsx("div",{className:"w-full flex flex-row items-center justify-start mb-2"}),e.jsx("p",{className:"text-2xl sm:text-4xl lg:text-5xl text-center max-w-full mb-4 truncate sm:whitespace-nowrap overflow-x-auto font-[Dancing_Script,cursive] font-bold bg-gradient-to-r from-red-500 via-orange-400 via-yellow-400 via-green-400 via-blue-500 via-indigo-500 to-purple-600 bg-clip-text text-transparent",style:{fontFamily:"Dancing Script, Poppins, cursive",letterSpacing:1},children:"Speak Multiple Languages with Our AI Voice Assistant"}),e.jsxs("div",{className:"flex flex-row items-start justify-center gap-4 mb-4 sm:mb-12 w-full relative",children:[F&&e.jsx("div",{className:"hidden sm:block flex-shrink-0",style:{marginRight:0},children:e.jsx(Me,{isOpen:F,onClose:()=>y(!1)})}),e.jsx("div",{className:"flex-none flex flex-col items-center justify-center mx-auto",style:{zIndex:10},children:$?e.jsxs("div",{className:"relative flex flex-col items-center justify-center mb-1 sm:mb-6 w-full max-w-xs mx-auto",children:[e.jsx(at,{containerId:"siri-button",isListening:!g,volumeLevel:d}),e.jsxs("div",{className:"flex items-center justify-center mt-2 w-full gap-2 sm:gap-3",children:[e.jsx("button",{className:"flex items-center justify-center transition-colors",title:N(g?"unmute":"mute",c),onClick:G,style:{fontSize:22,padding:0,background:"none",border:"none",color:"#d4af37",width:28,height:28},onMouseOver:h=>h.currentTarget.style.color="#ffd700",onMouseOut:h=>h.currentTarget.style.color="#d4af37",children:e.jsx("span",{className:"material-icons",children:g?"mic_off":"mic"})}),e.jsx("div",{className:"flex-1 flex justify-center",children:e.jsx("div",{className:"text-white text-xs sm:text-sm bg-blue-900/80 rounded-full px-3 sm:px-4 py-1 shadow-lg border border-white/30 flex items-center justify-center",style:{backdropFilter:"blur(2px)"},children:K(I)})}),e.jsx("div",{className:"w-7 h-7 flex items-center justify-center",children:e.jsx("div",{className:"w-5 h-5 rounded-full bg-white/20 flex items-center justify-center",children:e.jsx("div",{className:"w-3 h-3 rounded-full bg-white transition-all duration-200",style:{transform:`scale(${1+d*.5})`,opacity:.7+d*.3}})})})]}),$&&e.jsxs("div",{className:"flex flex-row justify-between items-center w-full max-w-xs mx-auto mt-2 gap-2",children:[e.jsx("button",{className:"flex-1 py-2 rounded-full bg-white hover:bg-red-100 text-red-700 font-semibold text-sm border border-red-200 shadow transition",style:{minWidth:90,maxWidth:120},onClick:k,children:"Cancel"}),e.jsx("button",{className:"flex-1 py-2 rounded-full bg-yellow-400 hover:bg-yellow-500 text-blue-900 font-bold text-sm shadow transition",style:{minWidth:90,maxWidth:120},onClick:v,children:N("confirm_request",c)})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-amber-400 animate-[ripple_1.5s_linear_infinite] pointer-events-none transition-opacity duration-300 group-hover:opacity-80 opacity-60"}),e.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-amber-400/70 animate-[ripple_2s_linear_infinite] pointer-events-none transition-opacity duration-300 group-hover:opacity-60 opacity-40"}),e.jsxs("button",{id:`vapiButton${c==="en"?"En":c==="fr"?"Fr":c==="zh"?"Zh":c==="ru"?"Ru":c==="ko"?"Ko":"Vi"}`,className:"group relative w-36 h-36 sm:w-40 sm:h-40 lg:w-56 lg:h-56 rounded-full font-poppins font-bold flex flex-col items-center justify-center overflow-hidden hover:translate-y-[-2px] hover:shadow-[0px_12px_20px_rgba(0,0,0,0.2)]",onClick:()=>ie(c),style:{background:c==="en"?"linear-gradient(180deg, rgba(85,154,154,0.9) 0%, rgba(85,154,154,0.9) 100%)":c==="fr"?"linear-gradient(180deg, rgba(59, 130, 246, 0.9) 0%, rgba(37, 99, 235, 0.9) 100%)":c==="zh"?"linear-gradient(180deg, rgba(220, 38, 38, 0.9) 0%, rgba(185, 28, 28, 0.9) 100%)":c==="ru"?"linear-gradient(180deg, rgba(79, 70, 229, 0.9) 0%, rgba(67, 56, 202, 0.9) 100%)":"linear-gradient(180deg, rgba(16, 185, 129, 0.9) 0%, rgba(5, 150, 105, 0.9) 100%)",boxShadow:"0px 12px 24px rgba(0, 0, 0, 0.25), 0px 6px 12px rgba(0, 0, 0, 0.15), inset 0px 1px 0px rgba(255, 255, 255, 0.3)",border:"1px solid rgba(255, 255, 255, 0.5)",transition:"all 0.3s ease",transform:"translateY(0) translateZ(30px)"},children:[e.jsx("span",{className:"material-icons text-4xl sm:text-6xl lg:text-7xl mb-2 text-[#F9BF3B] transition-all duration-300 group-hover:scale-110",style:{filter:"drop-shadow(0px 2px 3px rgba(0, 0, 0, 0.2))",color:c==="en"?"#F9BF3B":c==="fr"?"#FFFFFF":c==="zh"?"#FFEB3B":c==="ru"?"#F48FB1":"#4ADE80"},children:"mic"}),e.jsx("span",{className:"text-lg sm:text-2xl lg:text-3xl font-bold whitespace-nowrap text-white",style:{textShadow:"0px 1px 2px rgba(0, 0, 0, 0.2)"},children:N("press_to_call",c)}),e.jsx("span",{className:"absolute w-full h-full rounded-full pointer-events-none"})]})]})}),F&&e.jsx("div",{className:"hidden sm:block flex-shrink-0 text-gray-800",style:{marginLeft:0},children:e.jsx(Ee,{isOpen:F,onClose:()=>y(!1)})})]}),F&&e.jsxs("div",{className:"block sm:hidden w-full flex flex-col items-center gap-2 mb-2 text-gray-800",children:[e.jsx(Me,{isOpen:F,onClose:()=>y(!1)}),e.jsx(Ee,{isOpen:F,onClose:()=>y(!1)})]}),e.jsxs("div",{className:"text-center w-full max-w-5xl mb-10 sm:mb-8",style:{perspective:"1000px"},children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-center gap-3 mb-3 w-full",children:[e.jsxs("div",{className:"p-0.5 py-0 sm:p-2 w-4/5 mx-auto md:w-48 min-h-[38px] h-[45px] sm:min-h-[77px] sm:h-[90px] transition-all duration-250 hover:scale-103 hover:-translate-y-1 flex flex-col justify-between",style:{background:"rgba(85,154,154,0.7)",backdropFilter:"blur(8px)",borderRadius:"12px",boxShadow:"0px 10px 25px rgba(0, 0, 0, 0.15)",border:"1px solid rgba(255, 255, 255, 0.18)",transform:"translateZ(20px)"},children:[e.jsx("h4",{className:"font-medium text-amber-400 pb-0 mb-0.5 text-xs sm:text-sm",style:{borderBottom:"1px solid rgba(255, 255, 255, 0.1)",textShadow:"0px 1px 2px rgba(0, 0, 0, 0.2)"},children:"Local Tourism Info"}),e.jsx("ul",{className:"grid grid-cols-4 gap-0 sm:gap-2 py-0.5 sm:py-2",children:me.map(h=>e.jsx("li",{children:e.jsx(U,{iconName:h.iconName,tooltip:h.tooltip})},h.iconName))})]}),e.jsxs("div",{className:"p-0.5 py-0 sm:p-2 w-4/5 mx-auto md:w-48 min-h-[38px] h-[45px] sm:min-h-[77px] sm:h-[90px] transition-all duration-250 hover:scale-103 hover:-translate-y-1 flex flex-col justify-between",style:{background:"rgba(85,154,154,0.7)",backdropFilter:"blur(8px)",borderRadius:"12px",boxShadow:"0px 10px 25px rgba(0, 0, 0, 0.15)",border:"1px solid rgba(255, 255, 255, 0.18)",transform:"translateZ(20px)"},children:[e.jsx("h4",{className:"font-medium text-amber-400 pb-0 mb-0.5 text-xs sm:text-sm",style:{borderBottom:"1px solid rgba(255, 255, 255, 0.1)",textShadow:"0px 1px 2px rgba(0, 0, 0, 0.2)"},children:"Room Service"}),e.jsx("ul",{className:"grid grid-cols-4 gap-0 sm:gap-2 py-0.5 sm:py-2",children:pe.map(h=>e.jsx("li",{children:e.jsx(U,{iconName:h.iconName,tooltip:h.tooltip})},h.iconName))})]}),e.jsxs("div",{className:"p-0.5 py-0 sm:p-2 w-4/5 mx-auto md:w-48 min-h-[38px] h-[45px] sm:min-h-[77px] sm:h-[90px] transition-all duration-250 hover:scale-103 hover:-translate-y-1 flex flex-col justify-between",style:{background:"rgba(85,154,154,0.7)",backdropFilter:"blur(8px)",borderRadius:"12px",boxShadow:"0px 10px 25px rgba(0, 0, 0, 0.15)",border:"1px solid rgba(255, 255, 255, 0.18)",transform:"translateZ(20px)"},children:[e.jsx("h4",{className:"font-medium text-amber-400 pb-0 mb-0.5 text-xs sm:text-sm",style:{borderBottom:"1px solid rgba(255, 255, 255, 0.1)",textShadow:"0px 1px 2px rgba(0, 0, 0, 0.2)"},children:"Housekeeping"}),e.jsx("ul",{className:"grid grid-cols-4 gap-0 sm:gap-2 py-0.5 sm:py-2",children:ht.map(h=>e.jsx("li",{children:e.jsx(U,{iconName:h.iconName,tooltip:h.tooltip})},h.iconName))})]}),e.jsxs("div",{className:"p-0.5 py-0 sm:p-2 w-4/5 mx-auto md:w-48 min-h-[38px] h-[45px] sm:min-h-[77px] sm:h-[90px] transition-all duration-250 hover:scale-103 hover:-translate-y-1 flex flex-col justify-between",style:{background:"rgba(85,154,154,0.7)",backdropFilter:"blur(8px)",borderRadius:"12px",boxShadow:"0px 10px 25px rgba(0, 0, 0, 0.15)",border:"1px solid rgba(255, 255, 255, 0.18)",transform:"translateZ(20px)"},children:[e.jsx("h4",{className:"font-medium text-amber-400 pb-0 mb-0.5 text-xs sm:text-sm",style:{borderBottom:"1px solid rgba(255, 255, 255, 0.1)",textShadow:"0px 1px 2px rgba(0, 0, 0, 0.2)"},children:"Guest Feedbacks"}),e.jsx("ul",{className:"grid grid-cols-4 gap-0 sm:gap-2 py-0.5 sm:py-2",children:pt.map(h=>e.jsx("li",{children:e.jsx(U,{iconName:h.iconName,tooltip:h.tooltip})},h.iconName))})]}),e.jsxs("div",{className:"p-0.5 py-0 sm:p-2 w-4/5 mx-auto md:w-48 min-h-[38px] h-[45px] sm:min-h-[77px] sm:h-[90px] transition-all duration-250 hover:scale-103 hover:-translate-y-1 flex flex-col justify-between",style:{background:"rgba(85,154,154,0.7)",backdropFilter:"blur(8px)",borderRadius:"12px",boxShadow:"0px 10px 25px rgba(0, 0, 0, 0.15)",border:"1px solid rgba(255, 255, 255, 0.18)",transform:"translateZ(20px)"},children:[e.jsx("h4",{className:"font-medium text-amber-400 pb-0 mb-0.5 text-xs sm:text-sm",style:{borderBottom:"1px solid rgba(255, 255, 255, 0.1)",textShadow:"0px 1px 2px rgba(0, 0, 0, 0.2)"},children:"Local Souvenir"}),e.jsx("ul",{className:"grid grid-cols-4 gap-0 sm:gap-2 py-0.5 sm:py-2",children:xt.map(h=>e.jsx("li",{children:e.jsx(U,{iconName:h.iconName,tooltip:h.tooltip})},h.iconName))})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-center gap-3 mb-3 w-full",children:[e.jsxs("div",{className:"p-0.5 py-0 sm:p-2 w-4/5 mx-auto md:w-64 min-h-[38px] h-[45px] sm:min-h-[77px] sm:h-[90px] transition-all duration-250 hover:scale-103 hover:-translate-y-1 flex flex-col justify-between",style:{background:"rgba(85,154,154,0.7)",backdropFilter:"blur(8px)",borderRadius:"12px",boxShadow:"0px 10px 25px rgba(0, 0, 0, 0.15)",border:"1px solid rgba(255, 255, 255, 0.18)",transform:"translateZ(20px)"},children:[e.jsx("h4",{className:"font-medium text-amber-400 pb-0 mb-0.5 text-xs sm:text-sm",style:{borderBottom:"1px solid rgba(255, 255, 255, 0.1)",textShadow:"0px 1px 2px rgba(0, 0, 0, 0.2)"},children:"Tours"}),e.jsx("ul",{className:"grid grid-cols-4 gap-0 sm:gap-2 py-0.5 sm:py-2",children:P.map(h=>e.jsx("li",{children:e.jsx(U,{iconName:h.iconName,tooltip:h.tooltip})},h.iconName))})]}),e.jsxs("div",{className:"p-0.5 py-0 sm:p-2 w-4/5 mx-auto md:w-[560px] min-h-[38px] h-[45px] sm:min-h-[77px] sm:h-[90px] transition-all duration-250 hover:scale-103 hover:-translate-y-1 flex flex-col justify-between",style:{background:"rgba(85,154,154,0.7)",backdropFilter:"blur(8px)",borderRadius:"12px",boxShadow:"0px 10px 25px rgba(0, 0, 0, 0.15)",border:"1px solid rgba(255, 255, 255, 0.18)",transform:"translateZ(20px)"},children:[e.jsx("h4",{className:"font-medium text-amber-400 pb-0 mb-0.5 text-xs sm:text-sm",style:{borderBottom:"1px solid rgba(255, 255, 255, 0.1)",textShadow:"0px 1px 2px rgba(0, 0, 0, 0.2)"},children:"Bus Tickets"}),e.jsx("ul",{className:"flex flex-row flex-nowrap gap-4 py-0.5 sm:py-2 justify-center items-center",children:B.map(h=>e.jsx("li",{children:e.jsx(U,{iconName:h.iconName,tooltip:h.tooltip})},h.iconName))})]}),e.jsxs("div",{className:"p-0.5 py-0 sm:p-2 w-4/5 mx-auto md:w-64 min-h-[38px] h-[45px] sm:min-h-[77px] sm:h-[90px] transition-all duration-250 hover:scale-103 hover:-translate-y-1 flex flex-col justify-between",style:{background:"rgba(85,154,154,0.7)",backdropFilter:"blur(8px)",borderRadius:"12px",boxShadow:"0px 10px 25px rgba(0, 0, 0, 0.15)",border:"1px solid rgba(255, 255, 255, 0.18)",transform:"translateZ(20px)"},children:[e.jsx("h4",{className:"font-medium text-amber-400 pb-0 mb-0.5 text-xs sm:text-sm",style:{borderBottom:"1px solid rgba(255, 255, 255, 0.1)",textShadow:"0px 1px 2px rgba(0, 0, 0, 0.2)"},children:"Vehicle Rental"}),e.jsx("ul",{className:"grid grid-cols-3 gap-0 sm:gap-2 py-0.5 sm:py-2",children:se.map(h=>e.jsx("li",{children:e.jsx(U,{iconName:h.iconName,tooltip:h.tooltip})},h.iconName))})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-center gap-3 w-full mb-8",children:[e.jsxs("div",{className:"p-0.5 py-0 sm:p-2 w-4/5 mx-auto md:w-64 mb-2 sm:mb-0 min-h-[38px] h-[45px] sm:min-h-[77px] sm:h-[90px] transition-all duration-250 hover:scale-103 hover:-translate-y-1 flex flex-col justify-between",style:{background:"rgba(85,154,154,0.7)",backdropFilter:"blur(8px)",borderRadius:"12px",boxShadow:"0px 10px 25px rgba(0, 0, 0, 0.15)",border:"1px solid rgba(255, 255, 255, 0.18)",transform:"translateZ(20px)"},children:[e.jsx("h4",{className:"font-medium text-amber-400 pb-0 mb-0.5 text-xs sm:text-sm",style:{borderBottom:"1px solid rgba(255, 255, 255, 0.1)",textShadow:"0px 1px 2px rgba(0, 0, 0, 0.2)"},children:"Currency Exchange"}),e.jsx("ul",{className:"grid grid-cols-5 gap-0 sm:gap-2 py-0.5 sm:py-2",children:z.map(h=>e.jsx("li",{children:e.jsx(U,{iconName:h.iconName,tooltip:h.tooltip})},h.iconName))})]}),e.jsxs("div",{className:"p-0.5 py-0 sm:p-2 w-4/5 mx-auto md:w-64 mb-2 sm:mb-0 min-h-[38px] h-[45px] sm:min-h-[77px] sm:h-[90px] transition-all duration-250 hover:scale-103 hover:-translate-y-1 flex flex-col justify-between",style:{background:"rgba(85,154,154,0.7)",backdropFilter:"blur(8px)",borderRadius:"12px",boxShadow:"0px 10px 25px rgba(0, 0, 0, 0.15)",border:"1px solid rgba(255, 255, 255, 0.18)",transform:"translateZ(20px)"},children:[e.jsx("h4",{className:"font-medium text-amber-400 pb-0 mb-0.5 text-xs sm:text-sm",style:{borderBottom:"1px solid rgba(255, 255, 255, 0.1)",textShadow:"0px 1px 2px rgba(0, 0, 0, 0.2)"},children:"Laundry Service"}),e.jsx("ul",{className:"grid grid-cols-5 gap-0 sm:gap-2 py-0.5 sm:py-2",children:R.map(h=>e.jsx("li",{children:e.jsx(U,{iconName:h.iconName,tooltip:h.tooltip})},h.iconName))})]}),e.jsxs("div",{className:"p-0.5 py-0 sm:p-2 w-4/5 mx-auto md:w-64 mb-4 sm:mb-0 min-h-[38px] h-[45px] sm:min-h-[77px] sm:h-[90px] transition-all duration-250 hover:scale-103 hover:-translate-y-1 flex flex-col justify-between",style:{background:"rgba(85,154,154,0.7)",backdropFilter:"blur(8px)",borderRadius:"12px",boxShadow:"0px 10px 25px rgba(0,0,0,0.15)",border:"1px solid rgba(255,255,255,0.18)",transform:"translateZ(20px)"},children:[e.jsx("h4",{className:"font-medium text-amber-400 pb-0 mb-0.5 text-xs sm:text-sm",style:{borderBottom:"1px solid rgba(255, 255, 255, 0.1)",textShadow:"0px 1px 2px rgba(0, 0, 0, 0.2)"},children:"HomeStay"}),e.jsx("ul",{className:"grid grid-cols-5 gap-0 sm:gap-2 py-0.5 sm:py-2",children:ne.map(h=>e.jsx("li",{children:e.jsx(U,{iconName:h.iconName,tooltip:h.tooltip})},h.iconName))})]})]})]}),q&&i&&i.length>0&&e.jsx("div",{className:"flex flex-col items-center gap-y-4 mb-20 pb-16 w-full px-2 sm:mb-12 sm:pb-8 sm:flex-row sm:flex-nowrap sm:gap-x-4 sm:overflow-x-auto sm:justify-start mt-4",children:[...i].sort((h,H)=>H.requestedAt.getTime()-h.requestedAt.getTime()).map(h=>{const H=new Date(h.requestedAt.getTime()+36e5),J=Math.max(Math.ceil((H.getTime()-M.getTime())/1e3),0);if(J<=0)return null;const xe=Math.floor(J/60).toString().padStart(2,"0"),gt=(J%60).toString().padStart(2,"0");return e.jsxs("div",{className:"p-2 sm:p-3 text-gray-800 max-w-xs w-[220px] flex-shrink-0 transition-all duration-250 hover:rotate-1 hover:scale-105",style:{background:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(8px)",borderRadius:"24px",boxShadow:"0px 10px 25px rgba(0, 0, 0, 0.15)",border:"1px solid rgba(255, 255, 255, 0.4)",transform:"translateZ(20px)",transformStyle:"preserve-3d",zIndex:20,marginBottom:"8px",transition:"all 0.3s ease-in-out"},children:[e.jsx("div",{className:"flex justify-center items-center mb-1.5",children:e.jsx("span",{className:"font-bold text-lg text-blue-800 bg-blue-50 px-4 py-1.5 rounded-full shadow-sm",style:{borderRadius:"16px",boxShadow:"0px 2px 6px rgba(0, 0, 0, 0.1)"},children:`${xe}:${gt}`})}),e.jsxs("p",{className:"text-xs sm:text-sm mb-0.5 px-1.5",children:[e.jsxs("strong",{children:[N("order_ref",c),":"]})," ",h.reference]}),e.jsxs("p",{className:"text-xs sm:text-sm mb-0.5 px-1.5",children:[e.jsxs("strong",{children:[N("requested_at",c),":"]})," ",h.requestedAt.toLocaleString("en-US",{timeZone:"Asia/Ho_Chi_Minh",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})]}),e.jsxs("p",{className:"text-xs sm:text-sm mb-0.5 px-1.5",children:[e.jsxs("strong",{children:[N("estimated_completion",c),":"]})," ",h.estimatedTime]}),e.jsx("div",{className:"mt-2 flex justify-center",children:(()=>{const _e=de(h.status);return console.log("Order status:",h.status,"->",ae(h.status)),e.jsxs("span",{className:`flex items-center gap-1 px-2 py-1 text-xs font-semibold ${_e.bg} ${_e.text} w-full text-center shadow-md border border-white/60`,style:{borderRadius:"16px",boxShadow:"0px 1px 4px rgba(0, 0, 0, 0.12)",transition:"all 0.2s ease",letterSpacing:.2},children:[e.jsx("span",{className:"material-icons text-base mr-1",style:{marginTop:-2},children:_e.icon}),N(ae(h.status),c)]})})()})]},h.reference)})})]}),A&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/30 backdrop-blur-sm",children:e.jsx("div",{className:"relative bg-white/90 rounded-2xl shadow-xl p-6 sm:p-8 max-w-md w-full mx-4",children:e.jsxs("div",{className:"flex flex-col items-center justify-center space-y-4",children:[e.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsx("span",{className:"material-icons text-blue-600 text-3xl sm:text-4xl animate-spin",children:"sync"})}),e.jsx("h3",{className:"text-xl sm:text-2xl font-bold text-blue-900 text-center",children:N("generating_your_summary",c)})]})})}),f&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-start sm:items-center justify-center bg-black/30 backdrop-blur-sm",children:e.jsxs("div",{className:"relative w-full h-full flex items-start sm:items-center justify-center",children:[e.jsx("button",{className:"absolute top-2 right-2 z-10 p-2 bg-white/80 rounded-full shadow hover:bg-white",onClick:()=>b(!1),title:"Đóng summary",children:e.jsx("span",{className:"material-icons text-gray-600",children:"close"})}),e.jsx("div",{className:"w-full max-w-4xl flex justify-center pt-50 sm:pt-0",children:e.jsx("div",{className:"w-full max-h-screen overflow-y-auto",children:e.jsx(ct,{isActive:!0})})})]})})]})},Pe=["Landmark","Hotel Amenities","Local Cuisine","Area Map","Activity and Experiences","Tours","Transportation","Dining"],hu=({references:n})=>{const[t,s]=r.useState({}),[o,a]=r.useState(!0),[m,l]=r.useState(Pe[0]),[i,c]=r.useState(null);r.useEffect(()=>{a(!0);let d=0;if(n.length===0){a(!1);return}n.forEach(j=>{j.type==="document"&&j.url.endsWith(".txt")&&!t[j.url]?fetch(j.url).then(I=>I.text()).then(I=>{s(Y=>({...Y,[j.url]:I})),d++,d===n.length&&a(!1)}).catch(()=>{d++,d===n.length&&a(!1)}):(d++,d===n.length&&a(!1))}),n.every(j=>j.type!=="document"||!j.url.endsWith(".txt"))&&a(!1)},[n]);const _=d=>/^https?:\/\//.test(d)?d:`/${d.replace(/^\//,"")}`,x=async(d,j)=>{try{const Y=await(await fetch(_(d))).blob(),q=URL.createObjectURL(Y),L=document.createElement("a");L.href=q,L.download=j,document.body.appendChild(L),L.click(),document.body.removeChild(L),URL.revokeObjectURL(q)}catch(I){console.error("Error downloading file:",I)}},S=d=>{window.open(_(d),"_blank")},D=()=>e.jsxs("div",{className:"animate-pulse bg-white/80 rounded-xl shadow-md h-[180px] flex flex-col p-4 gap-2",children:[e.jsx("div",{className:"bg-gray-200 rounded w-full h-2/3 mb-2"}),e.jsx("div",{className:"bg-gray-200 rounded w-2/3 h-4 mb-1"}),e.jsx("div",{className:"bg-gray-100 rounded w-1/2 h-3"})]}),w=d=>e.jsxs("div",{className:"group bg-white/90 rounded-xl shadow-md h-[180px] flex flex-col justify-between cursor-pointer transition-transform duration-200 hover:scale-[1.03] active:scale-95 border border-white/40 backdrop-blur-md",style:{minWidth:220,maxWidth:260},onClick:()=>d.type==="link"?S(d.url):void 0,children:[e.jsxs("div",{className:"flex-1 flex items-center justify-center overflow-hidden rounded-t-xl",style:{height:"60%"},children:[d.type==="image"&&e.jsx("img",{src:_(d.url),alt:d.title,className:"object-cover w-full h-full rounded-t-xl hover:opacity-80 transition cursor-zoom-in",onClick:j=>{j.stopPropagation(),c(_(d.url))},tabIndex:0,onKeyDown:j=>{(j.key==="Enter"||j.key===" ")&&c(_(d.url))}}),d.type==="document"&&d.url.endsWith(".pdf")&&e.jsx("span",{className:"material-icons text-5xl text-blue-700/80",children:"picture_as_pdf"}),d.type==="document"&&d.url.endsWith(".txt")&&e.jsx("span",{className:"material-icons text-5xl text-green-700/80",children:"description"}),d.type==="link"&&e.jsx("span",{className:"material-icons text-5xl text-yellow-700/80",children:"link"})]}),e.jsxs("div",{className:"flex flex-col gap-1 px-3 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-base font-medium text-gray-900 truncate",children:d.title}),d.type==="document"&&e.jsx("button",{onClick:j=>{j.stopPropagation(),x(d.url,d.title)},className:"ml-auto p-1 rounded-full hover:bg-yellow-100 text-yellow-700 transition-colors",children:e.jsx("span",{className:"material-icons text-base",children:"download"})}),d.type==="link"&&e.jsx("span",{className:"material-icons text-xs text-gray-400 ml-1",children:"open_in_new"})]}),d.description&&e.jsx("span",{className:"text-xs text-gray-500 truncate",children:d.description}),d.url.endsWith(".txt")&&t[d.url]&&e.jsxs("pre",{className:"mt-1 max-h-12 overflow-auto whitespace-pre-wrap text-xs text-gray-700 bg-gray-50 rounded p-1",children:[t[d.url].slice(0,120),"..."]})]})]}),g=()=>window.innerWidth<640?"auto":window.innerWidth<1024?2:window.innerWidth<1280?3:4,T=n.filter(d=>d.category&&d.category.trim().toLowerCase()===m.trim().toLowerCase());return e.jsxs("div",{className:"w-full sm:max-w-5xl mx-auto mt-2 mb-2 px-2 py-3 rounded-2xl",style:{background:"rgba(85,154,154,0.85)",minHeight:260},children:[i&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm",onClick:()=>c(null),children:e.jsxs("div",{className:"relative max-w-3xl w-full flex flex-col items-center",children:[e.jsx("button",{className:"absolute top-2 right-2 bg-white/80 hover:bg-white text-gray-800 rounded-full p-2 shadow-lg z-10",onClick:d=>{d.stopPropagation(),c(null)},children:e.jsx("span",{className:"material-icons text-2xl",children:"close"})}),e.jsx("img",{src:i,alt:"Phóng to ảnh reference",className:"rounded-xl max-h-[80vh] w-auto object-contain border-4 border-white shadow-2xl",onClick:d=>d.stopPropagation()})]})}),e.jsx("div",{className:"flex items-center mb-4 px-2",children:e.jsxs("div",{className:"flex items-center px-3 py-2 sm:py-1.5 gap-2 transition-all duration-300 mx-auto sm:mx-0",style:{background:"linear-gradient(135deg, #79DBDC 0%, #559A9A 100%)",boxShadow:"0px 4px 8px rgba(0, 0, 0, 0.15)",borderRadius:"8px",minWidth:"150px",maxWidth:"95%",width:"auto",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx(Dt,{className:"text-[#F9BF3B] text-xl mr-1.5",style:{filter:"drop-shadow(0px 2px 3px rgba(0, 0, 0, 0.2))"}}),e.jsx("label",{className:"mr-2 font-semibold font-sans text-white whitespace-nowrap text-sm sm:text-base",children:"Category:"}),e.jsxs("div",{className:"relative flex-1",children:[e.jsx("select",{value:m,onChange:d=>l(d.target.value),className:"appearance-none w-full pl-6 sm:pl-8 pr-6 py-1 sm:py-1.5 font-sans bg-transparent focus:outline-none transition-all duration-200",style:{fontWeight:600,color:"#fff",textShadow:"0px 1px 2px rgba(0, 0, 0, 0.2)",borderRadius:"8px"},children:Pe.map(d=>e.jsx("option",{value:d,className:"bg-blue-800 text-white",children:d},d))}),e.jsx(Xe,{className:"absolute right-2 top-1/2 -translate-y-1/2 text-[#F9BF3B] pointer-events-none text-lg"})]})]})}),o?e.jsx("div",{className:"flex gap-4 overflow-x-auto pb-2",children:[...Array(3)].map((d,j)=>e.jsx(D,{},j))}):T.length===0?e.jsx("div",{className:"flex items-center justify-center h-[120px] text-white/80 text-base font-medium",children:"No references available"}):e.jsx(kt,{modules:[Ct,Tt,It],spaceBetween:16,slidesPerView:g(),navigation:T.length>3,pagination:{clickable:!0,dynamicBullets:!0},className:"w-full",style:{paddingBottom:32,overflowX:window.innerWidth<640?"auto":void 0},children:T.map((d,j)=>e.jsx(At,{className:"flex justify-center",style:window.innerWidth<640?{width:"90vw",maxWidth:"98vw",minWidth:0}:{},children:w(d)},d.url+j))})]})};class pu{constructor(){this.referenceMap={}}async initialize(){try{const t=await fetch("/assets/references/reference-map.json");this.referenceMap=await t.json(),console.log("Loaded referenceMap:",this.referenceMap)}catch(t){console.error("Error loading reference map:",t)}}findReferences(t){const s=t.toLowerCase(),o=[];return Object.values(this.referenceMap).forEach(a=>{a.keywords.some(l=>s.includes(l.toLowerCase()))&&!o.find(l=>l.url===a.url)&&o.push(a)}),o}async addReference(t,s){this.referenceMap[t]=s;try{await fetch("/api/references",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...s,id:t})})}catch(o){console.error("Error saving reference:",o)}}}const Fe=new pu,xu=({isActive:n})=>{const{transcripts:t,callDetails:s,callDuration:o,endCall:a,isMuted:m,toggleMute:l,setCurrentInterface:i,micLevel:c,modelOutput:_,language:x}=te(),[S,D]=r.useState({}),w=r.useRef({}),[g,T]=r.useState([]),[d,j]=r.useState([]),[I,Y]=r.useState(0),q=r.useRef(null),[L,C]=r.useState(!0),p=()=>{Object.values(w.current).forEach(y=>{cancelAnimationFrame(y)}),w.current={}};r.useEffect(()=>{async function y(){await Fe.initialize();const f=Object.values(Fe.referenceMap||{});console.log("All references loaded:",f),j(f)}y()},[]),r.useEffect(()=>{const y=[...t].sort((A,W)=>A.timestamp.getTime()-W.timestamp.getTime()),f=[];let b=null;y.forEach(A=>{A.role==="user"?(b={id:A.id.toString(),role:"user",timestamp:A.timestamp,messages:[{id:A.id.toString(),content:A.content,timestamp:A.timestamp}]},f.push(b)):((!b||b.role==="user")&&(b={id:A.id.toString(),role:"assistant",timestamp:A.timestamp,messages:[]},f.push(b)),b.messages.push({id:A.id.toString(),content:A.content,timestamp:A.timestamp}))}),T(f)},[t]),r.useEffect(()=>(g.filter(f=>f.role==="assistant").flatMap(f=>f.messages).forEach(f=>{if(S[f.id]===f.content.length)return;let b=S[f.id]||0;const A=f.content,W=()=>{b<A.length?(D(V=>({...V,[f.id]:b+1})),b++,w.current[f.id]=requestAnimationFrame(W)):delete w.current[f.id]};w.current[f.id]=requestAnimationFrame(W)}),()=>p()),[g]);const $=r.useCallback(()=>{const y=o>0?o:I;console.log("Canceling call with duration:",y),a(),i("interface1")},[o,I,a,i]),E=r.useCallback(()=>{if(!t||t.length===0){alert(N("need_conversation",x));return}const y=o>0?o:I;console.log("Ending call with duration:",y),a(),i(x==="fr"?"interface3fr":x==="vi"?"interface3vi":"interface3")},[o,I,a,i,t,x]),F=y=>{const f=Math.floor(y/60).toString().padStart(2,"0"),b=(y%60).toString().padStart(2,"0");return`${f}:${b}`};return r.useEffect(()=>{let y=null;return n&&(console.log("Interface2 is active, starting local timer"),Y(o||0),y=setInterval(()=>{Y(f=>f+1)},1e3)),()=>{y&&(console.log("Cleaning up local timer in Interface2"),clearInterval(y))}},[n,o]),r.useEffect(()=>{q.current&&n&&(q.current.scrollTop=0)},[g,n]),e.jsx("div",{className:`absolute w-full min-h-screen h-full transition-opacity duration-500 ${n?"opacity-100":"opacity-0 pointer-events-none"} z-20 overflow-y-auto`,id:"interface2",style:{backgroundImage:"linear-gradient(rgba(85,154,154,0.7), rgba(121, 219, 220, 0.6)), url('/assets/courtyard.jpeg')",backgroundSize:"cover",backgroundPosition:"center"},children:e.jsxs("div",{className:"container mx-auto flex flex-col md:flex-row p-2 h-full gap-2",children:[e.jsxs("div",{className:"w-full md:w-3/4 lg:w-2/3 flex flex-col items-center space-y-1 sm:space-y-4 mt-1 min-h-0 overflow-y-auto",children:[e.jsxs("div",{className:"relative flex flex-col items-center justify-center mb-1 sm:mb-6 w-full max-w-xs mx-auto",children:[e.jsx(at,{containerId:"siri-button",isListening:!m,volumeLevel:c}),e.jsxs("div",{className:"flex items-center justify-center mt-2 w-full gap-2 sm:gap-3",children:[e.jsx("button",{className:"flex items-center justify-center transition-colors",title:N(m?"unmute":"mute",x),onClick:l,style:{fontSize:22,padding:0,background:"none",border:"none",color:"#d4af37",width:28,height:28},onMouseOver:y=>y.currentTarget.style.color="#ffd700",onMouseOut:y=>y.currentTarget.style.color="#d4af37",children:e.jsx("span",{className:"material-icons",children:m?"mic_off":"mic"})}),e.jsxs("button",{id:"cancelButton",onClick:$,className:"flex items-center justify-center px-3 py-2 bg-white/80 hover:bg-blue-100 text-blue-900 rounded-full text-xs font-semibold border-2 border-blue-200 shadow transition-colors sm:hidden active:scale-95 active:bg-blue-100",style:{fontFamily:"inherit",letterSpacing:.2,minHeight:44,minWidth:90,fontSize:14,touchAction:"manipulation",zIndex:10},children:[e.jsx("span",{className:"material-icons text-base mr-1",children:"cancel"}),N("cancel",x)]}),e.jsx("div",{className:"flex-1 flex justify-center",children:e.jsx("div",{className:"text-white text-xs sm:text-sm bg-blue-900/80 rounded-full px-3 sm:px-4 py-1 shadow-lg border border-white/30 flex items-center justify-center",style:{backdropFilter:"blur(2px)"},children:F(I)})}),e.jsxs(le,{id:"confirmButton",onClick:E,variant:"yellow",className:"flex items-center justify-center sm:hidden text-xs font-bold",style:{minHeight:44,minWidth:120,fontSize:14,zIndex:10},children:[e.jsx("span",{className:"material-icons text-lg mr-2",children:"send"}),N("confirm",x)]}),e.jsxs("button",{className:"flex items-center justify-center transition-colors",title:"Mic Level",style:{fontSize:22,padding:0,background:"none",border:"none",color:"#d4af37",width:28,height:28},tabIndex:-1,disabled:!0,onMouseOver:y=>y.currentTarget.style.color="#ffd700",onMouseOut:y=>y.currentTarget.style.color="#d4af37",children:[e.jsx("span",{className:"material-icons",children:"graphic_eq"}),e.jsx("span",{className:"ml-1 flex items-end h-4 w-6",children:[...Array(4)].map((y,f)=>e.jsx("span",{style:{display:"inline-block",width:2,height:`${4+Math.round(c/100*12)*(f%2+1)}px`,background:"#d4af37",marginLeft:1,borderRadius:1}},f))})]})]})]}),L&&e.jsxs("div",{id:"realTimeConversation",ref:q,className:"w-full flex flex-col-reverse gap-1 pr-2 relative max-w-full sm:max-w-2xl mx-auto min-h-[60px] max-h-[12vh] overflow-y-auto mb-1",style:{background:"rgba(255,255,255,0.88)",borderRadius:12,border:"1px solid rgba(255,255,255,0.35)",boxShadow:"0px 4px 10px rgba(0,0,0,0.15)",padding:"8px",transition:"box-shadow 0.3s, background 0.3s",fontFamily:"SF Pro Text, Roboto, Open Sans, Arial, sans-serif",fontSize:window.innerWidth<640?14:16,lineHeight:1.5,color:"#222",fontWeight:400,backdropFilter:"blur(2px)",display:"flex",flexDirection:"column",justifyContent:"flex-end"},children:[e.jsx("button",{className:"absolute top-1.5 right-1.5 w-5 h-5 flex items-center justify-center rounded-full bg-white/40 hover:bg-white/70 text-gray-400 hover:text-gray-700 shadow z-10 opacity-60 hover:opacity-90 transition-all",style:{fontSize:14,display:"block"},title:"Ẩn realtime conversation",onClick:()=>C(!1),children:e.jsx("span",{className:"material-icons",style:{fontSize:16},children:"close"})}),e.jsxs("div",{className:"w-full flex flex-col gap-1 pr-2",style:{overflowY:"auto",maxHeight:"28vh"},children:[g.length===0&&e.jsx("div",{className:"text-gray-400 text-base text-center select-none",style:{opacity:.7},children:N("tap_to_speak",x)}),[...g].reverse().map((y,f)=>e.jsx("div",{className:"mb-1",children:e.jsx("div",{className:"flex items-start",children:e.jsx("div",{className:"flex-grow",children:y.role==="user"?e.jsx("p",{className:"text-base md:text-lg font-medium text-gray-900",style:{marginBottom:2},children:y.messages[0].content}):e.jsxs("p",{className:"text-base md:text-lg font-medium",style:{marginBottom:2,position:"relative",background:"linear-gradient(90deg, #FF512F, #F09819, #FFD700, #56ab2f, #43cea2, #1e90ff, #6a11cb, #FF512F)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",fontWeight:600,letterSpacing:.2,transition:"background 0.5s"},children:[e.jsx("span",{className:"inline-flex flex-wrap",children:y.messages.map((b,A)=>{const W=b.content.slice(0,S[b.id]||0);return e.jsxs("span",{style:{whiteSpace:"pre"},children:[W,A===y.messages.length-1&&f===0&&S[b.id]<b.content.length&&e.jsx("span",{className:"animate-blink text-yellow-500",style:{marginLeft:1},children:"|"})]},b.id)})}),f===0&&y.role==="assistant"&&S[y.messages[y.messages.length-1].id]===y.messages[y.messages.length-1].content.length&&e.jsx("span",{className:"ml-2 animate-ellipsis text-yellow-500",children:"..."})]})})})},y.id))]})]}),e.jsx("div",{className:"w-full mt-1",children:e.jsx("div",{className:"w-full flex flex-row items-center gap-x-2 mb-3 px-2",children:e.jsx(hu,{references:d})})})]}),e.jsx("div",{className:"w-1/4 lg:w-1/3 flex-col items-center lg:items-end p-2 space-y-4 overflow-auto hidden sm:flex",style:{maxHeight:"100%"},children:e.jsxs("div",{className:"flex flex-col gap-4 w-full md:w-auto",children:[e.jsxs(le,{id:"endCallButton",onClick:E,variant:"yellow",className:"w-full md:w-auto flex items-center justify-center space-x-2 text-base sm:text-lg",style:{minHeight:56,minWidth:220,zIndex:10},children:[e.jsx("span",{className:"material-icons",children:"send"}),e.jsx("span",{className:"whitespace-nowrap",children:N("confirm_request",x)})]}),e.jsxs("button",{id:"cancelButtonDesktop",onClick:$,className:"w-full md:w-auto bg-white hover:bg-blue-100 text-blue-900 font-semibold py-3 px-8 rounded-full shadow flex items-center justify-center space-x-2 transition-all duration-200 border-2 border-blue-200 text-base sm:text-lg active:scale-95 active:bg-blue-100",style:{fontFamily:"inherit",letterSpacing:.2,minHeight:56,minWidth:120,touchAction:"manipulation",zIndex:10},children:[e.jsx("span",{className:"material-icons text-lg mr-2",children:"cancel"}),N("cancel",x)]})]})})]})})},gu=({isActive:n})=>{const{callSummary:t,orderSummary:s,setCurrentInterface:o,setOrderSummary:a,setOrder:m,serviceRequests:l,vietnameseSummary:i,setVietnameseSummary:c,translateToVietnamese:_,emailSentForCurrentSession:x,setEmailSentForCurrentSession:S,callDetails:D,callDuration:w,language:g}=te(),[T,d]=r.useState(!1),j=(C,p)=>{s&&a({...s,[C]:p})},[I,Y]=r.useState(null);r.useEffect(()=>{const C=t?new Date(t.timestamp).getTime().toString():null;n&&t&&(!i||I!==C)&&C!==I&&(Y(C),(async()=>{try{console.log("Starting translation of summary to Vietnamese"),d(!0),await _(t.content),d(!1)}catch($){console.error("Error translating summary:",$),d(!1)}})())},[n,t,i,_,I]),r.useEffect(()=>{var C,p;if(n&&l&&l.length>0&&s){const $=l.map((b,A)=>{let W=1,V=10;b.serviceType==="housekeeping"&&(V=5),b.serviceType==="technical-support"&&(V=0),(b.serviceType.includes("food")||b.serviceType==="room-service")&&(V=8),b.serviceType==="wake-up"&&(V=0);let O="";const M=b.details;return M.roomNumber&&M.roomNumber!=="unknown"&&M.roomNumber!=="Not specified"&&(O+=`Số phòng: ${M.roomNumber}
`),M.date&&M.date!=="Not specified"&&(O+=`Ngày: ${M.date}
`),M.time&&M.time!=="Not specified"&&(O+=`Thời gian: ${M.time}
`),M.people&&(O+=`Số người: ${M.people}
`),M.location&&M.location!=="Not specified"&&(O+=`Địa điểm: ${M.location}
`),M.amount&&M.amount!=="Not specified"&&(O+=`Số tiền: ${M.amount}
`),O+=`
Yêu cầu: ${b.requestText}`,M.otherDetails&&M.otherDetails!=="Not specified"&&M.otherDetails!=="None"&&!M.otherDetails.includes("Not specified")&&(O+=`

Thông tin thêm: ${M.otherDetails}`),{id:(A+1).toString(),name:b.requestText.length>60?b.requestText.substring(0,57)+"...":b.requestText,description:O,quantity:W,price:V,serviceType:b.serviceType}}),F=Array.from(new Set(l.map(b=>b.serviceType))).join(",");let y=s.deliveryTime;l.some(b=>b.details&&b.details.time&&typeof b.details.time=="string"&&b.details.time.toLowerCase().includes("immediate"))&&(y="asap");const f=(p=(C=l.find(b=>b.details&&b.details.roomNumber&&b.details.roomNumber!=="unknown"&&b.details.roomNumber!=="Not specified"))==null?void 0:C.details)==null?void 0:p.roomNumber;a({...s,items:$,totalAmount:$.reduce((b,A)=>b+A.price*A.quantity,0),orderType:F,roomNumber:f||s.roomNumber,deliveryTime:y})}},[l,n,s,a]);function q(C){return C.split(`
`).filter(p=>!/^Bước tiếp theo:/i.test(p)&&!/^Next Step:/i.test(p)&&!/Vui lòng nhấn/i.test(p)&&!/Please Press Send To Reception/i.test(p)).map(p=>p.replace(/\(dùng cho khách có đặt chỗ xác nhận\)/i,"").replace(/\(used for Guest with a confirmed reservation\)/i,"").replace(/\(không được chỉ định\)/i,"").replace(/\(not specified\)/i,"")).join(`
`).replace(/\n{3,}/g,`

`)}const L=async()=>{if(!s)return;const C=i||(t?t.content:"Không có tóm tắt"),p=q(C),$=`#ORD-${Math.floor(1e4+Math.random()*9e4)}`;if(m({reference:$,estimatedTime:"15-20 phút",summary:s}),x){console.log("Email đã được gửi cho phiên này. Bỏ qua việc gửi email trùng lặp."),o("interface4");return}try{console.log("Gửi email với tóm tắt cuộc gọi và yêu cầu dịch vụ từ giao diện tiếng Việt...");const E=w?`${Math.floor(w/60)}:${(w%60).toString().padStart(2,"0")}`:"0:00",F=`call-${Date.now()}`,y=(D==null?void 0:D.id)||F;console.log("Sử dụng callId cho email:",y),console.log("Nội dung tóm tắt cuộc gọi:",p),console.log("Chuẩn bị payload email...");const f={toEmail:"tuans2@gmail.com",callDetails:{callId:y,roomNumber:s.roomNumber||"Cần xác nhận",summary:p,timestamp:t?t.timestamp:new Date,duration:E,serviceRequests:s.items.map(b=>b.name),orderReference:$}};console.log("Payload email đã chuẩn bị:",JSON.stringify(f)),setTimeout(async()=>{try{console.log("Gửi yêu cầu email đến máy chủ...");const b=await fetch("/api/send-call-summary-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(f),cache:"no-cache",credentials:"same-origin"});if(!b.ok)throw new Error(`Máy chủ phản hồi với trạng thái: ${b.status}`);const A=await b.json();console.log("Email đã được gửi với xác nhận đơn hàng:",A),S(!0)}catch(b){console.error("Không thể gửi email trong timeout:",b)}},500)}catch(E){console.error("Không thể gửi email:",E)}o("interface4")};return s?e.jsx("div",{className:`absolute w-full min-h-screen h-full transition-opacity duration-500 ${n?"opacity-100 active":"opacity-0 pointer-events-none"} z-30 overflow-y-auto`,id:"interface3vi","data-interface":"interface3vi","data-active":n.toString(),style:{backgroundImage:"linear-gradient(rgba(85,154,154,0.7), rgba(121, 219, 220, 0.6))",backgroundSize:"cover",backgroundPosition:"center",fontFamily:"SF Pro Text, Roboto, Open Sans, Arial, sans-serif"},children:e.jsx("div",{className:"container mx-auto h-full flex flex-col p-2 sm:p-4 md:p-8",children:e.jsxs("div",{className:"mx-auto w-full max-w-3xl bg-white/90 rounded-2xl shadow-xl p-3 sm:p-6 md:p-10 mb-4 sm:mb-6 flex-grow border border-white/40 backdrop-blur-md",style:{minHeight:420},children:[e.jsx("div",{className:"mb-3 sm:mb-4 pb-2 sm:pb-3 border-b border-gray-200",children:e.jsx("p",{className:"font-poppins font-bold text-xl sm:text-2xl text-blue-900 tracking-wide",children:"XEM XÉT & XÁC NHẬN"})}),e.jsx("div",{id:"summary-container",className:"mb-3 sm:mb-4",children:t?e.jsxs("div",{className:"p-3 sm:p-5 bg-white/80 rounded-xl shadow border border-white/30 mb-3 sm:mb-4 relative",style:{backdropFilter:"blur(2px)"},children:[e.jsx("h3",{className:"font-semibold text-base sm:text-lg mb-1 sm:mb-2 text-blue-800",children:"Tóm tắt cuộc trò chuyện"}),T?e.jsxs("div",{className:"animate-pulse space-y-2",children:[e.jsx("div",{className:"h-2 bg-blue-100 rounded w-3/4"}),e.jsx("div",{className:"h-2 bg-blue-100 rounded w-full"}),e.jsx("div",{className:"h-2 bg-blue-100 rounded w-5/6"}),e.jsx("div",{className:"h-2 bg-blue-100 rounded w-2/3"}),e.jsx("p",{className:"text-blue-400 text-xs sm:text-sm italic",children:"Đang dịch sang tiếng Việt..."})]}):e.jsx("p",{className:"text-xs sm:text-base leading-relaxed text-gray-800 whitespace-pre-line",style:{fontWeight:400},children:i||t.content}),e.jsx("div",{className:"mt-2 sm:mt-3 flex justify-end",children:e.jsxs("div",{className:"text-xs text-gray-500",children:["Tạo lúc ",new Date(t.timestamp).toLocaleTimeString()]})})]}):e.jsxs("div",{className:"p-3 sm:p-5 bg-gray-50 rounded-xl shadow border border-dashed border-gray-300 mb-3 sm:mb-4",children:[e.jsxs("div",{className:"animate-pulse flex space-x-2 items-center",children:[e.jsx("div",{className:"h-4 w-4 bg-gray-300 rounded-full"}),e.jsx("div",{className:"h-4 bg-gray-300 rounded w-1/4"})]}),e.jsx("h3",{className:"font-semibold text-base sm:text-lg my-2 text-gray-600",children:"Đang tạo bản tóm tắt..."}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-2 bg-gray-200 rounded w-3/4"}),e.jsx("div",{className:"h-2 bg-gray-200 rounded w-full"}),e.jsx("div",{className:"h-2 bg-gray-200 rounded w-5/6"})]}),e.jsx("p",{className:"text-gray-400 italic mt-3",children:"AI của chúng tôi đang phân tích cuộc trò chuyện và chuẩn bị bản tóm tắt..."})]})}),e.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-3 sm:gap-4 mb-4 sm:mb-6 w-full",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("label",{className:"text-xs sm:text-base text-gray-600 font-medium",children:"Số phòng"}),e.jsx("input",{type:"text",className:"w-20 sm:w-32 p-2 border border-white/30 rounded-xl focus:ring-2 focus:ring-[#d4af37] focus:border-[#d4af37] bg-white/70 text-gray-900 font-semibold",value:s.roomNumber,onChange:C=>j("roomNumber",C.target.value)})]}),e.jsxs("button",{className:"h-full px-3 sm:px-4 bg-white/70 text-blue-900 rounded-full text-xs sm:text-base font-semibold border border-white/30 shadow flex items-center justify-center",onClick:()=>o("interface3"),style:{fontFamily:"inherit",letterSpacing:.2},children:[e.jsx("span",{className:"material-icons text-base mr-2",children:"translate"}),"Tiếng Anh"]}),e.jsxs("button",{id:"confirmOrderButton",className:"h-full px-4 sm:px-8 py-2 sm:py-4 bg-[#d4af37] hover:bg-[#ffd700] text-blue-900 font-bold rounded-full shadow-lg text-base sm:text-xl transition-colors border border-white/30 flex items-center justify-center",onClick:L,style:{fontFamily:"inherit",letterSpacing:.5},children:[e.jsx("span",{className:"material-icons mr-2 text-lg sm:text-2xl",children:"check_circle"}),"Xác nhận"]})]})]})})}):null},fu=({isActive:n})=>{const{callSummary:t,orderSummary:s,setCurrentInterface:o,setOrderSummary:a,setOrder:m,serviceRequests:l,emailSentForCurrentSession:i,setEmailSentForCurrentSession:c,callDetails:_,callDuration:x,language:S}=te(),[D,w]=r.useState(""),g=(d,j)=>{s&&a({...s,[d]:j})};r.useEffect(()=>{var d,j;if(n&&l&&l.length>0&&s){const I=l.map((p,$)=>{let E=1,F=10;p.serviceType==="housekeeping"&&(F=8),p.serviceType==="technical-support"&&(F=0),(p.serviceType.includes("food")||p.serviceType==="room-service")&&(F=15),p.serviceType==="wake-up"&&(F=0);let y="";const f=p.details;return f.roomNumber&&f.roomNumber!=="unknown"&&f.roomNumber!=="Not specified"&&(y+=`${N("room_number","fr")}: ${f.roomNumber}
`),f.date&&f.date!=="Not specified"&&(y+=`${N("time","fr")}: ${f.date}
`),f.time&&f.time!=="Not specified"&&(y+=`${N("time","fr")}: ${f.time}
`),f.people&&(y+=`Nombre de personnes: ${f.people}
`),f.location&&f.location!=="Not specified"&&(y+=`Lieu: ${f.location}
`),f.amount&&f.amount!=="Not specified"&&(y+=`Montant: ${f.amount}
`),y+=`
Demande: ${p.requestText}`,f.otherDetails&&f.otherDetails!=="Not specified"&&f.otherDetails!=="None"&&!f.otherDetails.includes("Not specified")&&(y+=`

Informations supplémentaires: ${f.otherDetails}`),{id:($+1).toString(),name:p.requestText.length>60?p.requestText.substring(0,57)+"...":p.requestText,description:y,quantity:E,price:F,serviceType:p.serviceType}}),q=Array.from(new Set(l.map(p=>p.serviceType))).join(",");let L=s.deliveryTime;l.some(p=>p.details&&p.details.time&&typeof p.details.time=="string"&&p.details.time.toLowerCase().includes("immediate"))&&(L="asap");const C=(j=(d=l.find(p=>p.details&&p.details.roomNumber&&p.details.roomNumber!=="unknown"&&p.details.roomNumber!=="Not specified"))==null?void 0:d.details)==null?void 0:j.roomNumber;a({...s,items:I,totalAmount:I.reduce((p,$)=>p+$.price*$.quantity,0),orderType:q,roomNumber:C||s.roomNumber,deliveryTime:L})}},[l,n,s,a]);const T=async()=>{if(!s)return;const d=`#ORD-${Math.floor(1e4+Math.random()*9e4)}`;if(m({reference:d,estimatedTime:"15-20 minutes",summary:s}),i){o("interface4");return}try{const j=x?`${Math.floor(x/60)}:${(x%60).toString().padStart(2,"0")}`:"0:00",I=`call-${Date.now()}`,q={toEmail:"tuans2@gmail.com",callDetails:{callId:(_==null?void 0:_.id)||I,roomNumber:s.roomNumber||"À confirmer",summary:t?t.content:"Aucun résumé",timestamp:t?t.timestamp:new Date,duration:j,serviceRequests:s.items.map(L=>L.name),orderReference:d,note:D}};setTimeout(async()=>{try{const L=await fetch("/api/send-call-summary-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(q),cache:"no-cache",credentials:"same-origin"});if(!L.ok)throw new Error(`Le serveur a répondu avec le statut: ${L.status}`);await L.json(),c(!0)}catch(L){console.error("Erreur lors de l'envoi de l'email:",L)}},500)}catch(j){console.error("Erreur lors de l'envoi de l'email:",j)}o("interface4")};return s?e.jsx("div",{className:`absolute w-full min-h-screen h-full transition-opacity duration-500 ${n?"opacity-100 active":"opacity-0 pointer-events-none"} z-30 overflow-y-auto`,id:"interface3fr","data-interface":"interface3fr","data-active":n.toString(),style:{backgroundImage:"linear-gradient(rgba(26, 35, 126, 0.7), rgba(63, 81, 181, 0.7))",backgroundSize:"cover",backgroundPosition:"center",fontFamily:"SF Pro Text, Roboto, Open Sans, Arial, sans-serif"},children:e.jsx("div",{className:"container mx-auto h-full flex flex-col p-2 sm:p-4 md:p-8",children:e.jsxs("div",{className:"mx-auto w-full max-w-3xl bg-white/90 rounded-2xl shadow-xl p-3 sm:p-6 md:p-10 mb-4 sm:mb-6 flex-grow border border-white/40 backdrop-blur-md",style:{minHeight:420},children:[e.jsx("div",{className:"mb-3 sm:mb-4 pb-2 sm:pb-3 border-b border-gray-200",children:e.jsx("p",{className:"font-poppins font-bold text-xl sm:text-2xl text-blue-900 tracking-wide",children:N("order_summary","fr")})}),e.jsx("div",{id:"summary-container",className:"mb-3 sm:mb-4",children:t?e.jsxs("div",{className:"p-3 sm:p-5 bg-white/80 rounded-xl shadow border border-white/30 mb-3 sm:mb-4 relative",style:{backdropFilter:"blur(2px)"},children:[e.jsx("h3",{className:"font-semibold text-base sm:text-lg mb-1 sm:mb-2 text-blue-800",children:N("summary","fr")}),e.jsx("div",{className:"text-xs sm:text-base leading-relaxed text-gray-800 whitespace-pre-line",style:{fontWeight:400},children:(t.content||"").split(`
`).map((j,I)=>{let Y=j.replace(/^Room Number:/i,`${N("room_number","fr")}:`).replace(/^Guest's Name.*:/i,`${N("guest_name","fr")}:`).replace(/^REQUEST (\d+):/i,(q,L)=>`DEMANDE ${L} :`).replace(/^• Service Timing:/i,"• Heure de service :").replace(/^• Order Details:/i,"• Détails de la commande :").replace(/^• Special Requirements:/i,"• Exigences spéciales :").replace(/^Next Step:/i,"Étape suivante :").replace(/Not specified/gi,"Non spécifié").replace(/Details:/gi,"Détails :").replace(/Assistance or reservation for golf activity requested/gi,"Assistance ou réservation pour une activité de golf demandée");return e.jsx("div",{children:Y},I)})}),e.jsx("div",{className:"mt-2 sm:mt-3 flex justify-end",children:e.jsxs("div",{className:"text-xs text-gray-500",children:[N("generated_at","fr")," ",new Date(t.timestamp).toLocaleTimeString()]})})]}):null}),e.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-3 sm:gap-4 mb-4 sm:mb-6 w-full",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("label",{className:"text-xs sm:text-base text-gray-600 font-medium",children:N("room_number","fr")}),e.jsx("input",{type:"text",className:"w-20 sm:w-32 p-2 border border-white/30 rounded-xl focus:ring-2 focus:ring-[#d4af37] focus:border-[#d4af37] bg-white/70 text-gray-900 font-semibold",value:s.roomNumber,onChange:d=>g("roomNumber",d.target.value)})]}),e.jsxs("button",{className:"h-full px-3 sm:px-4 bg-white/70 text-blue-900 rounded-full text-xs sm:text-base font-semibold border border-white/30 shadow flex items-center justify-center",onClick:()=>o("interface3"),style:{fontFamily:"inherit",letterSpacing:.2},children:[e.jsx("span",{className:"material-icons text-base mr-2",children:"translate"}),N("english","fr")]}),e.jsxs("button",{id:"confirmOrderButton",className:"h-full px-4 sm:px-8 py-2 sm:py-4 bg-[#d4af37] hover:bg-[#ffd700] text-blue-900 font-bold rounded-full shadow-lg text-base sm:text-xl transition-colors border border-white/30 flex items-center justify-center",onClick:T,style:{fontFamily:"inherit",letterSpacing:.5},children:[e.jsx("span",{className:"material-icons mr-2 text-lg sm:text-2xl",children:"check_circle"}),N("send_to_reception","fr")]})]}),e.jsx("textarea",{placeholder:N("enter_notes","fr"),className:"w-full p-2 border border-white/30 rounded-xl text-xs sm:text-sm bg-white/60 focus:bg-white/90 focus:ring-2 focus:ring-[#d4af37] transition italic font-light text-gray-500",value:D,onChange:d=>w(d.target.value),rows:3,style:{fontFamily:"inherit"}})]})})}):null},bu=({isActive:n})=>{const{order:t,setCurrentInterface:s,language:o,setOrder:a}=te();ce.useEffect(()=>{n&&(console.clear(),console.log("🎬 === Interface4 Debug Session Started ==="),console.log("🎬 Interface4 mounted with isActive:",n),console.log("🎬 Order:",t))},[n]);const m=()=>{console.log("🏠 Return to Home button clicked"),console.log("Current interface before:",n),console.log("Order exists:",!!t);try{console.log("🗑️ Clearing order..."),a(null),console.log("🔄 Setting interface to interface1..."),s("interface1"),console.log('✅ Order cleared and setCurrentInterface("interface1") called'),setTimeout(()=>{console.log("⏰ Delayed check - Current interface should be interface1"),console.log("⏰ Order should be null:",!t)},100)}catch(l){console.error("❌ Error in handleReturnHome:",l)}};return console.log("🔍 Interface4 render:",{isActive:n,hasOrder:!!t,orderReference:t==null?void 0:t.reference,timestamp:new Date().toISOString()}),(!n||!t)&&console.log("❌ Interface4 not rendering - isActive:",n,"hasOrder:",!!t),!n||!t?null:e.jsx("div",{className:"fixed inset-0 z-50 w-full h-full min-h-screen flex items-start sm:items-center justify-center bg-black/30 backdrop-blur-sm",id:"interface4",onClick:l=>{l.target===l.currentTarget&&console.log("🖱️ Background clicked - not closing dialog")},children:e.jsx("div",{className:"container mx-auto flex flex-col items-center justify-center pt-50 sm:pt-0 p-3 sm:p-5 text-center h-auto",children:e.jsxs("div",{className:"w-full max-w-xs sm:max-w-md bg-white rounded-lg shadow-lg p-4 sm:p-8",children:[e.jsx("div",{className:"mb-4 sm:mb-6 flex justify-center",children:e.jsx("div",{className:"w-16 h-16 sm:w-24 sm:h-24 rounded-full bg-green-500 flex items-center justify-center",children:e.jsx("span",{className:"material-icons text-white text-4xl sm:text-5xl",children:"check"})})}),e.jsx("h2",{className:"font-poppins font-bold text-xl sm:text-2xl text-primary mb-2 sm:mb-3",children:N("order_confirmed",o)}),e.jsx("p",{className:"text-gray-700 mb-4 sm:mb-6 text-sm sm:text-base",children:N("order_confirmed_message",o)}),e.jsx("div",{className:"bg-neutral p-3 sm:p-4 rounded-lg mb-4 sm:mb-6",children:e.jsxs("p",{className:"font-medium text-gray-800 text-sm sm:text-base",children:[N("order_reference",o),": ",e.jsx("span",{className:"font-bold",children:t.reference})]})}),e.jsxs("div",{className:"mb-4 sm:mb-6",children:[e.jsx("p",{className:"text-gray-600 text-xs sm:text-sm",children:N("estimated_delivery_time",o)}),e.jsx("p",{className:"font-poppins font-bold text-lg sm:text-xl",children:t.estimatedTime})]}),e.jsx("button",{className:"w-full px-4 sm:px-6 py-2 sm:py-3 bg-amber-400 text-primary-dark rounded-lg font-poppins font-medium text-sm sm:text-base hover:bg-amber-500 transition-colors cursor-pointer",onClick:m,onMouseDown:()=>console.log("🖱️ Mouse down on Return to Home button"),onMouseUp:()=>console.log("🖱️ Mouse up on Return to Home button"),style:{zIndex:9999,position:"relative",pointerEvents:"auto"},children:N("return_to_home",o)}),e.jsx("button",{className:"w-full mt-2 px-4 sm:px-6 py-2 sm:py-3 bg-red-500 text-white rounded-lg font-poppins font-medium text-xs opacity-50 hover:opacity-100",onClick:()=>{console.log("🔧 DEBUG: Force interface change button clicked"),s("interface1"),console.log("🔧 DEBUG: setCurrentInterface called directly")},style:{zIndex:9999,position:"relative",pointerEvents:"auto"},children:"DEBUG: Force to Interface1"})]})})})};function lt(){var _;const[n,t]=r.useState(null),[s,o]=r.useState(!1),a=te(),m=r.useRef(0),l=r.useCallback(()=>{console.log("useWebSocket env VITE_API_HOST:",void 0),n!==null&&n.close();const S=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws`;console.log("Attempting WebSocket connection to",S);const D=new WebSocket(S);return D.onopen=()=>{console.log("WebSocket connection established"),o(!0),m.current=0,a.callDetails&&D.send(JSON.stringify({type:"init",callId:a.callDetails.id}))},D.onmessage=w=>{try{const g=JSON.parse(w.data);g.type==="transcript"&&a.addTranscript({callId:g.callId,role:g.role,content:g.content}),g.type==="order_status_update"&&(g.orderId||g.reference)&&g.status&&a.setActiveOrders(T=>T.map(d=>g.reference&&d.reference===g.reference||g.orderId&&d.reference===g.orderId?{...d,status:g.status}:d))}catch(g){console.error("Error parsing WebSocket message:",g)}},D.onclose=w=>{if(console.log("WebSocket connection closed",w),o(!1),m.current<5){const g=Math.pow(2,m.current)*1e3;console.log(`Reconnecting WebSocket in ${g}ms (attempt ${m.current+1})`),setTimeout(l,g),m.current++}else console.warn("Max WebSocket reconnection attempts reached")},D.onerror=w=>{console.error("WebSocket encountered error",w),D.readyState!==WebSocket.CLOSED&&D.close()},t(D),()=>{D.close()}},[a.callDetails,a.addTranscript,a.activeOrders,a.setActiveOrders]),i=r.useCallback(x=>{n&&s?n.send(JSON.stringify(x)):console.error("Cannot send message, WebSocket not connected")},[n,s]),c=r.useCallback(()=>{s||l()},[s,l]);return r.useEffect(()=>(l(),()=>{n&&n.close()}),[]),r.useEffect(()=>{var x;n&&s&&((x=a.callDetails)!=null&&x.id)&&(console.log("Sending init message with callId after availability",a.callDetails.id),n.send(JSON.stringify({type:"init",callId:a.callDetails.id})))},[(_=a.callDetails)==null?void 0:_.id,n,s]),{connected:s,sendMessage:i,reconnect:c}}function _u({currentStep:n=1,compact:t=!1,horizontal:s=!1,language:o}){const{language:a}=te?te():{language:"en"},m=o||a||"en",l=[{icon:"call",title:N("press_to_call",m),desc:N("press_to_call_desc",m)},{icon:"check_circle",title:N("confirm_request",m),desc:N("confirm_request_desc",m)},{icon:"mail",title:N("send_to_reception",m),desc:N("send_to_reception_desc",m)}];return s?e.jsx("div",{className:"flex flex-row items-center justify-center w-full gap-2 md:gap-6 py-1",children:l.map((i,c)=>e.jsxs(ce.Fragment,{children:[e.jsxs("div",{className:`flex flex-col items-center transition-all duration-300 ${c+1===n?"opacity-100 scale-105":c+1<n?"opacity-60":"opacity-40"}`,children:[e.jsx("div",{className:`flex items-center justify-center rounded-full shadow-lg mb-0.5 transition-all duration-300 ${c+1===n?"bg-[#d4af37] text-blue-900 border-2 border-[#d4af37]":c+1===2||c+1===3?"bg-white/30 text-[#d4af37] border-2 border-[#d4af37]":"bg-white/30 text-white border border-gray-200"}`,style:{width:22,height:22,fontSize:13,boxShadow:c+1===2||c+1===3?"0 0 0 2px #d4af37":void 0},children:e.jsx("span",{className:"material-icons",children:i.icon})}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`font-semibold font-poppins mb-0 text-[10px] ${c+1===n?"text-[#d4af37]":"text-[#d4af37]/70"} ${c+1===2||c+1===3?"font-extrabold text-base":""}`,children:i.title}),e.jsx("div",{className:`font-light text-[8px] ${c+1===2||c+1===3?"text-base text-[#b48a19]":"text-[#d4af37]/80"} hidden md:block`,children:i.desc})]})]}),c<l.length-1&&e.jsx("div",{className:"h-0.5 w-3 md:w-8 bg-gradient-to-r from-[#d4af37]/80 to-transparent mx-1 rounded-full"})]},i.title))}):e.jsx("div",{className:`w-full ${t?"max-w-[160px] py-2 gap-3":"max-w-xs py-6 gap-6"} mx-auto flex flex-col items-center`,children:l.map((i,c)=>e.jsxs("div",{className:`flex flex-col items-center w-full transition-all duration-300 ${c+1===n?"opacity-100 scale-105":c+1<n?"opacity-60":"opacity-40"}`,children:[e.jsx("div",{className:`flex items-center justify-center rounded-full shadow-lg mb-2 transition-all duration-300 ${c+1===n?"bg-[#d4af37] text-blue-900 border-2 border-[#d4af37]":c+1===2||c+1===3?"bg-white/30 text-[#d4af37] border-2 border-[#d4af37]":"bg-white/30 text-white border border-gray-200"}`,style:{width:t?32:48,height:t?32:48,fontSize:t?18:28,boxShadow:c+1===2||c+1===3?"0 0 0 2px #d4af37":void 0},children:e.jsx("span",{className:"material-icons",children:i.icon})}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`font-semibold font-poppins mb-1 ${t?"text-xs":c+1===2||c+1===3?"text-lg":"text-base"} ${c+1===n?"text-[#d4af37]":"text-[#d4af37]/70"} ${c+1===2||c+1===3?"font-extrabold":""}`,style:c+1===2||c+1===3?{letterSpacing:.5}:{},children:i.title}),e.jsx("div",{className:`font-light ${t?"text-[10px]":c+1===2||c+1===3?"text-base":"text-sm"} ${c+1===2||c+1===3?"text-[#b48a19]":"text-[#d4af37]/80"}`,children:i.desc})]}),c<l.length-1&&e.jsx("div",{className:`mx-auto my-1 rounded-full ${t?"w-0.5 h-4":"w-1 h-8"} bg-gradient-to-b from-[#d4af37]/80 to-transparent`})]},i.title))})}const yu=({onClose:n})=>e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/40 backdrop-blur-sm font-sans",children:e.jsxs("div",{className:"bg-gradient-to-br from-[rgba(255,255,255,0.7)] to-[rgba(255,255,255,0.5)] dark:from-[rgba(30,30,30,0.7)] dark:to-[rgba(30,30,30,0.5)] text-gray-800 dark:text-gray-200 rounded-2xl shadow-2xl p-6 sm:p-8 w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto border border-white/30",style:{transformStyle:"preserve-3d"},children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 sm:gap-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-blue-900 dark:text-amber-400 font-poppins",children:"Nội dung"}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-lg flex items-center gap-2 text-gray-800 dark:text-white",children:[e.jsx("span",{role:"img","aria-label":"target",children:"🎯"})," MỤC ĐÍCH:"]}),e.jsx("p",{className:"pl-6 text-gray-700 dark:text-gray-300",children:"Thay thế cho nhân sự lễ tân bằng AI Voice Assistant được đào tạo riêng với thông tin và dịch vụ của một khách sạn cụ thể."})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-lg flex items-center gap-2 text-gray-800 dark:text-white",children:[e.jsx("span",{role:"img","aria-label":"money",children:"💰"})," GIÁ TRỊ MANG LẠI:"]}),e.jsxs("ul",{className:"list-inside list-disc pl-6 space-y-1 text-gray-700 dark:text-gray-300",children:[e.jsx("li",{children:"Phục vụ đa ngôn ngữ – không cần thông dịch viên"}),e.jsx("li",{children:"Hoạt động 24/7 – không bao giờ nghỉ"}),e.jsx("li",{children:"Xử lý đồng thời nhiều khách cùng lúc"}),e.jsx("li",{children:"Tăng doanh thu dịch vụ thông qua gợi ý thông minh"})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-lg flex items-center gap-2 text-gray-800 dark:text-white",children:[e.jsx("span",{role:"img","aria-label":"speech bubble",children:"🗣️"})," ĐẶC ĐIỂM NỔI BẬT:"]}),e.jsx("p",{className:"pl-6 text-gray-700 dark:text-gray-300",children:"Voice Bot – Bạn NÓI CHUYỆN với AI, không cần gõ phím!"})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-lg flex items-center gap-2 text-gray-800 dark:text-white",children:[e.jsx("span",{role:"img","aria-label":"bell",children:"🔔"})," CHỨC NĂNG CỦA AI VOICE BOT:"]}),e.jsxs("ul",{className:"list-inside list-disc pl-6 space-y-1 text-gray-700 dark:text-gray-300",children:[e.jsx("li",{children:"Đặt phòng & Check-in/out"}),e.jsx("li",{children:"Room Service & Housekeeping"}),e.jsx("li",{children:"Tour bookings & Vé xe buýt"}),e.jsx("li",{children:"Thông tin du lịch địa phương"}),e.jsx("li",{children:"Homestay & Đổi tiền, giặt ủi"})]}),e.jsx("p",{className:"pl-6 text-xs italic text-gray-600 dark:text-gray-400 mt-1",children:"*Tất cả dịch vụ này sẽ do khách sạn cung cấp"})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-lg flex items-center gap-2 text-gray-800 dark:text-white",children:[e.jsx("span",{role:"img","aria-label":"microphone",children:"🎤"})," CÁCH SỬ DỤNG:"]}),e.jsx("p",{className:"pl-6 text-gray-700 dark:text-gray-300",children:"Nhấn mic → NÓI yêu cầu → Nhận phản hồi bằng giọng nói"})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-lg flex items-center gap-2 text-gray-800 dark:text-white",children:[e.jsx("span",{role:"img","aria-label":"light bulb",children:"💡"})," THỬ NGAY (6 ngôn ngữ để trải nghiệm):"]}),e.jsxs("div",{className:"pl-6 text-gray-700 dark:text-gray-300 italic",children:[e.jsx("p",{children:'"Đặt phòng cho 2 người tối nay"'}),e.jsx("p",{children:'"Order breakfast to room 101"'}),e.jsx("p",{children:'"Book tour Fairy Stream tomorrow"'})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-blue-900 dark:text-amber-400 font-poppins",children:"Content"}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-lg flex items-center gap-2 text-gray-800 dark:text-white",children:[e.jsx("span",{role:"img","aria-label":"target",children:"🎯"})," PURPOSE:"]}),e.jsx("p",{className:"pl-6 text-gray-700 dark:text-gray-300",children:"Replace human receptionists with an AI Voice Assistant trained with the specific information and services of a hotel."})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-lg flex items-center gap-2 text-gray-800 dark:text-white",children:[e.jsx("span",{role:"img","aria-label":"money",children:"💰"})," VALUE PROPOSITION:"]}),e.jsxs("ul",{className:"list-inside list-disc pl-6 space-y-1 text-gray-700 dark:text-gray-300",children:[e.jsx("li",{children:"Serves multiple languages – no interpreter needed"}),e.jsx("li",{children:"Operates 24/7 – never takes a break"}),e.jsx("li",{children:"Handles multiple guests simultaneously"}),e.jsx("li",{children:"Increases service revenue through smart suggestions"})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-lg flex items-center gap-2 text-gray-800 dark:text-white",children:[e.jsx("span",{role:"img","aria-label":"speech bubble",children:"🗣️"})," HIGHLIGHT:"]}),e.jsx("p",{className:"pl-6 text-gray-700 dark:text-gray-300",children:"Voice Bot – You SPEAK with AI, no typing needed!"})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-lg flex items-center gap-2 text-gray-800 dark:text-white",children:[e.jsx("span",{role:"img","aria-label":"bell",children:"🔔"})," AI VOICE BOT FEATURES:"]}),e.jsxs("ul",{className:"list-inside list-disc pl-6 space-y-1 text-gray-700 dark:text-gray-300",children:[e.jsx("li",{children:"Booking & Check-in/out"}),e.jsx("li",{children:"Room Service & Housekeeping"}),e.jsx("li",{children:"Tour bookings & Bus tickets"}),e.jsx("li",{children:"Local tourism information"}),e.jsx("li",{children:"Homestay & Currency exchange, laundry"})]}),e.jsx("p",{className:"pl-6 text-xs italic text-gray-600 dark:text-gray-400 mt-1",children:"*All these services are provided by the hotel"})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-lg flex items-center gap-2 text-gray-800 dark:text-white",children:[e.jsx("span",{role:"img","aria-label":"microphone",children:"🎤"})," HOW TO USE:"]}),e.jsx("p",{className:"pl-6 text-gray-700 dark:text-gray-300",children:"Press mic → SPEAK request → Receive voice response"})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-lg flex items-center gap-2 text-gray-800 dark:text-white",children:[e.jsx("span",{role:"img","aria-label":"light bulb",children:"💡"})," TRY NOW (6 languages to experience):"]}),e.jsxs("div",{className:"pl-6 text-gray-700 dark:text-gray-300 italic",children:[e.jsx("p",{children:'"Book a room for 2 people tonight"'}),e.jsx("p",{children:'"Order breakfast to room 101"'}),e.jsx("p",{children:'"Book tour Fairy Stream tomorrow"'})]})]})]})]}),e.jsx("div",{className:"mt-8 flex justify-center",children:e.jsx(le,{onClick:n,className:"font-bold text-lg bg-yellow-400 hover:bg-yellow-500 text-blue-900 px-8 py-6 rounded-full shadow-lg transition-transform transform hover:scale-105",children:"Đóng / Close"})})]})}),vu=()=>{const{currentInterface:n,language:t,setLanguage:s}=te(),[o,a]=r.useState(!1),[m,l]=r.useState(!1);r.useEffect(()=>{console.log("🔄 Current interface changed to:",n)},[n]),lt(),r.useEffect(()=>{localStorage.getItem("hasSeenWelcomePopup")||(l(!0),localStorage.setItem("hasSeenWelcomePopup","true"))},[]);const i=_=>{s(_)};return console.log("🎯 VoiceAssistant render - currentInterface:",n),console.log("🔍 Interface rendering states:",{interface1:n==="interface1",interface2:n==="interface2",interface3:n==="interface3",interface3vi:n==="interface3vi",interface3fr:n==="interface3fr",interface4:n==="interface4"}),r.useEffect(()=>{n==="interface4"?console.log("🎯 Interface4 is now active - VoiceAssistant level"):n==="interface1"&&console.log("🏠 Interface1 is now active - VoiceAssistant level")},[n]),e.jsxs("div",{className:"relative h-screen overflow-hidden font-sans text-gray-800 bg-neutral-50",id:"app",children:[m&&e.jsx(yu,{onClose:()=>l(!1)}),e.jsx("header",{className:"w-full bg-primary text-white p-4 shadow-md",children:e.jsxs("div",{className:"container mx-auto flex items-center justify-between px-2",children:[e.jsxs("div",{className:"flex items-center justify-start ml-1 sm:ml-4 mr-2 sm:mr-6 gap-3 min-w-fit",children:[e.jsx("img",{src:"/assets/references/images/minhon-logo.jpg",alt:"Minhon Logo",className:"h-10 sm:h-14 w-auto rounded-lg shadow-md bg-white/80 p-1"}),e.jsx("span",{className:"font-poppins font-bold text-xl sm:text-2xl lg:text-3xl whitespace-nowrap",style:{color:"#d4af37",textShadow:"0px 1px 2px rgba(0,0,0,0.18)"},children:"Mi Nhon Hotel Mui Ne"})]}),e.jsx("div",{className:"flex-1"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center px-2 py-1 rounded bg-primary-dark text-white text-xs sm:text-sm",children:[e.jsx(Rt,{className:"text-[#F9BF3B] text-sm sm:text-base mr-1.5"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:t,onChange:_=>i(_.target.value),className:"appearance-none bg-transparent focus:outline-none transition-all duration-200 pr-6",style:{fontWeight:600,color:"#fff",textShadow:"0px 1px 2px rgba(0, 0, 0, 0.2)"},children:[e.jsx("option",{value:"en",children:"🇬🇧 EN"}),e.jsx("option",{value:"fr",children:"🇫🇷 FR"}),e.jsx("option",{value:"zh",children:"🇨🇳 ZH"}),e.jsx("option",{value:"ru",children:"🇷🇺 RU"}),e.jsx("option",{value:"ko",children:"🇰🇷 KO"}),e.jsx("option",{value:"vi",children:"🇻🇳 VI"})]}),e.jsx(Xe,{className:"absolute right-0 top-1/2 -translate-y-1/2 text-[#F9BF3B] pointer-events-none text-sm"})]})]}),e.jsxs("button",{onClick:()=>a(!0),className:"flex items-center gap-1 px-2 py-1 rounded bg-primary-dark text-white text-xs sm:text-sm hover:bg-primary-darker transition-colors",title:"View Steps",children:[e.jsx(jt,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Steps"})]}),e.jsx(qe,{href:"/call-history",children:e.jsxs("a",{className:"flex items-center gap-1 px-2 py-1 rounded bg-primary-dark text-white text-xs sm:text-sm hover:bg-primary-darker transition-colors",children:[e.jsx(Nt,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Call History"})]})})]})]})}),o&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4 relative",children:[e.jsx("button",{onClick:()=>a(!1),className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx(Se,{className:"w-6 h-6"})}),e.jsx("div",{className:"mt-4",children:e.jsx(_u,{horizontal:!1,compact:!1,currentStep:n==="interface3"?3:n==="interface2"?2:1,language:t})})]})}),e.jsxs("div",{className:"relative w-full h-full",id:"interfaceContainer",children:[e.jsx(uu,{isActive:n==="interface1"}),e.jsx(xu,{isActive:n==="interface2"}),e.jsx(ct,{isActive:n==="interface3"}),e.jsx(gu,{isActive:n==="interface3vi"}),e.jsx(fu,{isActive:n==="interface3fr"}),e.jsx(bu,{isActive:n==="interface4"})]})]})},dt=r.forwardRef(({className:n,...t},s)=>e.jsx("div",{ref:s,className:Q("rounded-lg border bg-card text-card-foreground shadow-sm",n),...t}));dt.displayName="Card";const wu=r.forwardRef(({className:n,...t},s)=>e.jsx("div",{ref:s,className:Q("flex flex-col space-y-1.5 p-6",n),...t}));wu.displayName="CardHeader";const ju=r.forwardRef(({className:n,...t},s)=>e.jsx("h3",{ref:s,className:Q("text-2xl font-semibold leading-none tracking-tight",n),...t}));ju.displayName="CardTitle";const Nu=r.forwardRef(({className:n,...t},s)=>e.jsx("p",{ref:s,className:Q("text-sm text-muted-foreground",n),...t}));Nu.displayName="CardDescription";const mt=r.forwardRef(({className:n,...t},s)=>e.jsx("div",{ref:s,className:Q("p-6 pt-0",n),...t}));mt.displayName="CardContent";const $u=r.forwardRef(({className:n,...t},s)=>e.jsx("div",{ref:s,className:Q("flex items-center p-6 pt-0",n),...t}));$u.displayName="CardFooter";function Su(){return e.jsx("div",{className:"min-h-screen w-full flex items-center justify-center bg-gray-50",children:e.jsx(dt,{className:"w-full max-w-md mx-4",children:e.jsxs(mt,{className:"pt-6",children:[e.jsxs("div",{className:"flex mb-4 gap-2",children:[e.jsx($t,{className:"h-8 w-8 text-red-500"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"404 Page Not Found"})]}),e.jsx("p",{className:"mt-4 text-sm text-gray-600",children:"Did you forget to add the page to the router?"})]})})})}const ku=()=>{const[n,t]=r.useState(!1),[s,o]=r.useState(null),[a,m]=r.useState(null),[l,i]=r.useState("tuans2@gmail.com"),c=async()=>{try{t(!0),o(null),m(null),console.log("Sending test email to:",l);const _=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent);console.log("Device type:",_?"mobile":"desktop");try{const S=await(await fetch("/api/test-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({toEmail:l,isMobile:_}),cache:"no-cache"})).json();if(S.success){o(`Email sent successfully using standard method! Provider: ${S.provider||"unknown"}`),t(!1);return}else console.warn("Standard method failed, trying mobile-specific endpoint")}catch(x){console.error("Error with standard endpoint:",x)}try{console.log("Thử sử dụng endpoint dành riêng cho di động...");const x=/iPhone|iPad|iPod|Android|Mobile|webOS|BlackBerry/i.test(navigator.userAgent),S=new Date().getTime(),w=await(await fetch(`/api/mobile-test-email?_=${S}`,{method:"POST",headers:{"Content-Type":"application/json","X-Device-Type":x?"mobile":"desktop","Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"},body:JSON.stringify({toEmail:l,timestamp:S,deviceInfo:navigator.userAgent}),cache:"no-cache",credentials:"same-origin",keepalive:!0})).json();if(w.success)o(`Email đang được xử lý qua endpoint tối ưu hóa cho ${x?"di động":"desktop"}! Vui lòng kiểm tra hộp thư sau vài giây.`),console.log(`Đã gửi yêu cầu thành công đến ${x?"mobile":"desktop"} endpoint.`),console.log("Response:",w);else throw new Error(w.error||"Lỗi không xác định với endpoint di động")}catch(x){console.error("Chi tiết lỗi mobile endpoint:",x),m(`Không thể gửi email: ${(x==null?void 0:x.message)||"Lỗi không xác định"}`)}t(!1)}catch(_){console.error("Error sending test email:",_),m(`Error: ${(_==null?void 0:_.message)||"Unknown error"}`),t(!1)}};return e.jsxs("div",{className:"p-4 border rounded-lg shadow-md bg-white max-w-md mx-auto mt-4",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 text-primary",children:"Kiểm tra Email trên Di động"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Email người nhận:"}),e.jsx("input",{type:"email",value:l,onChange:_=>i(_.target.value),className:"w-full p-2 border rounded focus:ring-2 focus:ring-primary",placeholder:"example@gmail.com"})]}),e.jsx("button",{onClick:c,disabled:n,className:`w-full p-3 rounded font-medium text-white ${n?"bg-gray-400":"bg-primary hover:bg-primary/90"}`,children:n?"Đang gửi...":"Gửi Email Kiểm tra"}),s&&e.jsx("div",{className:"mt-4 p-3 bg-green-100 text-green-800 rounded",children:s}),a&&e.jsx("div",{className:"mt-4 p-3 bg-red-100 text-red-800 rounded",children:a}),e.jsx("div",{className:"mt-4 text-sm text-gray-500",children:e.jsx("p",{children:"* Công cụ này giúp kiểm tra việc gửi email trên thiết bị di động. Nếu phương thức tiêu chuẩn không hoạt động, hệ thống sẽ tự động thử phương thức tối ưu hóa cho di động."})})]})},Cu=({onLogin:n})=>{const[t,s]=r.useState(""),[o,a]=r.useState(""),[m,l]=r.useState(""),i=async c=>{if(c.preventDefault(),!t||!o){l("Please enter both username and password.");return}l("");try{const _=await fetch("/api/staff/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,password:o})});if(!_.ok){const S=await _.json();l(S.error||"Login failed.");return}const x=await _.json();x.token?(localStorage.setItem("staff_token",x.token),n()):l("Login failed: No token received.")}catch{l("Login failed: Network or server error.")}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-100 to-blue-300",children:e.jsxs("form",{onSubmit:i,className:"bg-white p-8 rounded-xl shadow-lg w-full max-w-md space-y-6 border border-gray-200",children:[e.jsx("h2",{className:"text-2xl font-bold text-blue-900 mb-4 text-center",children:"Staff Login"}),m&&e.jsx("div",{className:"text-red-500 text-sm mb-2",children:m}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-1",children:"Username"}),e.jsx("input",{type:"text",className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400",value:t,onChange:c=>s(c.target.value),autoFocus:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-1",children:"Password"}),e.jsx("input",{type:"password",className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400",value:o,onChange:c=>a(c.target.value)})]}),e.jsx("button",{type:"submit",className:"w-full bg-blue-700 hover:bg-blue-800 text-white font-semibold py-2 rounded-lg transition",children:"Login"})]})})},Tu=["Đã ghi nhận","Đang thực hiện","Đã thực hiện và đang bàn giao cho khách","Hoàn thiện","Lưu ý khác"],Iu=({request:n,onClose:t,onStatusChange:s,onOpenMessage:o})=>{const[a,m]=r.useState(n.status);return n?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl p-6 w-full max-w-lg relative",children:[e.jsx("button",{className:"absolute top-2 right-2 text-gray-500 hover:text-blue-700",onClick:t,children:"×"}),e.jsx("h3",{className:"text-xl font-bold text-blue-900 mb-4",children:"Request Details"}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{children:[e.jsx("b",{children:"Room:"})," ",n.room]}),e.jsxs("div",{children:[e.jsx("b",{children:"Order ID:"})," ",n.id]}),e.jsxs("div",{children:[e.jsx("b",{children:"Guest Name:"})," ",n.guestName]}),e.jsxs("div",{children:[e.jsx("b",{children:"Content:"})," ",n.content]}),e.jsxs("div",{children:[e.jsx("b",{children:"Time:"})," ",n.time]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("b",{children:"Status:"}),e.jsx("select",{className:"border rounded px-2 py-1 text-xs",value:a,onChange:l=>m(l.target.value),children:Tu.map(l=>e.jsx("option",{value:l,children:l},l))})]}),e.jsxs("div",{children:[e.jsx("b",{children:"Notes:"})," ",n.notes||"-"]})]}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx("button",{className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded font-semibold",onClick:()=>{a!==n.status&&s(a)},children:"Cập Nhật"}),e.jsx("button",{className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded font-semibold",onClick:o,children:"Nhắn khách"}),e.jsx("button",{className:"bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded font-semibold",onClick:t,children:"Đóng"})]})]})}):null},Au=({messages:n,onSend:t,onClose:s,loading:o})=>{const[a,m]=r.useState(""),l=()=>{a.trim()&&(t(a),m(""))};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl p-5 w-full max-w-md relative flex flex-col",children:[e.jsx("button",{className:"absolute top-2 right-2 text-gray-500 hover:text-blue-700",onClick:s,children:"×"}),e.jsx("h3",{className:"text-lg font-bold text-blue-900 mb-3",children:"Nhắn tin tới Guest"}),e.jsx("div",{className:"flex-1 overflow-y-auto mb-3 max-h-60 border rounded p-2 bg-gray-50",children:n.length===0?e.jsx("div",{className:"text-gray-400 text-sm text-center",children:"Chưa có tin nhắn"}):n.map(i=>e.jsxs("div",{className:`mb-2 ${i.sender==="staff"?"text-right":"text-left"}`,children:[e.jsxs("div",{className:`inline-block px-3 py-1 rounded-lg ${i.sender==="staff"?"bg-blue-100 text-blue-900":"bg-gray-200 text-gray-800"}`,children:[e.jsxs("span",{className:"font-semibold",children:[i.sender==="staff"?"Staff":"Guest",":"]})," ",i.content]}),e.jsx("div",{className:"text-xs text-gray-400 mt-0.5",children:i.time})]},i.id))}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx("input",{type:"text",className:"flex-1 border rounded px-2 py-1",placeholder:"Nhập tin nhắn...",value:a,onChange:i=>m(i.target.value),onKeyDown:i=>{i.key==="Enter"&&l()},disabled:o}),e.jsx("button",{className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-1 rounded font-semibold",onClick:l,disabled:o||!a.trim(),children:"Gửi"})]})]})})},Ne=["Tất cả","Đã ghi nhận","Đang thực hiện","Đã thực hiện và đang bàn giao cho khách","Hoàn thiện","Lưu ý khác"],Le=n=>{switch(n){case"Đã ghi nhận":return"bg-gray-300 text-gray-800";case"Đang thực hiện":return"bg-yellow-200 text-yellow-800";case"Đã thực hiện và đang bàn giao cho khách":return"bg-blue-200 text-blue-800";case"Hoàn thiện":return"bg-green-200 text-green-800";case"Lưu ý khác":return"bg-red-200 text-red-800";default:return"bg-gray-100 text-gray-700"}},ut=()=>{const[n,t]=r.useState([]),[s,o]=r.useState(null),[a,m]=r.useState(!1),[l,i]=r.useState(!1),[c,_]=r.useState([]),[x,S]=r.useState(!1),[D,w]=r.useState("Tất cả"),[g,T]=r.useState(""),[d,j]=r.useState(""),[I,Y]=r.useState(null),[q,L]=r.useState(!1),[C,p]=r.useState(!1),[$,E]=r.useState(""),[F,y]=r.useState(""),[f,b]=r.useState({}),A=Ke(),W=()=>localStorage.getItem("staff_token"),V=async()=>{const u=W();if(!u){A("/staff");return}try{const k=await fetch("/api/staff/requests",{headers:{Authorization:`Bearer ${u}`},credentials:"include"});if(k.status===401){localStorage.removeItem("staff_token"),A("/staff");return}const v=await k.json();console.log("Fetched requests data:",v),t(v)}catch(k){console.error("Failed to fetch requests:",k)}};r.useEffect(()=>{V();const u=setInterval(V,3e4);return()=>clearInterval(u)},[]);const O=()=>{m(!1),o(null)},M=async(u,k)=>{const v=W();if(!v)return A("/staff");try{await fetch(`/api/staff/requests/${k}/status`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${v}`},credentials:"include",body:JSON.stringify({status:u})}),t(P=>P.map(B=>B.id===k?{...B,status:u}:B)),s&&s.id===k&&o({...s,status:u})}catch(P){console.error("Failed to update status:",P)}},Z=async()=>{if(i(!0),!s)return;const u=W();if(!u)return A("/staff");try{const v=await(await fetch(`/api/staff/requests/${s.id}/messages`,{headers:{Authorization:`Bearer ${u}`},credentials:"include"})).json();_(v)}catch{_([])}},G=()=>i(!1),K=async u=>{S(!0);const k=W();if(!k)return A("/staff");try{await fetch(`/api/staff/requests/${s.id}/message`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${k}`},credentials:"include",body:JSON.stringify({content:u})}),_(v=>[...v,{id:(v.length+1).toString(),sender:"staff",content:u,time:new Date().toLocaleTimeString().slice(0,5)}])}catch{}S(!1)},ie=async()=>{p(!0),E(""),y("")},oe=async()=>{if($!=="2208"){y("Mật khẩu không đúng");return}L(!0);try{const u=W();if(!u)return p(!1),A("/staff");const v=await(await fetch("/api/staff/requests/all",{method:"DELETE",headers:{Authorization:`Bearer ${u}`},credentials:"include"})).json();p(!1),v.success?(alert(`${v.message}`),t([])):alert(`Lỗi: ${v.error||"Không thể xóa requests"}`)}catch(u){console.error("Error deleting all requests:",u),alert("Đã xảy ra lỗi khi xóa requests"),p(!1)}finally{L(!1),E("")}},U=n.filter(u=>{if(D!=="Tất cả"&&u.status!==D)return!1;if(g||d){const k=new Date(u.created_at);if(g){const v=new Date(g);if(v.setHours(0,0,0,0),k<v)return!1}if(d){const v=new Date(d);if(v.setHours(23,59,59,999),k>v)return!1}}return!0}),de=u=>{u.key==="Enter"&&oe(),F&&y("")},ae=u=>{u.stopPropagation()};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-blue-200 p-2 sm:p-6",children:[e.jsxs("div",{className:"max-w-7xl mx-auto bg-white rounded-xl shadow-lg p-3 sm:p-6 border border-gray-200",children:[e.jsxs("div",{className:"flex flex-col items-center mb-6",children:[e.jsx("img",{src:"/assets/references/images/minhon-logo.jpg",alt:"Minhon Logo",className:"h-16 object-contain mb-2"}),e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-blue-900 text-center",children:"Staff Request Management"})]}),e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("button",{onClick:()=>A("/analytics"),className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-semibold shadow transition",children:"View Analytics"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{onClick:ie,disabled:q||n.length===0,className:`bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg font-semibold shadow transition ${q||n.length===0?"opacity-50 cursor-not-allowed":""}`,children:q?"Deleting...":"Delete All Requests"}),e.jsx("button",{onClick:V,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-semibold shadow transition",children:"Refresh"})]})]}),e.jsxs("div",{className:"mb-4 grid grid-cols-1 gap-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[e.jsx("label",{className:"font-semibold text-blue-900 w-full sm:w-auto",children:"Lọc theo trạng thái:"}),e.jsx("select",{className:"w-full sm:w-auto border rounded px-3 py-1 text-sm",value:D,onChange:u=>w(u.target.value),children:Ne.map(u=>e.jsx("option",{value:u,children:u},u))})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[e.jsx("label",{className:"font-semibold text-blue-900 w-full sm:w-auto",children:"Lọc theo thời gian:"}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-2 w-full sm:w-auto",children:[e.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:[e.jsx("label",{className:"text-sm text-gray-600 min-w-10",children:"Từ:"}),e.jsx("input",{type:"date",className:"border rounded px-2 py-1 text-sm w-full",value:g,onChange:u=>T(u.target.value)})]}),e.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:[e.jsx("label",{className:"text-sm text-gray-600 min-w-10",children:"Đến:"}),e.jsx("input",{type:"date",className:"border rounded px-2 py-1 text-sm w-full",value:d,onChange:u=>j(u.target.value)})]}),(g||d)&&e.jsx("button",{onClick:()=>{T(""),j("")},className:"text-blue-600 hover:text-blue-800 text-sm mt-2 sm:mt-0",children:"Xóa lọc"})]})]})]}),e.jsx("div",{className:"block sm:hidden",children:e.jsxs("div",{className:"space-y-4",children:[(console.log("Mobile rendering - filteredRequests:",U),null),U.length>0?[...U].sort((u,k)=>new Date(k.created_at).getTime()-new Date(u.created_at).getTime()).map(u=>e.jsxs("div",{className:"border rounded-lg p-3 bg-white shadow-sm",children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsxs("div",{className:"font-semibold",children:["Phòng: ",u.room_number||"N/A"]}),e.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-semibold ${Le(u.status)}`,children:u.status||"Chưa xác định"})]}),e.jsxs("div",{className:"text-sm text-gray-500 mb-2",children:["Order ID: ",u.orderId||u.id||"N/A"]}),e.jsx("div",{className:"text-xs text-gray-500 mb-3",children:u.created_at?e.jsxs(e.Fragment,{children:[new Date(u.created_at).toLocaleDateString()," ",new Date(u.created_at).toLocaleTimeString()]}):"Thời gian không xác định"}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("button",{onClick:()=>Y(I===u.id?null:u.id),className:"w-full flex justify-between items-center py-1 px-2 border rounded bg-gray-50 hover:bg-gray-100",children:[e.jsx("span",{className:"text-sm font-medium text-blue-700",children:I===u.id?"Ẩn nội dung":"Xem nội dung"}),e.jsx("svg",{className:`w-4 h-4 text-blue-700 transition-transform ${I===u.id?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),I===u.id&&e.jsx("div",{className:"mt-2 p-2 bg-gray-50 rounded-md whitespace-pre-line break-words text-sm",children:u.request_content||"Không có nội dung"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("select",{className:"border rounded px-2 py-2 text-sm w-full",value:f[u.id]??u.status,onChange:k=>b(v=>({...v,[u.id]:k.target.value})),children:Ne.filter(k=>k!=="Tất cả").map(k=>e.jsx("option",{value:k,children:k},k))}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("button",{className:"bg-blue-600 hover:bg-blue-700 text-white px-2 py-2 rounded text-sm font-semibold",onClick:async()=>{const k=f[u.id];k&&k!==u.status&&(await M(k,u.id),b(v=>{const{[u.id]:P,...B}=v;return B}))},children:"Cập Nhật"}),e.jsx("button",{className:"bg-green-600 hover:bg-green-700 text-white px-2 py-2 rounded text-sm font-semibold",onClick:()=>{o(u),Z()},children:"Nhắn khách"})]})]})]},u.id)):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("p",{children:"Không có yêu cầu nào"}),e.jsx("p",{className:"mt-2 text-sm",children:"Nhấn Refresh để tải lại dữ liệu"})]})]})}),e.jsx("div",{className:"hidden sm:block overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-blue-100 text-blue-900",children:[e.jsx("th",{className:"py-2 px-3 text-left",children:"Room"}),e.jsx("th",{className:"py-2 px-3 text-left",children:"Order ID"}),e.jsx("th",{className:"py-2 px-6 text-left w-3/5",children:"Content"}),e.jsx("th",{className:"py-2 px-3 text-left",children:"Time"}),e.jsx("th",{className:"py-2 px-2 text-left w-1/12",children:"Status"}),e.jsx("th",{className:"py-2 px-3 text-left",children:"Action"})]})}),e.jsxs("tbody",{children:[(Array.isArray(U)?[...U].sort((u,k)=>new Date(k.created_at).getTime()-new Date(u.created_at).getTime()):[]).map(u=>e.jsxs("tr",{className:"border-b hover:bg-blue-50",children:[e.jsx("td",{className:"py-2 px-3 font-semibold",children:u.room_number}),e.jsx("td",{className:"py-2 px-3",children:u.orderId||u.id}),e.jsx("td",{className:"py-2 px-6 whitespace-pre-line break-words max-w-4xl",children:u.request_content}),e.jsxs("td",{className:"py-2 px-3",children:[u.created_at&&e.jsx("span",{className:"block whitespace-nowrap",children:new Date(u.created_at).toLocaleDateString()}),u.created_at&&e.jsx("span",{className:"block whitespace-nowrap text-xs text-gray-500",children:new Date(u.created_at).toLocaleTimeString()})]}),e.jsx("td",{className:"py-2 px-2",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${Le(u.status)} break-words whitespace-normal block text-center`,children:u.status})}),e.jsxs("td",{className:"py-2 px-3 space-x-2",children:[e.jsx("select",{className:"border rounded px-2 py-1 text-xs",value:f[u.id]??u.status,onChange:k=>b(v=>({...v,[u.id]:k.target.value})),children:Ne.filter(k=>k!=="Tất cả").map(k=>e.jsx("option",{value:k,children:k},k))}),e.jsx("button",{className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-xs font-semibold",onClick:async()=>{const k=f[u.id];k&&k!==u.status&&(await M(k,u.id),b(v=>{const{[u.id]:P,...B}=v;return B}))},children:"Cập Nhật"}),e.jsx("button",{className:"bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded text-xs font-semibold",onClick:()=>{o(u),Z()},children:"Nhắn khách"})]})]},u.id)),U.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"py-8 text-center text-gray-500",children:"Không có yêu cầu nào"})})]})]})})]}),a&&s&&e.jsx(Iu,{request:s,onClose:O,onStatusChange:u=>M(u,s.id),onOpenMessage:Z}),l&&s&&e.jsx(Au,{messages:c,onClose:G,onSend:K,loading:x}),C&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-full max-w-md mx-4",onClick:ae,children:[e.jsx("h3",{className:"text-lg font-bold text-red-600 mb-4",children:"Xác nhận xóa toàn bộ requests"}),e.jsx("p",{className:"mb-4 text-gray-700",children:"Hành động này sẽ xóa tất cả requests và không thể hoàn tác. Vui lòng nhập mật khẩu để xác nhận:"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("input",{type:"password",value:$,onChange:u=>E(u.target.value),onKeyDown:de,className:`w-full px-3 py-2 border rounded ${F?"border-red-500":"border-gray-300"} focus:outline-none focus:ring-2 focus:ring-red-500`,placeholder:"Nhập mật khẩu xác nhận",autoFocus:!0}),F&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:F}),e.jsx("p",{className:"text-gray-500 text-xs mt-2 italic",children:"Biện pháp bảo vệ: Chức năng xóa yêu cầu mật khẩu xác nhận để ngăn ngừa xóa dữ liệu do nhầm lẫn."})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>p(!1),className:"px-4 py-2 bg-gray-300 hover:bg-gray-400 rounded transition duration-200",children:"Hủy"}),e.jsx("button",{onClick:oe,disabled:q,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded transition duration-200 flex items-center disabled:opacity-70",children:q?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Đang xóa..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Xác nhận xóa"]})})]})]})})]})},Du=()=>{const[n,t]=r.useState(!1),s=()=>t(!0);return n?e.jsx(ut,{}):e.jsx(Cu,{onLogin:s})},Be=["#0088FE","#00C49F","#FFBB28","#FF8042","#AF19FF","#FF4560"],Ru=()=>{const[n,t]=r.useState(null),[s,o]=r.useState([]),[a,m]=r.useState([]),l=Ke(),i=async c=>{const _=localStorage.getItem("staff_token");if(!_)return l("/staff"),null;try{const x=await fetch(c,{headers:{Authorization:`Bearer ${_}`}});return x.status===401?(l("/staff"),null):x.json()}catch(x){return console.error(`Failed to fetch from ${c}:`,x),null}};return r.useEffect(()=>{(async()=>{const _=await i("/api/analytics/overview"),x=await i("/api/analytics/service-distribution"),S=await i("/api/analytics/hourly-activity");_&&t(_),x&&o(x),S&&m(S)})()},[]),e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-100 to-gray-200 p-4 sm:p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-800",children:"Analytics Dashboard"}),e.jsx("button",{onClick:()=>l("/staff/dashboard"),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-semibold shadow transition",children:"Back to Staff Dashboard"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-md border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Total Calls"}),e.jsx("p",{className:"text-3xl font-bold text-blue-600",children:(n==null?void 0:n.totalCalls)||"..."})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-md border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Avg. Call Duration"}),e.jsxs("p",{className:"text-3xl font-bold text-green-600",children:[(n==null?void 0:n.averageCallDuration)||"...","s"]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-md border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Languages"}),e.jsx(ye,{width:"100%",height:150,children:e.jsxs(Et,{children:[e.jsx(Ot,{data:n==null?void 0:n.languageDistribution,dataKey:"count",nameKey:"language",cx:"50%",cy:"50%",outerRadius:60,fill:"#8884d8",label:!0,children:n==null?void 0:n.languageDistribution.map((c,_)=>e.jsx(Pt,{fill:Be[_%Be.length]},`cell-${_}`))}),e.jsx(ve,{})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-md border border-gray-200",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-4",children:"Popular Services"}),e.jsx(ye,{width:"100%",height:300,children:e.jsxs(Ft,{data:s,margin:{top:5,right:20,left:10,bottom:5},children:[e.jsx(Ce,{strokeDasharray:"3 3"}),e.jsx(Te,{dataKey:"serviceType"}),e.jsx(Ie,{}),e.jsx(ve,{}),e.jsx(Ae,{}),e.jsx(Lt,{dataKey:"count",fill:"#8884d8"})]})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-md border border-gray-200",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-4",children:"Hourly Activity"}),e.jsx(ye,{width:"100%",height:300,children:e.jsxs(Bt,{data:a,margin:{top:5,right:20,left:10,bottom:5},children:[e.jsx(Ce,{strokeDasharray:"3 3"}),e.jsx(Te,{dataKey:"hour"}),e.jsx(Ie,{}),e.jsx(ve,{}),e.jsx(Ae,{}),e.jsx(qt,{type:"monotone",dataKey:"count",stroke:"#82ca9d"})]})})]})]})]})})},Mu=ce.lazy(()=>Ze(()=>import("./CallHistory-ChEkosKA.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),Eu=ce.lazy(()=>Ze(()=>import("./CallDetails-CHM_Q-IP.js"),__vite__mapDeps([7,1,2,3,4,5,6]))),Ou=()=>e.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500 mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Đang tải..."})]})}),Pu=()=>e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"container mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Kiểm tra Tính năng Email"}),e.jsx(qe,{href:"/",className:"px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90",children:"Quay lại Trang Chính"})]}),e.jsx(ku,{})]})});function Fu(){return e.jsx(r.Suspense,{fallback:e.jsx(Ou,{}),children:e.jsxs(bt,{children:[e.jsx(re,{path:"/call-history",component:Mu}),e.jsx(re,{path:"/call-details/:callId",component:Eu}),e.jsx(re,{path:"/email-test",component:Pu}),e.jsx(re,{path:"/staff",component:Du}),e.jsx(re,{path:"/staff/dashboard",component:ut}),e.jsx(re,{path:"/analytics",component:Ru}),e.jsx(re,{path:"/",component:vu}),e.jsx(re,{component:Su})]})})}function Lu(){return lt(),e.jsxs(Gt,{children:[e.jsx(Fu,{}),e.jsx(ss,{})]})}function Bu(){return e.jsx(Mt,{children:e.jsx(rt,{children:e.jsx(Lu,{})})})}async function qu(n){if(!n.ok){const t=await n.text()||n.statusText;throw new Error(`${n.status}: ${t}`)}}const zu=({on401:n})=>async({queryKey:t})=>{const s=await fetch(t[0],{credentials:"include"});return await qu(s),await s.json()},Hu=new zt({defaultOptions:{queries:{queryFn:zu({on401:"throw"}),refetchInterval:!1,refetchOnWindowFocus:!1,staleTime:1/0,retry:!1},mutations:{retry:!1}}});ft(document.getElementById("root")).render(e.jsx(Ht,{client:Hu,children:e.jsx(rt,{children:e.jsx(Bu,{})})}));
