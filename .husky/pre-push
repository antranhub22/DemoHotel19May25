#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸš€ Running comprehensive pre-push validations..."

echo "ğŸ”§ TypeScript compilation check..."
npm run typecheck || {
  echo "âš ï¸ TypeScript errors found. Consider fixing them."
  echo "â„¹ï¸ Use 'git push --no-verify' to bypass if needed."
}

echo "ğŸ›ï¸ Running comprehensive architectural governance validation..."
npm run governance:validate || {
  echo "âŒ Architectural governance validation failed!"
  echo "ğŸ“‹ Review governance report for detailed violations."
  echo "ğŸ”§ Run 'npm run governance:report' for detailed analysis."
  echo "â„¹ï¸ Use 'git push --no-verify' to bypass if absolutely necessary."
  exit 1
}

echo "ğŸ§ª Running tests (optional)..."
npm run test || {
  echo "âš ï¸ Tests failed or have issues. Consider investigating."
  echo "â„¹ï¸ Continuing with push anyway..."
}

echo "ğŸ¨ Style consistency check..."
npm run style:check || {
  echo "âš ï¸ Style issues found. Consider running 'npm run style:fix'."
  echo "â„¹ï¸ Use 'git push --no-verify' to skip all checks if needed."
}

echo "ğŸ“Š Generating governance compliance report..."
npm run governance:report || {
  echo "âš ï¸ Could not generate governance report."
}

echo "âœ… All pre-push validations completed!"
echo "ğŸ¯ Governance compliance verified for deployment readiness." 